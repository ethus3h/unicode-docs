<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="en-us">
<link rel="stylesheet" href="../../unicode/reports/reports.css" type="text/css">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>UTR# 36: Unicode Security Considerations</title>
<style type="text/css">
<!--
span.special { text-decoration: underline; font-weight: bold; color: #FF0000;font-family: monospace; font-size: 12px }
.idn-head { font-size: 12px; background-color: #C0C0C0 }
span.mono    { font-family: monospace; font-size: 12px }
.idn-example {font-size:12px; font-family:Arial Unicode MS, san-serif}
span.border {background-color: white; color: red; border-left: 1px solid  blue; border-right: 1px solid blue}
.button {background-color: #CCCCCC; text-align: center; border-style: outset; border-width: 2px}
.noborder {border-width: 0; border-collapse: collapse; }
.alert {border-style:outset; border-width:3px; background-color:#DDDDFF; border-collapse: collapse; width:80% }
.alertcell {border-width: 0; padding: 1em}
-->
</style>
</head>

<body>

<form method="POST" action="http://www.unicode.org/reports/tr36/none">
  <table class="header" cellspacing="0" cellpadding="0" width="100%">
    <tr>
      <td class="icon"><a href="http://www.unicode.org">
      <img align="middle" alt="[Unicode]" border="0" src="../../webscripts/logo60s2.gif" width="34" height="33"></a>&nbsp;&nbsp;<a class="bar" href="http://www.unicode.org/reports">Technical 
      Reports</a></td>
    </tr>
    <tr>
      <td class="gray">&nbsp;</td>
    </tr>
  </table>
  <div class="body">
    <h2 align="center">Unicode Technical Report #36</h2>
    <h1>Unicode Security Considerations</h1>
    <table border="1" cellpadding="2" width="90%" style="border-collapse: collapse" cellspacing="0">
      <tr>
        <td valign="top">Authors</td>
        <td valign="top">Mark Davis (<a href="mailto:mark.davis@us.ibm.com">mark.davis@us.ibm.com</a>),<br>
        Michel Suignard <a href="mailto:(michelsu@windows.microsoft.com">
        (michelsu@windows.microsoft.com</a>)</td>
      </tr>
      <tr>
        <td valign="top">Date</td>
        <td valign="top">2005-07-07</td>
      </tr>
      <tr>
        <td valign="top">This Version</td>
        <td valign="top"><a href="tr36-3.html">
        http://www.unicode.org/reports/tr36/tr36-3.html</a></td>
      </tr>
      <tr>
        <td valign="top">Previous Version</td>
        <td valign="top"><a href="tr36-2.html">
        http://www.unicode.org/reports/tr36/tr36-2.html</a></td>
      </tr>
      <tr>
        <td valign="top">Latest Version</td>
        <td valign="top"><a href="index.html">
        http://www.unicode.org/reports/tr36/</a></td>
      </tr>
      <tr>
        <td valign="top">Latest Working Draft</td>
        <td valign="top"><a href="http://www.unicode.org/draft/reports/tr36/tr36.html">
        http://www.unicode.org/draft/reports/tr36/tr36.html</a> </td>
      </tr>
      <tr>
        <td valign="top">Revision</td>
        <td valign="top"><a href="tr36-3.html#Modifications">3</a></td>
      </tr>
    </table>
    <h3><br>
    <i>Summary</i></h3>
    <p><i><span>Because Unicode contains such a large number of characters and incorporates the 
    varied writing systems of the world, incorrect usage can expose programs or systems to possible 
    security attacks. This document describes some of the security considerations that programmers, 
    system analysts, standards developers, and users should take into account, </span>and provides 
    specific recommendations to reduce the risk of problems.</i></p>
    <h3><i>Status</i></h3>
    <p><i>This document has been reviewed by Unicode members and other interested parties, and has 
    been approved for publication by the Unicode Consortium. This is a stable document and may be 
    used as reference material or cited as a normative reference by other specifications.</i></p>
    <blockquote>
      <p><i><b>A Unicode Technical Report (UTR) </b>contains informative material. Conformance to 
      the Unicode Standard does not imply conformance to any UTR. Other specifications, however, are 
      free to make normative references to a UTR.</i></p>
    </blockquote>
    <p><i>Please submit corrigenda and other comments with the online reporting form [<a href="tr36-3.html#Feedback">Feedback</a>]. 
    Related information that is useful in understanding this document is found in
    <a href="tr36-3.html#References">References</a>. For the latest version of the Unicode Standard see [<a href="tr36-3.html#Unicode">Unicode</a>]. 
    For a list of current Unicode Technical Reports see [<a href="tr36-3.html#Reports">Reports</a>]. For more 
    information about versions of the Unicode Standard, see [<a href="tr36-3.html#Versions">Versions</a>].</i></p>
    <p><span><i>The intent for this document is to become a Unicode Technical Standard. However, 
    because of the current needs for referenceable initial recommendations and data, this document 
    is being released first as a Unicode Technical Report. To allow access to the most recent work 
    of the Unicode security subcommittee on this document, the &quot;</i></span><i>Latest Working Draft&quot; 
    link in the header points to the latest working-draft document under development.</i></p>
    <h3><i>Contents</i></h3>
    <ul class="toc">
      <li>1. <a href="tr36-3.html#Introduction">Introduction</a><ul class="toc">
        <li>1.1 <a href="tr36-3.html#Structure">Structure</a></li>
      </ul>
      </li>
      <li>2. <a href="tr36-3.html#visual_spoofing">Visual Security Issues</a><ul class="toc">
        <li>2.1 <a href="tr36-3.html#international_domain_names">Internationalized Domain Names</a></li>
        <li>2.2 <a href="tr36-3.html#Mixed_Script_Spoofing">Mixed-Script Spoofing</a></li>
        <li>2.3 <a href="tr36-3.html#Single_Script_Spoofing">Single-Script Spoofing</a></li>
        <li>2.4 <a href="tr36-3.html#Inadequate_Rendering_Support">Inadequate Rendering Support</a></li>
        <li>2.5 <a href="tr36-3.html#Bidirectional_Text_Spoofing">Bidirectional Text Spoofing</a></li>
        <li>2.6 <a href="tr36-3.html#Syntax_Spoofing">Syntax Spoofing</a></li>
        <li>2.7 <a href="tr36-3.html#Numeric_Spoofs">Numeric Spoofs</a></li>
        <li>2.8 <a href="tr36-3.html#Techniques">Techniques</a><ul class="toc">
          <li>2.8.1 <a href="tr36-3.html#Case_Folded_Format">Case-Folded Format</a></li>
          <li><span>2.8.2 <a href="tr36-3.html#Mapping_and_Prohibition">Mapping and Prohibition</a></span></li>
        </ul>
        </li>
        <li><span>2.9 <a href="tr36-3.html#Security_Levels_and_Alerts">Restriction Levels and Alerts</a></span><ul class="toc">
          <li>2.9.1 <a href="tr36-3.html#Backwards_Compabilility">Backwards Compatibility</a></li>
        </ul>
        </li>
        <li>2.10 <a href="tr36-3.html#Visual_Spoofing_Recommendations">Recommendations</a><ul class="toc">
          <li>2.10.1 <a href="tr36-3.html#User_Recommendations">User Recommendations</a></li>
          <li>2.10.2 <a href="tr36-3.html#Recommendations_General">General Programmer Recommendations</a></li>
          <li>2.10.3 <a href="tr36-3.html#Recommendations_User_Agents">User Agent Recommendations</a></li>
          <li>2.10.4 <a href="tr36-3.html#Recommendations_Registrars">Registry Recommendations</a></li>
          <li>2.10.5 <a href="tr36-3.html#Recommendations_Registrars">Registrar Recommendations</a></li>
        </ul>
        </li>
      </ul>
      </li>
      <li>3. <a href="tr36-3.html#Canonical_Represenation">Non-Visual Security Issues</a><ul class="toc">
        <li>3.1 <a href="tr36-3.html#UTF-8_Exploit">UTF-8 Exploit</a></li>
        <li>3.2 <a href="tr36-3.html#Non_Visual_Recommendations">Recommendations</a></li>
      </ul>
      </li>
      <li><span>Appendix A. <a href="tr36-3.html#Identifier_Characters">Identifier Characters</a></span><ul class="toc">
        <li>Appendix A.1 <a href="tr36-3.html#General_Security_Profile">General Security Profile for 
        Identifiers</a></li>
        <li>Appendix A.2 <a href="tr36-3.html#IDN_Security_Profiles">IDN Security Profiles for Identifiers</a></li>
      </ul>
      </li>
      <li><span>Appendix B. </span><a href="tr36-3.html#Confusable_Detection">Confusable Detection</a><ul class="toc">
        <li>Appendix B.1 <a href="tr36-3.html#Whole_Script_Confusables">Whole-Script Confusables</a></li>
        <li>Appendix B.2 <a href="tr36-3.html#Mixed_Script_Confusables">Mixed-Script Confusables</a></li>
      </ul>
      </li>
      <li><span><span>Appendix C. <a href="tr36-3.html#Missing_Character_Glyphs">Missing Character Glyphs</a></span></span></li>
      <li>Appendix D. <a href="tr36-3.html#Mixed_Script_Detection">Mixed Script Detection</a></li>
      <li>Appendix E. <a href="tr36-3.html#Future_Topics">Future Topics</a></li>
      <li><span>Appendix F. <a href="tr36-3.html#Country_Specific_IDN_Restrictions">Country-Specific IDN 
      Restrictions</a></span></li>
      <li><a href="tr36-3.html#Acknowledgements">Acknowledgements</a></li>
      <li><a href="tr36-3.html#References">References</a></li>
      <li><a href="tr36-3.html#Modifications">Modifications</a></li>
      <li>&nbsp;</li>
    </ul>
    <hr>
    <h2 align="left"><a name="Introduction"></a>1. Introduction</h2>
    <p>The Unicode Standard represents a very significant advance over all previous methods of 
    encoding characters. For the first time, all of the world&#39;s characters can be represented in a 
    uniform manner, making it feasible for the vast majority of programs to be <i>globalized:</i> 
    built to handle any language in the world.</p>
    <p>In many ways, the use of Unicode makes programs much more robust and secure. When systems 
    used a hodge-podge of different charsets for representing characters, there were security and 
    corruption problems that resulted from differences between those charsets, or from the way in 
    which programs converted to and from them.</p>
    <p>But because Unicode contains such a large number of characters, and because it incorporates 
    the varied writing systems of the world, incorrect usage can expose programs or systems to 
    possible security attacks. This document describes some of the security considerations that 
    programmers, system analysts, standards developers, and users should take into account.</p>
    <p>For example, consider visual spoofing, where a similarity in visual appearance fools a user 
    and causes him or her to take unsafe actions.</p>
    <blockquote>
      <p><span>Suppose that the user gets an email notification about an apparent problem in their 
      citibank account. Security-savvy users realize that it might be a spoof; the HTML email might 
      be presenting the URL <u>http://citibank.com/...</u> visually, but might be hiding the <i>real</i> 
      URL. They realize that even what shows up in the status bar might be a lie, since clever 
      Javascript or ActiveX can work around that. (And users may have these turned on unless they 
      know to turn them off.) They click on the link, and carefully examine the browser&#39;s address 
      box to make sure that it is actually going to <u>http://citibank.com/...</u>. They see that it 
      is, and use their password. But what they saw was wrong <font face="Lucida Sans Unicode">—</font> 
      it is actually going to a spoof site with a fake &quot;citibank.com&quot;, using the Cyrillic letter 
      that looks precisely like a &#39;c&#39;. They use the site without suspecting, and the password ends 
      up compromised.</span></p>
    </blockquote>
    <p>This problem is not new to Unicode: it was possible to spoof even with ASCII characters 
    alone. For example, &quot;<font face="sans-serif">inteI.com</font>&quot; uses a capital I instead of an L. 
    The infamous example here involves &quot;<font face="sans-serif">paypaI.com</font>&quot;: </p>
    <blockquote>
      <p class="stBodyText">... Not only was &quot;Paypai.com&quot; very convincing, but the scam artist even 
      goes one step further. He or she is apparently emailing PayPal customers, saying they have a 
      large payment waiting for them in their account.</p>
      <p class="stBodyText">The message then offers up a link, urging the recipient to claim the 
      funds. But the URL that is displayed for the unwitting victim uses a capital &quot;i&quot; (I), which 
      looks just like a lowercase &quot;L&quot; (l), in many computer fonts. ...</p>
      <p class="stBodyText" align="right"><span class="h1">—
      <a href="http://news.zdnet.co.uk/internet/security/0,39020375,2080344,00.htm">Beware the &#39;PaypaI&#39; 
      scam</a></span></p>
    </blockquote>
    <p><span>While some browsers prevent this spoof by lowercasing domain names, others do not.</span></p>
    <p>Thus to a certain extent, the new forms of visual spoofing available with Unicode are a 
    matter of degree and not kind. However, because of the very large number of Unicode characters 
    (over 96,000 in the current version), the number of opportunities for visual spoofing is 
    significantly larger than with a restricted character set such as ASCII.</p>
    <h3>1.1 <a name="Structure">Structure</a></h3>
    <p>This document should grow over time, adding additional sections as needed. Initially, it is 
    organized into two sections: visual security issues and non-visual security issues. For more 
    information, see also the Unicode FAQ on <i>Security Issues</i> [<a href="tr36-3.html#FAQSec">FAQSec</a>].</p>
    <p><span>Each section presents background information on the kinds of problems that can occur, 
    then lists specific recommendations for reducing the risk of such problems.</span></p>
    <blockquote>
      <p><b>Note: </b>Some of the examples below use Unicode characters which some browsers will not 
      show, or may not show in a way that illustrates the problem. For more information about 
      improving the display in your browser, see [<a href="tr36-3.html#Display">Display</a>].</p>
    </blockquote>
    <p>For examples and background information, see the <a href="tr36-3.html#References">References</a>, 
    including the <a href="tr36-3.html#Related_Material">Related Material</a>. For information on possible 
    future topics, see <i>Appendix E. <a href="tr36-3.html#Future_Topics">Future Topics</a></i>.</p>
    <h2><a name="visual_spoofing"></a>2. Visual Security Issues</h2>
    <p>Visual<span> spoofs depend on the use of <i>visually confusable</i> strings: two different 
    strings of Unicode characters whose appearance in common fonts in small sizes at screen 
    resolutions is sufficiently close that people easily mistake one for the other.</span></p>
    <p><span>There are no hard-and-fast rules for visual confusability: many characters look like 
    others when used with sufficiently small sizes. &quot;Small-sizes at screen resolutions&quot;, means fonts 
    whose ascent + descent is from 9 to 12 pixels for most scripts, somewhat larger for scripts, 
    such as Japanese, where the users typically select larger sizes. Confusability also depends on 
    the style of the font: with a traditional Hebrew style, many characters are only distinguishable 
    by fine differences which may be lost at small sizes. In some cases sequences of characters can 
    be used to spoof: for example, &quot;rn&quot; (&quot;r&quot; followed by &quot;n&quot;) is visually confusable with &quot;m&quot; in 
    many sans-serif fonts.</span></p>
    <p><span>Where two different strings can always be represented by the same sequence of glyphs, 
    those strings are called <i>homographs</i>. For example, &quot;AB&quot; in Latin and &quot;AB&quot; in Greek are 
    homographs. Spoofing is not dependent on just homographs; if the visual appearance is close 
    enough at small sizes or in the most common fonts, that can be sufficient to cause problems.
    <span>Note that some people use the term <i>homograph</i> broadly, encompassing all visually 
    confusable strings.</span></span></p>
    <p>T<span>wo characters with similar or identical glyph shapes are not visually confusable if 
    the positioning of the respective shapes is sufficiently different. For example, foo</span><span title="U+00B7 MIDDLE DOT">·</span><span>com 
    (using the hyphenation point instead of the period) should be distinguishable from foo.com by 
    the positioning of the dot (except in faulty fonts).</span></p>
    <p>It is important to be aware that identifiers are special-purpose strings used for 
    identification, strings that are deliberately limited to particular repertoires for that 
    purpose. Exclusion of characters from identifiers does not at all affect the general use of 
    those characters, such as within documents.</p>
    <p>The remainder of this section is concerned with identifiers that can be confused by or<span>dinary 
    users at typical sizes and screen resolutions. For examples of visually confusable characters, 
    see <i>Appendix B. </i></span><i><a href="tr36-3.html#Confusable_Detection">Confusable Detection</a></i><span>.</span></p>
    <h3>2.1 <a name="international_domain_names"></a>Internationalized Domain Names</h3>
    <p>Visual spoofing is an especially important subject given the recent introduction of 
    Internationalized Domain Names (IDN). There is a natural desire for people to see domain names 
    in their own languages and writing systems; English speakers can understand this if they 
    consider what it would be like if they always had to type web addresses with Japanese 
    characters. So IDN represents a very significant advance for most people in the world. However, 
    the larger repertoire of characters results in more opportunities for spoofing. Proper 
    implementation in browsers and other programs is required t<span>o minimize security risks while 
    still allowing for effective use of non-ASCII characters.</span></p>
    <p>Internationalized Domain Names are, of course, not the only cases where visual spoofing can 
    occur. For example, a message offering to install software from &quot;IBM&quot;, authenticated with a 
    certificate in which the &quot;<span title="U+041C CYRILLIC CAPITAL LETTER EM">М</span>&quot; character 
    happens to be the Russian (Cyrillic) character that looks precisely like the English &quot;M&quot;. <span>
    Any place where strings are used as identifiers is subject to this kind of spoofing. </span></p>
    <p>IDN provides a good starting point for a discussion of visual spoofing, and will be used as 
    the focus for the remaining part of this section. However, the concepts and recommendations 
    discussed here can be generalized to the use of other types of identifiers. <span>For background 
    information on identifiers, see UAX #31: <i>Identifier and Pattern Syntax</i> [<a href="tr36-3.html#UAX31">UAX31</a>].</span></p>
    <p><span>Certain parts of domain names are still required to be in ASCII, and thus not subject 
    to the visual spoofing issues discussed here. For example, the top-level domain names (.com, .ru, 
    etc.) are currently always ASCII (this may change in the future, however).</span></p>
    <p>Fortunately the design of IDN prevents a huge number of spoofing attacks. All conformant 
    users of IDN are required to process domain names to convert <span>what are called </span><i>
    <a href="http://www.unicode.org/glossary/#compatibility_equivalent">compatibility-equivalent</a></i> 
    characters into a unique form<span> using a process called compatibility normalization (NFKC) — 
    for more information on this, see [<a href="tr36-3.html#UAX15">UAX15</a>]</span>. This processing 
    eliminates most of the possibilities for visual spoofing by mapping away a large number of 
    visually confusable characters and sequences. For example, <span>&nbsp;characters like the half-width 
    Japanese <i>katakana</i> character <span title="U+FF76 HALFWIDTH KATAKANA LETTER KA">ｶ</span><span title="U+30AB KATAKANA LETTER KA"> 
    are converted to the regular character カ, and single ligature characters like </span>
    <span title="U+FB01 LATIN SMALL LIGATURE FI">&quot;ﬁ&quot; to the sequence of regular characters &quot;fi&quot;.
    </span></span>Unicode contains the &quot;<span title="U+00E4 LATIN SMALL LETTER A WITH DIAERESIS">ä</span>&quot; 
    (a-umlaut) character, but also contains a free-standing umlaut (&quot;<span title="U+0308 COMBINING DIAERESIS">&nbsp; 
    ̈</span>&quot;) which can be used in combination with any character, including an &quot;a&quot;. But the 
    compatibility normalization will convert any sequence of &quot;a&quot; plus &quot;<span title="U+0308 COMBINING DIAERESIS">&nbsp; 
    ̈</span>&quot; into the regular &quot;<span title="U+00E4 LATIN SMALL LETTER A WITH DIAERESIS">ä</span>&quot;.</p>
    <p>Thus you can not spoof an <i>a-umlaut</i> with <i>a + umlaut</i>; it simply results in the 
    same domain name. See the example <i>Safe Domain Names </i>below. The String column shows the 
    actual characters; the UTF-16 shows the underlying encoding<span>, while the ACE (&quot;ASCII 
    Compatible Encoding&quot;) column shows the internal format of the domain name. This is the result of 
    applying the ToASCII() operation [<a href="tr36-3.html#RFC3490">RFC3490</a>] to the original IDN, which is 
    the way this IDN is stored and queried in the DNS (Domain Name System).</span></p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
      <caption style="font-size: 14pt; font-weight: bold"><b>Safe Domain Names</b></caption>
      <tr>
        <th class="idn-head">&nbsp;</th>
        <th class="idn-head">String</th>
        <th class="idn-head">UTF-16</th>
        <th class="idn-head"><span>ACE</span></th>
        <th class="idn-head"><span>Comments</span></th>
      </tr>
      <tr>
        <th class="idn-head">1a</th>
        <td class="idn-example">ät.com</td>
        <td class="mono"><span class="special">0061 0308</span><span class="mono"> 0074 002E 0063 
        006F 006D</span></td>
        <td><span class="mono">xn--t-zfa.com</span></td>
        <td class="idn-example"><span>Uses the decomposed form, a + umlaut</span></td>
      </tr>
      <tr>
        <th class="idn-head">1b</th>
        <td class="idn-example">ät.com</td>
        <td class="mono"><span class="special">00E4</span><span class="mono"> 0074 002E 0063 006F 
        006D</span></td>
        <td class="mono"><span class="mono">xn--t-zfa.com</span></td>
        <td class="idn-example"><span>But it ends up being identical to the composed form, in IDNA</span></td>
      </tr>
    </table>
    <blockquote>
      <p><b>Note: </b>The ICU demo at <span>[<a href="tr36-3.html#IDN-Demo">IDN-Demo</a>]</span> can be used to 
      demonstrate the results of processing different domain names. That demo was also used to get 
      the ACE values shown here.</p>
    </blockquote>
    <p>Similarly, for<span title="U+0906 DEVANAGARI LETTER AA"> most scripts, two accents that do 
    not interact typographically are put into a determinate order when the text is normalized</span><span><span title="U+0906 DEVANAGARI LETTER AA">. 
    Thus the sequence &lt;x, dot_above, dot_below&gt; is reordered as &lt;x, dot_below, dot_above&gt;. This 
    ensures that the two sequences that look ide</span>ntical (ẋ̣ and ẋ̣̇) have the same 
    representation.</span></p>
    <p><span>The IDN processing also removes case distinctions by performing a <i>case folding</i> 
    to reduce characters to a lowercase form<i>.</i> This is also useful for avoiding spoofing 
    problems, since characters are generally more distinctive in their lowercase forms. That means 
    that people can focus on just the lowercase characters.</span></p>
    <blockquote>
      <p><span>This focus on lowercase letters only really helps for <i>Internationalized</i> Domain 
      Names, because of two factors: First, the IDNA operation ToASCII() will map to lowercase if 
      and only if the label contains some non-ASCII character. Thus ToASCII(&quot;paypaI.com&quot;) (where the 
      &#39;I&#39; is a capital &#39;i&#39;) produces no change.</span></p>
      <p><span>Secondly, domain names are case-insensitive, but [<a href="tr36-3.html#RFC1034">RFC1034</a>] and 
      [<a href="tr36-3.html#RFC1035">RFC1035</a>], as clarified by [<a href="tr36-3.html#DNS-Case">DNS-Case</a>], 
      introduce the concept of case preservation. Thus if someone queries the DNS for &quot;paypaI.com&quot;, 
      and the DNS contains information for &quot;paypai.com&quot;, that information is delivered, but the 
      answer from the DNS will be the original &quot;paypaI.com&quot;.</span></p>
    </blockquote>
    <p><span>For a list of allowable characters in IDN, see [<a href="tr36-3.html#idnhtml">idnhtml</a>]. There 
    are many misperceptions about which characters are allowed in IDN, so referencing this explicit 
    list should help dispel some of them.</span></p>
    <blockquote>
      <p><span><b>Note</b>: Users expect diacritical marks to distinguish domain names. For example, 
      the domain names &quot;resume.com&quot; and &quot;résumé.com&quot; are (and should be) distinguished. In languages 
      where the spelling may allow certain words with and without diacritics, </span>registrant 
      would have to register two or more domain names so as to cover user expectations<span> (just 
      as one may register both &quot;analyze.com&quot; and &quot;analyse.com&quot; to cover variant spellings).</span></p>
    </blockquote>
    <p><span>Although normalization and case-folding prevent many possible spoofing attacks, </span>
    visual spoofing can still occur with many Internationalized Domain Names. This poses the 
    question of which parts of the infrastructure using and supporting domain names are best suited 
    to minimize possible spoofing attacks.</p>
    <p>Some<span> of the problems of visual spoofing can be best handled on the registry side, while 
    others can be best handled on the <i>user agent</i> side (browsers, emailers, and other programs 
    that display and process URLs). The registry has the most data available about alternative 
    registered names, and can process that information the most efficiently at the time of 
    registration, using policies to reduce visual spoofing. For example, given the method described 
    in <i>Appendix B. </i></span><i><a href="tr36-3.html#Confusable_Detection">Confusable Detection</a></i><span>, 
    the registry can easily determine if a proposed registration could be visually confused with an 
    existing one; that determination is much more difficult for user agents because of the sheer 
    number of combinations that they would have to check.</span></p>
    <p>However, there are certain issues much more easily addressed by the user agent:</p>
    <ul>
      <li><span>the user agent has more control over the display of characters, which is crucial to 
      spoofing</span></li>
      <li><span>there are legitimate cases of visually confusable characters that one may want to 
      allow <i>after</i> alerting the user<span>, such as single-script confusables discussed below</span>.</span></li>
      <li><span>one cannot depend on all registries being equally responsive to security issues</span></li>
      <li>d<span>ue to the decentralized nature of DNS, registries do not control subdomains being 
      established beyond the domain name registered</span></li>
    </ul>
    <p>Thus the problem of visual spoofing is most effectively addressed by a combination of 
    strategies involving user-agents and registries.</p>
    <h3><b>2.2 <a name="Mixed_Script_Spoofing">Mixed-Script Spoofing</a></b></h3>
    <p>Visually confusable characters are not usually unified across scripts. Thus a Greek <i>
    omicron</i> is encoded as a different character from the Latin &quot;o&quot;, even though it is usually 
    identical <span>or nearly identical</span> in appearance. <span>There are good reasons for this: 
    often the characters were separate in legacy encodings, and preservation of those distinctions 
    was necessary for existing data to be mapped to Unicode without loss. Moreover, the characters 
    generally have very different behavior: two visually confusable characters may be different in 
    casing behavior, in category (letter versus number), or in numeric value. After all, ASCII does 
    not unify lowercase letter l and digit 1, even though those are visually confusable. <span>(Many 
    fonts always distinguish them, but many do not.) </span>Encoding the Cyrillic character б 
    (corresponding to the letter &quot;b&quot;) by using the numeral 6, would clearly have been a mistake, 
    even though they are visually confusable.</span></p>
    <p><span>However, the existence of v</span>isually confusable characters across scripts<span> 
    leads to</span> a significant number of spoofing possibilities using characters from different 
    scripts. For example, a domain name can be spoofed by using a Greek omicron instead of an &#39;o&#39;, 
    as in example 1a in the following table.</p>
    <table id="AutoNumber2" style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
      <caption style="font-size: 14pt; font-weight: bold"><b>Mixed-Script Spoofing</b></caption>
      <tr>
        <th class="idn-head">&nbsp;</th>
        <th class="idn-head">String</th>
        <th class="idn-head">UTF-16</th>
        <th class="idn-head"><span>ACE</span></th>
        <th class="idn-head"><span>Comments</span></th>
      </tr>
      <tr>
        <th class="idn-head">1a</th>
        <td class="idn-example">tοp.com</td>
        <td><span class="mono">0074 </span><span class="special">03BF</span><span class="mono"> 0070 
        002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--tp-jbc.com</span></td>
        <td class="idn-example"><span>Uses a Greek omicron in place of the o</span></td>
      </tr>
      <tr>
        <th class="idn-head">1b</th>
        <td class="idn-example">tοp.com</td>
        <td><span class="mono">0074 </span><span class="special">006F</span><span class="mono"> 0070 
        002E 0063 006F 006D</span></td>
        <td><span class="mono">top.com</span></td>
        <td class="idn-example">&nbsp;</td>
      </tr>
    </table>
    <p>There are many legitimate uses of mixed scripts. For example, <span>it</span> is quite common 
    to mix English words (with Latin characters) in other languages, including languages using 
    non-Latin scripts. <span>For example, one could have XML-документы.com (which would be a site 
    for &quot;XML documents&quot; in Russian). Even in English, legitimate product or organization names may 
    contain non-Latin characters, such as Ωmega, Teχ, Toys-Я-Us, or HλLF-LIFE. The lack of IDNs in 
    the past has also led to the usage in some registries (such as the .ru top-level domain) where 
    Latin characters have been used to create pseudo-Cyrillic names in the .ru (Russian) top-level 
    domain. For example, see <u>http://caxap.ru/</u> (сахар means sugar in Russian)</span>.</p>
    <p>For information on detecting mixed scripts, see <i>Appendix D.
    <a href="tr36-3.html#Mixed_Script_Detection">Mixed Script Detection</a>.</i></p>
    <p><span>Cyrillic, Latin, and Greek represent special challenges, since the number of common 
    glyphs shared between them is so high, as can be seen from <i>Appendix B. </i></span><i>
    <a href="tr36-3.html#Confusable_Detection">Confusable Detection</a></i><span>. It may be possible to 
    compose an entire domain name (except the top-level domain) in Cyrillic using letters that will 
    be essentially always identical in form to Latin letters, such as &quot;scope.com&quot;: with &quot;scope&quot; in 
    Cyrillic looking just like &quot;scope&quot; in Latin. Such spoofs are called <i>whole-script spoofs, </i>
    </span>and the strings that cause the problem are correspondingly called <i>whole-script 
    confusables.</i></p>
    <h3>2.3 <a name="Single_Script_Spoofing">Single-Script Spoofing</a></h3>
    <p>Spoofing with characters entirely within one script, or using characters that are common 
    across scripts (such as numbers), is called <i>single-script spoofing</i>, and the strings that 
    cause it are correspondingly called <i>single-script confusables</i>. While compatibility 
    normalization and mixed-script detection can handle the majority of cases, they do not handle 
    single-script confusables. Especially at the smaller font sizes in the context of an address 
    bar, any visual confusables within a single script can be used in spoofing. Importantly, these 
    problems can be illustrated with common, widely available fonts on widely available operating 
    systems — the problems are not specific to any single vendor.</p>
    <p>Consider the following examples, all in the same script. In each numbered case, the strings 
    will look identical or close to identical in most browsers</p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
      <caption style="font-size: 14pt; font-weight: bold">Single-Script Spoofing</caption>
      <tr>
        <th class="idn-head">&nbsp;</th>
        <th class="idn-head">String</th>
        <th class="idn-head">UTF-16</th>
        <th class="idn-head"><span>ACE</span></th>
        <th class="idn-head"><span>Comments</span></th>
      </tr>
      <tr>
        <th class="idn-head">1a</th>
        <td class="idn-example">a‐b.com</td>
        <td><span class="mono">0061 </span><span class="special">2010</span><span class="mono"> 0062 
        002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--ab-v1t.com</span></td>
        <td class="idn-example"><span>Uses a real hyphen, instead of the ASCII hyphen-minus</span></td>
      </tr>
      <tr>
        <th class="idn-head">1b</th>
        <td class="idn-example">a-b.com</td>
        <td><span class="mono">0061 </span><span class="special">002D</span><span class="mono"> 0062 
        002E 0063 006F 006D</span></td>
        <td><span class="mono">a-b.com</span></td>
        <td class="idn-example">&nbsp;</td>
      </tr>
      <tr>
        <th colSpan="5" class="idn-head">&nbsp;</th>
      </tr>
      <tr>
        <th class="idn-head">2a</th>
        <td class="idn-example">so̷s.com</td>
        <td><span class="mono">0073 </span><span class="special">006F 0337</span><span class="mono"> 
        0073 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--sos-rjc.com</span></td>
        <td class="idn-example"><span>Uses o + combining slash</span></td>
      </tr>
      <tr>
        <th class="idn-head">2b</th>
        <td class="idn-example">søs.com</td>
        <td><span class="mono">0073 </span><span class="special">00F8</span><span class="mono"> 0073 
        002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--ss-lka.com</span></td>
        <td class="idn-example">&nbsp;</td>
      </tr>
      <tr>
        <th colSpan="5" class="idn-head">&nbsp;</th>
      </tr>
      <tr>
        <th class="idn-head">3a</th>
        <td class="idn-example">z̵o.com</td>
        <td><span class="special">007A 0335</span><span class="mono"> 006F 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--zo-pyb.com</span></td>
        <td class="idn-example"><span>Uses z + combining bar</span></td>
      </tr>
      <tr>
        <th class="idn-head">3b</th>
        <td class="idn-example">ƶo.com</td>
        <td><span class="special">01B6</span><span class="mono"> 006F 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--o-zra.com</span></td>
        <td class="idn-example">&nbsp;</td>
      </tr>
      <tr>
        <th colSpan="5" class="idn-head">&nbsp;</th>
      </tr>
      <tr>
        <th class="idn-head">4a</th>
        <td class="idn-example">an͂o.com</td>
        <td><span class="mono">0061 </span><span class="special">006E 0342</span><span class="mono"> 
        006F 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--ano-0kc.com</span></td>
        <td class="idn-example"><span>Uses n + greek perispomeni</span></td>
      </tr>
      <tr>
        <th class="idn-head">4b</th>
        <td class="idn-example">año.com</td>
        <td><span class="mono">0061 </span><span class="special">00F1</span><span class="mono"> 006F 
        002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--ao-zja.com</span></td>
        <td class="idn-example">&nbsp;</td>
      </tr>
      <tr>
        <th colSpan="5" class="idn-head">&nbsp;</th>
      </tr>
      <tr>
        <th class="idn-head">5a</th>
        <td class="idn-example"><span><span title="U+02A3 LATIN SMALL LETTER DZ DIGRAPH">ʣe</span>.org</span></td>
        <td><span class="special">02A3</span><span class="mono"><span> 0065 002E 006F 0072 0067</span></span></td>
        <td><span><span class="mono">xn--e-j5a.org</span></span></td>
        <td class="idn-example"><span>Uses d-z digraph</span></td>
      </tr>
      <tr>
        <th class="idn-head">5b</th>
        <td class="idn-example"><span>dze.org</span></td>
        <td><span class="special">0064 007A</span><span class="mono"><span> 0065 002E 006F 0072 0067</span></span></td>
        <td><span><span class="mono">dze.org</span></span></td>
        <td class="idn-example">&nbsp;</td>
      </tr>
    </table>
    <p>Examples exist in various scripts. For instance, &#39;rn&#39; was already mentioned above, and the 
    sequence<span> <span title="U+0905 DEVANAGARI LETTER A">अ</span> +
    <span title="U+093E DEVANAGARI VOWEL SIGN AA">ा</span> typically looks identical to
    <span title="U+0906 DEVANAGARI LETTER AA">आ.</span></span></p>
    <p><span><span>As mentioned above, in most cases two sequences of accents that have the same 
    visual appearance are put into a canonical order. This does not happen, however, for certain 
    scripts used in Southeast Asia, so reordering characters may be used for spoofs in those cases. 
    Example:</span></span></p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
      <caption style="font-size: 14pt; font-weight: bold">Combining Mark Order Spoofing</caption>
      <tr>
        <th class="idn-head">&nbsp;</th>
        <th class="idn-head">String</th>
        <th class="idn-head">UTF-16</th>
        <th class="idn-head"><span>ACE</span></th>
        <th class="idn-head"><span>Comments</span></th>
      </tr>
      <tr>
        <th class="idn-head">1a</th>
        <td class="idn-example">လို.com</td>
        <td><span class="mono">101C </span><span class="special">102D</span><span class="mono"> 102F</span></td>
        <td><span class="mono">xn--gjd8ag.com</span></td>
        <td class="idn-example">Reorders two combining marks</td>
      </tr>
      <tr>
        <th class="idn-head">1b</th>
        <td class="idn-example">လုိ.com</td>
        <td><span class="mono">101C 102F </span><span class="special">102D</span></td>
        <td><span class="mono">xn--gjd8af.com</span></td>
        <td class="idn-example">&nbsp;</td>
      </tr>
    </table>
    <h3>&nbsp;</h3>
    <h3>2.4 <a name="Inadequate_Rendering_Support">Inadequate Rendering Support</a></h3>
    <p>An additional problem arises when a font or rendering engine has inadequate support for 
    certain sequences of characters. These are characters or sequences of characters that should be 
    visually distinguishable, but do not appear that way. Examples 1a and 1b show the cases of 
    lowercase L and digit one, mentioned above. While this depends on the font, on the computer used 
    to write this document, in roughly 30% of the fonts the glyphs are essentially identical. In 
    example 2a, the <i>a-umlaut</i> is followed by another <i>umlaut</i>. The Unicode Standard 
    guidelines indicate that the second <i>umlaut</i> should be &#39;stacked&#39; above the first, producing 
    a distinct visual difference. But as this example shows, common fonts will simply superimpose 
    the second <i>umlaut</i>; and if the positioning is close enough, the user will not see a 
    difference between 2a and 2b.</p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
      <caption style="font-size: 14pt; font-weight: bold">Inadequate Rendering Support </caption>
      <tr>
        <th bgColor="#c0c0c0" class="idn-head">&nbsp;</th>
        <th bgColor="#c0c0c0" class="idn-head">String</th>
        <th bgColor="#c0c0c0" class="idn-head">UTF-16</th>
        <th bgColor="#c0c0c0" class="idn-head"><span>ACE</span></th>
        <th bgColor="#c0c0c0" class="idn-head">Comments</th>
      </tr>
      <tr>
        <th class="idn-head">1a</th>
        <td><span class="mono">al.com</span></td>
        <td><span class="mono">0061 </span><span class="special">006C</span><span class="mono"> 002E 
        0063 006F 006D</span></td>
        <td><span class="mono">al.com</span></td>
        <td><span class="idn-example">1 and l may appear alike, depending on font. </span></td>
      </tr>
      <tr>
        <th class="idn-head">1b</th>
        <td><span class="mono">a1.com</span></td>
        <td><span class="mono">0061 </span><span class="special">0031</span><span class="mono"> 002E 
        0063 006F 006D</span></td>
        <td><span class="mono">a1.com</span></td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <th bgColor="#c0c0c0" colSpan="5" class="idn-head">&nbsp;</th>
      </tr>
      <tr>
        <th class="idn-head">2a</th>
        <td><span class="mono">ä<font face="Arial Unicode MS">̈</font>t.com</span></td>
        <td><span class="special">00E4 0308</span><span class="mono"> 0074 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--t-zfa85n.com</span></td>
        <td><span class="idn-example"><span>a-umlaut + umlaut</span></span></td>
      </tr>
      <tr>
        <th class="idn-head">2b</th>
        <td><span class="mono">ät.com</span></td>
        <td><span class="special">00E4</span><span class="mono"> 0074 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--t-zfa.com</span></td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <th bgColor="#c0c0c0" colSpan="5" class="idn-head">&nbsp;</th>
      </tr>
      <tr>
        <th class="idn-head">3a</th>
        <td><span class="mono">eḷ.com</span></td>
        <td><span class="special">0065</span><span class="mono"> 006C </span><span class="special">
        0323</span><span class="mono"> 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--e-zom.com</span></td>
        <td><span class="idn-example"><span>Has a dot under the l; may appear under the e</span></span></td>
      </tr>
      <tr>
        <th class="idn-head">3b</th>
        <td><span class="mono">ẹl.com</span></td>
        <td><span class="special">0065 0323</span><span class="mono"> 006C 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--l-ewm.com</span></td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <th class="idn-head">3c</th>
        <td><span class="mono">ẹl.com</span></td>
        <td><span class="special">1EB9</span><span class="mono"> 006C 002E 0063 006F 006D</span></td>
        <td><span class="mono">xn--l-ewm.com</span></td>
        <td>&nbsp;</td>
      </tr>
    </table>
    <p>Examples 3 a, b, and c show an even worse case. The <i>underdot</i> character in 3a should 
    appear under the &#39;l&#39;, but as rendered with many fonts, it appears under the &#39;e&#39;. It is thus 
    visually confusable with 3b (where the <i>underdot</i> is under the e) or the equivalent 
    normalized form 3c.</p>
    <p>There are a number of characters in Unicode that are invisible, although they may affect the 
    rendering of the characters around them. An example is the Joiner character, used to request a 
    cursive connection such as in Arabic. Such characters may often be in positions where they have 
    no visual distinction, and are thus discouraged for use in identifiers. A sequence of 
    ideographic description characters may be displayed as if it were a CJK character; thus they are 
    also discouraged.</p>
    <h3>2.5 <a name="Bidirectional_Text_Spoofing">Bidirectional Text Spoofing</a></h3>
    <p>Some characters, such as those used in the Arabic and Hebrew script, have an inherent 
    right-to-left writing direction. When these characters are mixed with characters of other 
    scripts or symbol sets which are displayed left-to-right, the resulting text is called 
    bidirectional (or bidi in short). The relationship between the memory representation of the text 
    (logical order) and the display appearance (visual order) of bidi text is governed by the 
    Unicode Bidirectional Algorithm [<a href="tr36-3.html#UAX9">UAX9</a>].<br>
    <br>
    Because some characters have weak or neutral directionalities, as opposed to strong 
    left-to-right or right-to-left, the Unicode Bidirectional Algorithm uses a precise set of rules 
    to determine the final visual rendering. However, presented with arbitrary sequences of text, 
    this may lead to text sequences which may be impossible to read intelligibly, or which may be 
    visually confusable. To mitigate these issues, both the IDN and IRI specifications require that:</p>
    <ul>
      <li>each label of a host name must not use both right-to-left and left-to-right characters,</li>
      <li>a label using right-to-left character must start and end with right-to-left characters.</li>
    </ul>
    <p>In addition, the IRI specification extends those requirements to other components of an IRI, 
    not just the host name labels. Not respecting them would result in insurmountable visual 
    confusion. A large part of the confusability in reading an IRI containing bidi characters is 
    created by the weak or neutral directionality property of many IRI/URI delimiters such as &#39;/&#39;, 
    &#39;.&#39;, &#39;?&#39; which makes them change directionality depending on their surrounding characters. For 
    example, in example #1 in the table below, the dots following each label are colored the same as 
    that label. Notice that the placement of that following punctuation may vary.</p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
      <caption>Bidi Examples</caption>
      <tr>
        <td vAlign="top" class="idn-head">&nbsp;</td>
        <td vAlign="top" class="idn-head">
        <p style="text-align: center">Samples</td>
      </tr>
      <tr>
        <td vAlign="top" class="idn-head">1</td>
        <td vAlign="top"><font size="4">http://<font color="#00FFFF">سلام.</font><font color="#0000FF">دائم.</font>com
        </font></td>
      </tr>
      <tr>
        <td vAlign="top" class="idn-head">2</td>
        <td vAlign="top"><font size="4">http://<font color="#00FFFF">سلام.</font><font color="#00FF00">a.</font><font color="#0000FF">دائم.</font>com</font></td>
      </tr>
    </table>
    <p>Adding the left-to-right label &quot;<font size="4" color="#00FF00">a</font>&quot; between the two 
    Arabic labels splits them up and reverses their display order, as seen in example #2. The IRI 
    specification [<a href="tr36-3.html#RFC3987">RFC3987</a>] provides more examples of valid and invalid IRIs 
    using various mixes of bidi text.</p>
    <p>To minimize the opportunities for confusion, it is imperative that the IDN and IRI 
    requirements concerning bidi processing be fully implemented in the processing of host names 
    containing bidi characters. Nevertheless, even when these requirements are met, reading IRIs 
    correctly is not trivial. Because of this, mixing right-to-left and left-to-right characters 
    should be done with great care when creating bidi IRIs.</p>
    <p><b>Recommendations:</b></p>
    <ul>
      <li>As much as possible, avoid mixing right-to-left and left-to-right characters in a single 
      host name</li>
      <li>When right-to-left characters are used, limit the usage of left-to-right characters to 
      well-known cases such as TLD names and URI/IRI scheme names (such as http, ftp, mailto, 
      etc...)</li>
      <li>Minimize the use of digits in host names and other components of IRIs containing 
      right-to-left characters.</li>
      <li>Keep IRIs containing bidi content simple to read.</li>
    </ul>
    <h3><span>2.6 <a name="Syntax_Spoofing">Syntax Spoofing</a></span></h3>
    <p><span>Spoofing syntax characters can be even worse than regular characters. For example, 
    U+2044 ( <span title="U+2044 FRACTION SLASH">⁄ ) <span style="font-variant: small-caps">FRACTION 
    SLASH</span> can look like <span>a regular ASCII</span> &#39;/&#39; in many fonts
    <font face="Lucida Sans Unicode">—</font> ideally the spacing and angle are sufficiently 
    different to distinguish these characters. However, this is not always the case. When this 
    character is allowed, the URL in line 1 of the following table may appear to be in the domain <b>
    macchiato.com</b>, but is actually in a particular subzone of the domain <b>bad.com</b>.</span></span></p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="2" border="1">
      <caption>Syntax Spoofing</caption>
      <tr>
        <th vAlign="top" class="idn-head">&nbsp;</th>
        <th vAlign="top" class="idn-head">URL</th>
        <th vAlign="top" class="idn-head">Subzone</th>
        <th vAlign="top" class="idn-head">Domain</th>
      </tr>
      <tr>
        <th vAlign="top" class="idn-head">1</th>
        <td vAlign="top"><span>http://macchiato.com/x.bad.com</span></td>
        <td vAlign="top"><span>macchiato.com/x</span></td>
        <td vAlign="top"><span>bad.com</span></td>
      </tr>
      <tr>
        <th vAlign="top" class="idn-head">2</th>
        <td vAlign="top"><span>http://macchiato.com?x.bad.com</span></td>
        <td vAlign="top"><span>macchiato.com?x</span></td>
        <td vAlign="top"><span>bad.com</span></td>
      </tr>
      <tr>
        <th vAlign="top" class="idn-head">3</th>
        <td vAlign="top"><span>http://macchiato.com.x.bad.com</span></td>
        <td vAlign="top"><span>macchiato.com.x</span></td>
        <td vAlign="top"><span>bad.com</span></td>
      </tr>
      <tr>
        <th vAlign="top" class="idn-head">4</th>
        <td vAlign="top"><span>http://macchiato.com#x.bad.com</span></td>
        <td vAlign="top"><span>macchiato.com#x</span></td>
        <td vAlign="top"><span>bad.com</span></td>
      </tr>
    </table>
    <p>Other syntax characters, if there are visual confusables, can be similarly spoofed, as in 
    lines <span>2 through 4. Many <span title="U+2044 FRACTION SLASH">
    <font face="Lucida Sans Unicode">— </font></span>but not all <span title="U+2044 FRACTION SLASH">
    <font face="Lucida Sans Unicode">— </font></span>of these cases, such as U+2024 (·)
    <span style="font-variant: small-caps">ONE DOT LEADER</span> are disallowed by Nameprep [<a href="tr36-3.html#RFC3491">RFC3491</a>].</span></p>
    <p><span>Of course, a spoof fooling the user into thinking that the domain name is the first 
    part of the URL does not require internationalized domain names. For example, in the following 
    the real domain name, bad.com, is also obscured for the casual user, who may not realize that -- 
    does not terminate the domain name.</span></p>
    <blockquote>
      <p><span><span>http://macchiato.com</span>--long-and-obscure-list-of-characters.<span>bad.com</span>?findid=12</span></p>
    </blockquote>
    <p><span>In retrospect, it would have been much better if domain names were customarily written 
    with &quot;most significant part first&quot;. The following hypothetical display would be harder to spoof: 
    the fact that it is &quot;com.bad&quot; is not as easily lost.</span></p>
    <blockquote>
      <p><span><span>http://com.bad.org/x.example?findid=12<br>
      http://com.bad.org</span>--long-and-obscure-list-of-characters.<span>example</span>?findid=12</span></p>
    </blockquote>
    <p><span><span>But that would be an impossible change at this point: it is long past the time 
    when such a radical change could have been made. However, a possible solution is to always 
    visually distinguish the domain, for example:</span></span></p>
    <blockquote>
      <p><span><span>http://<b><font color="#0000FF">macchiato.com</font></b></span><br>
      http://<b><font color="#0000FF">bad.com</font></b><br>
      http://macchiato.com/x.<b><font color="#0000FF">bad.com</font></b><br>
      <span>http://macchiato.com</span>--long-and-obscure-list-of-characters.<b><font color="#0000FF">bad.com</font></b>?findid=12</span></p>
    </blockquote>
    <p><span>As it turns out, some registries register at the third-level (such as http://<b>nominet</b>.org.uk), 
    and there is no rule that forbids a top-level domain to register at the fourth or even higher 
    level. So the user-agent needs to know which is the &quot;core&quot; level to distinguish for the user
    </span><i><font face="Lucida Sans Unicode">—</font></i><span> it may not be the second level. 
    For example, in the top-level domain .de, the second level is very important. That is the one 
    where security is most crucial because that is where there will be spoofs of banks, on-line 
    stores, etc. such as http://<b>amazon</b>.de. For the UK, on the other hand, the second level 
    domain is not very interesting from a security standpoint, since it is limited to co, me, org, 
    ltd, plc, net, sch, ac, gov, nhs, police, and mod (according to the Nominet site). There the 
    third level is the more important one; that is where someone will try to spoof http://<b>amazon</b>.co.uk.</span></p>
    <p>User Agents already have to deal with syntax issues. For example, when given the URL <u>
    http://something@macchiato.com</u>, Firefox gives something like the following alert:</p>
    <div align="center">
      <center>
      <table class="alert">
        <tr>
          <td class="alertcell">
          <img border="0" src="images/warning_triangle.gif" alt="warning" width="37" height="38"></td>
          <td class="alertcell">You are about to log into the site “macchiato.com” with the username 
          “something”, but the web site does not require authentication. This may be an attempt to 
          trick you.
          <p>Is “macchiato.com” the site you want to visit?</p>
          <p style="text-align: center">
          <input type="button" value="Yes" name="B4" style="width:5em">&nbsp;
          <input type="submit" value="No" name="B5" style="width:5em"></td>
        </tr>
      </table>
      </center>
    </div>
    <p>This mechanism can be used to alert the user to cases of syntax spoofing, a<span>s described 
    below.</span></p>
    <p><span>It is very important not to show a missing glyph or character with a simple &quot;?&quot;, since 
    that makes every such character be visually confusable with a real question mark. Instead, 
    follow the Unicode guidelines for displaying missing glyphs using a rounded-rectangle, as 
    described in <i>Section 5.3 Unknown and Missing Characters</i> of [<a href="tr36-3.html#Unicode">Unicode</a>] 
    and listed in <i>Appendix C. <a href="tr36-3.html#Missing_Character_Glyphs">Missing Character Glyphs</a></i>.</span></p>
    <h3><span>2.7 <a name="Numeric_Spoofs">Numeric Spoofs</a></span></h3>
    <p><span>Turning away from the focus on domain names for a moment, there is another area where 
    visual spoofs can be used. Many scripts have sets of decimal digits that are different in shape 
    from the typical European digits {0}. For example, Bengali has
    <span title="U+09E6 BENGALI DIGIT ZERO">{০ </span><span title="U+09E7 BENGALI DIGIT ONE">১</span><span title="U+09F4 BENGALI CURRENCY NUMERATOR ONE">
    </span><span title="U+09E8 BENGALI DIGIT TWO">২</span><span title="U+09F5 BENGALI CURRENCY NUMERATOR TWO">
    </span><span title="U+09E9 BENGALI DIGIT THREE">৩ </span>
    <span title="U+09EA BENGALI DIGIT FOUR">৪ </span><span title="U+09EB BENGALI DIGIT FIVE">৫
    </span><span title="U+09EC BENGALI DIGIT SIX">৬ </span><span title="U+09ED BENGALI DIGIT SEVEN">
    ৭ </span><span title="U+09EE BENGALI DIGIT EIGHT">৮ </span>
    <span title="U+09EF BENGALI DIGIT NINE">৯}, while Oriya has </span>{<span title="U+0B66 ORIYA DIGIT ZERO">୦
    </span><span title="U+0B67 ORIYA DIGIT ONE">୧ </span><span title="U+0B68 ORIYA DIGIT TWO">୨
    </span><span title="U+0B69 ORIYA DIGIT THREE">୩ </span><span title="U+0B6A ORIYA DIGIT FOUR">୪
    </span><span title="U+0B6B ORIYA DIGIT FIVE">୫ </span><span title="U+0B6C ORIYA DIGIT SIX">୬
    </span><span title="U+0B6D ORIYA DIGIT SEVEN">୭ </span><span title="U+0B6E ORIYA DIGIT EIGHT">୮
    </span><span title="U+0B6F ORIYA DIGIT NINE">୯}. While the sets taken as a whole are different 
    in shape, individual digits may have the same shapes as digits from other scripts, even digits 
    of different values. For example, the string </span><b><span title="U+09EA BENGALI DIGIT FOUR">৪</span></b><span title="U+0B68 ORIYA DIGIT TWO"><b>୨</b> 
    is visually confusable with <b>89</b> (at small sizes), but actually has the numeric value 42. 
    Where software interprets the numeric value of a string of digits without detecting that the 
    digits are from different scripts, it is possible to generate such spoofs.</span></span></p>
    <h3><span>2.8 <a name="Techniques">Techniques</a></span></h3>
    <p>This section lists techniques that can be used in reducing the risks of visual spoofing. 
    These techniques are referenced by <i>Section 2.10 <a href="tr36-3.html#Visual_Spoofing_Recommendations">
    Recommendations</a>.</i></p>
    <h4><span>2.8.1 <a name="Case_Folded_Format">Case-Folded Format</a></span></h4>
    <p><span>Many opportunities for spoofing can be removed by using a <i>case-folded</i> format. 
    This format, defined by the Unicode Standard, produces a string that only contains lowercase 
    characters where possible.</span></p>
    <p><span>However, there is one particular situation where the pure case-folded format of a 
    string as defined by the standard is not desired. The character U+03A3 &quot;Σ&quot; <i>capital sigma</i> 
    lowercases to U+03C3 &quot;σ&quot; <i>small sigma</i> if it is followed by another letter, but lowercases 
    to U+03C2 &quot;ς&quot; <i>small final sigma</i> if it is not. Because both σ and ς have a 
    case-insensitive match to Σ, and the case folding algorithm needs to map both of them together 
    (so that transitivity is maintained), only one of them appears in the case-folded form.</span></p>
    <p><span>When the case-folded format of a Greek string is to be displayed to the user, it should 
    be processed so as to choose the proper form for the small sigma, depending on the context. The 
    test for the context is provided in Table 3-13 of [<a href="tr36-3.html#Unicode">Unicode</a>]. It is the 
    test for Final_Sigma, where C represents the character σ. Basically, when σ comes after a cased 
    letter, and not before a cased letter (where certain ignorable characters can come in between), 
    it should be </span>transformed into ς.</p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="2" border="1">
      <caption>Final Sigma Handling (from Table 3-13)</caption>
      <tr>
        <th class="idn-head">Context</th>
        <th class="idn-head">Description</th>
        <th colSpan="2" class="idn-head">Regular Expressions</th>
      </tr>
      <tr>
        <th vAlign="top" rowSpan="2" class="idn-head">Final_Sigma</th>
        <td vAlign="top" rowSpan="2"><font size="2">C is preceded by a sequence consisting of a 
        cased letter and a case-ignorable sequence, and C is not followed by a sequence consisting 
        of a case ignorable sequence and then a cased letter.</font></td>
        <td vAlign="top" noWrap><font size="2">Before C:</font></td>
        <td vAlign="top" noWrap><font size="2">\p{cased} (\p{case-ignorable})*</font></td>
      </tr>
      <tr>
        <td vAlign="top" noWrap><font size="2">After C:</font></td>
        <td vAlign="top" noWrap><font size="2">! ( (\p{case-ignorable})* \p{cased} )</font></td>
      </tr>
    </table>
    <p><span>For more information on case mapping and folding, see the following: <i>Section
    <a href="http://www.unicode.org/versions/Unicode4.0.0/ch03.pdf#G33992">3.13 Default Case 
    Operations</a></i>, <i>Section
    <a href="http://www.unicode.org/versions/Unicode4.0.0/ch04.pdf#G124722">4.2 Case Normative</a></i>, 
    and <i>Section <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf#G21180">5.18 Case 
    Mappings</a></i> of [<a href="tr36-3.html#Unicode">Unicode</a>].</span></p>
    <h4><span>2.8.2 <a name="Mapping_and_Prohibition">Mapping and Prohibition</a></span></h4>
    <p>There are <span>two techniques to reduce the risk of spoofing that can usefully be applied to 
    identifiers: mapping and prohibition. IDNA uses both of these. A number of characters are 
    included in Unicode for compatibility. What is called <i>Compatibility Normalization</i> (NFKC) 
    can be used to map these characters to the regular variants (this is what is done in IDNA). For 
    example, a half-width Japanese <i>katakana</i> character
    <span title="U+FF76 HALFWIDTH KATAKANA LETTER KA">ｶ</span><span title="U+30AB KATAKANA LETTER KA"> 
    is mapped to the regular character カ. Additional mappings can be added beyond compatibility 
    mappings, for example, IDNA adds the following:</span></span></p>
    <blockquote>
      <p><span><code>200D; ZERO WIDTH JOINER</code> maps to nothing (that is, is removed)<br>
      <code>0041; 0061;</code> Case maps &#39;A&#39; to &#39;a&#39;<br>
      <code>20A8; 0072 0073;</code> Additional folding, mapping <span title="U+20A8 RUPEE SIGN">₨</span> 
      to &quot;rs&quot;</span></p>
    </blockquote>
    <p><span>In addition, characters may be prohibited. For example, IDNA prohibits
    <span title="U+0384 GREEK TONOS"><i>space</i> </span>and <i>no-break s</i><span title="U+0384 GREEK TONOS"><i>pace</i> 
    (U+00A0)</span>. Instead, for example, of removing a ZERO WIDTH JOINER, or mapping
    <span title="U+20A8 RUPEE SIGN">₨</span> to &quot;rs&quot;, one could prohibit these characters. There are 
    pluses and minuses to both approaches. If compatibility characters are widely used in practice, 
    in entering text, then it is much more user-friendly to remap them. This also extends to 
    deletion; for example, the ZERO WIDTH JOINER is commonly used to affect the presentation of 
    characters in languages such as Hindi or Arabic. In this case, text copied into the address box 
    may often contain the character.</span></p>
    <p><span>Where this is not the case, however, it may be advisable to simply prohibit the 
    character. It is unlikely, for example, that <span title="U+32D5 CIRCLED KATAKANA KA">㋕ would be 
    typed by a Japanese user, nor that it would need to work in copied text.</span></span></p>
    <p><span>Where both mapping and prohibition are used, the mapping should be done before the 
    prohibition, to ensure that characters do not &quot;sneak past&quot;. For example, the Greek character 
    TONOS <span title="U+0384 GREEK TONOS">(΄) ends up being prohibited, because it normalizes to <i>
    space + acute</i>, and <i>space</i> itself is prohibited.</span></span></p>
    <h3><span><span>2.9 <a name="Security_Levels_and_Alerts">Restriction Levels and Alerts</a></span></span></h3>
    <p><span><span>The Restriction Levels 1-5 are defined below for use in implementations. These 
    place restrictions on the use of identifiers according to the appropriate </span>Identifier 
    Profile as specified in <i>Appendix A. <a href="tr36-3.html#Identifier_Characters">Identifier Characters</a></i> 
    and the determination of script as specified in </span><i>Appendix D.
    <a href="tr36-3.html#Mixed_Script_Detection">Mixed Script Detection</a>.</i><span> For IDNA, the particular 
    Identifier Profile will be one of the two specified in </span><i>Appendix A.2
    <a href="tr36-3.html#IDN_Security_Profiles">IDN Security Profiles for Identifiers</a>.</i></p>
    <ol>
      <li><b>ASCII-Only</b><ul>
        <li>All characters in each identifier must be ASCII</li>
      </ul>
      </li>
      <li><b>Highly Restrictive</b><ul>
        <li>All characters in each identifier must be from a <span>single script, or from the 
        combinations: <i>Han + Hiragana + Katakana</i>; <i>Han + Bopomofo</i>; or <i>Han + Hangul</i></span></li>
        <li>No characters in the identifier can be<span> </span>outside of the Identifier Profile</li>
        <li>Note that this level will satisfy the vast majority of Latin-script users.</li>
      </ul>
      </li>
      <li><b><span>Moderately Restrictive</span></b><ul>
        <li>A<span>llow <i>Latin</i> with other scripts except <i>Cyrillic</i>, <i>Greek</i>, <i>
        Cherokee</i></span></li>
        <li><span>Otherwise, the same as </span><b>Highly Restrictive</b></li>
      </ul>
      </li>
      <li><b>Minimally Restrictive</b><ul>
        <li>A<span>llow arbitrary mixtures of scripts, e.g. Ωmega, Teχ, HλLF-LIFE, Toys-</span><span title="U+042F CYRILLIC CAPITAL LETTER YA">Я</span>-<span>Us</span></li>
        <li><span>Otherwise, the same as </span><b><span>Moderately </span>Restrictive</b></li>
      </ul>
      </li>
      <li><b><span>Unrestricted</span></b><ul>
        <li>A<span>ny valid identifiers, including characters outside of the Identifier Profile, 
        e.g. I<span title="U+2665 BLACK HEART SUIT">♥</span>NY.org</span></li>
      </ul>
      </li>
    </ol>
    <p><span>An appropriate alert should be generated if a domain name fails to satisfy the 
    Restriction Level chosen by the user. <span>Depending on the circumstances and the level 
    difference, t</span>he form of such alerts could be minimal, such as special coloring or icons 
    (perhaps with a tool-tip for more information); or more obvious, such as an alert dialog 
    describing the issue and requiring user confirmation before continuing<span>; or even more 
    stringent, such as disallowing the use of the identifier</span>. Where icons are used to 
    indicate the presence of characters from scripts, the glyphs in <i>Appendix C.
    <a href="tr36-3.html#Missing_Character_Glyphs">Missing Character Glyphs</a></i> can be used.</span></p>
    <p><span><i>Appendix A. <a href="tr36-3.html#Identifier_Characters">Identifier Characters</a></i> provides 
    for two profiles of identifiers that could be used in Restriction Levels 1 through 4. The strict 
    profile is the recommended one. If the lenient one is also allowed, the user should have a 
    choice in preferences, so that there is some way to limit the levels to using the strict input 
    profile.</span></p>
    <p>At all restriction levels, an appropriate alert should be generated if the domain name 
    contains a syntax character that might be used in a spoof, as described in <i>Section 2.6
    <a href="tr36-3.html#Syntax_Spoofing">Syntax Spoofing</a></i>. For example:</p>
    <div align="center">
      <center>
      <table class="alert">
        <tr>
          <td class="alertcell">
          <img border="0" src="images/warning_triangle.gif" alt="warning" width="37" height="38"></td>
          <td class="alertcell">You are about to go to the site “<span>bad.com</span>”, but part of 
          the address contains a character which may have led you to think you were going to “macchiato.com”. 
          This may be an attempt to trick you.
          <p>Is “<span>bad.com</span>” the site you want to visit?</p>
          <p style="text-align: center">
          <input type="button" value="Yes" name="B3" style="width:7em">&nbsp;
          <input type="submit" value="No" name="B1" style="width:7em">&nbsp;
          <input type="submit" value="Details &gt;&gt;&gt;" name="B6" style="width:7em"></p>
          <p><input type="checkbox" name="C1" value="ON" checked><font size="2">Remember my answer 
          for future addresses with “<span>bad.com</span>”</font></td>
        </tr>
      </table>
      </center>
    </div>
    <p><span>User-agents <span>should</span> remember when the user has accepted an alert, for say
    <i>Ωmega.com</i>, and permit future access without bothering the user again. This essentially 
    builds up a whitelist of allowed values. This whitelist should contain the nameprepped form of 
    each string. When used for visually confusable detection, each element in the whitelist should 
    also have an associated transformed string as described in Appendix B. If a system allows upper 
    and lowercase forms, then both transforms should be available. The program should allow access 
    to editing this whitelist directly, in case the user wants to correct the values. The whitelist 
    may also include items know to the user agent to be &#39;safe&#39;.</span></p>
    <h4>2.9.1 <a name="Backwards_Compabilility">Backwards Compabilility</a></h4>
    <p>The set of characters in the identifier profile and the results of the confusable mappings 
    may be refined over time, so implementations should recognize and allow for that. Characters are 
    continually being added to the Unicode Standard that may be valid for identifiers. The 
    confusable information may add more characters as visually confusable over time.</p>
    <p>There may also be cases where characters are no longer recommended for inclusion in 
    identifiers, and more information becomes available about them. Thus the identifier profile may 
    become more restrictive in a future version, for some characters. Of course, once identifiers 
    are registered they cannot be withdrawn, but new proposed identifiers that contain such 
    characters can be denied. A user-agent should give users a preference setting that essentially 
    uses the union of the old and new identifier profiles in determining the Restriction Levels.</p>
    <h3>2.10 <a name="Visual_Spoofing_Recommendations">Recommendations</a></h3>
    <p>The Unicode Consortium recommends a somewhat conservative approach at this point, because is 
    always easier to widen restrictions than narrow them. The Consortium is gathering data that 
    would allow for a finer-grained approach, and expects to refine these recommendations in the 
    future.</p>
    <p><span>Some have proposed restricting domain names according to language, to prevent spoofing. 
    In practice, that is very problematic: it is very difficult to determine the intended language 
    of many terms, especially product or company names, which are often constructed to be neutral 
    regarding language. Moreover, languages tend to be quite fluid; foreign words are continually 
    being adopted. Except for registries with very special policies (such as the blocking used by 
    some East Asian registries as described in [<a href="tr36-3.html#RFC3743">RFC3743</a>]), the language 
    association does not make too much sense.</span></p>
    <p><span>Instead, the recommendations call for combination of string preprocessing to remove 
    basic equivalences, promoting adequate rendering support, and putting restrictions in place 
    according to script and restricting by confusable characters. While the ICANN guidelines say 
    &quot;top-level domain registries will [...] associate each registered internationalized domain name 
    with one language or set of languages&quot; [<a href="tr36-3.html#ICANN">ICANN</a>], that guidance is better 
    interpreted as limiting to <i>script</i> rather than <i>language</i>.</span></p>
    <p><span>Also see the security discussions in IRI [<a href="tr36-3.html#RFC3987">RFC3987</a>], URI [<a href="tr36-3.html#RFC3986">RFC3986</a>], 
    and Nameprep [<a href="tr36-3.html#RFC3491">RFC3491</a>].</span></p>
    <h4><b><span>2.10.1 <a name="User_Recommendations">User Recommendations</a></span></b></h4>
    <ol type="A">
      <li><span>Use browsers, mail clients and software in general that have put user-agent 
      guidelines into place to detect spoofing.</span></li>
      <li>If registering domain names, verify<span> that the registry follows appropriate guidelines 
      for preventing spoofing. For more information, see <i>Appendix F.
      <a href="tr36-3.html#Country_Specific_IDN_Restrictions">Country-Specific IDN Restrictions</a></i>.</span></li>
      <li><span>If the desired domain name <span>can have</span> any whole-script or single-script 
      confusables (such as &quot;scope&quot; in Latin and Cyrillic), register those as well<span>, if not 
      automatically provided by the registry. For how to detect confusables, see </span><i>Appendix 
      B. </i></span><i><a href="tr36-3.html#Confusable_Detection">Confusable Detection</a></i>.</li>
      <li>Where there are alternative domain names, choose those that are less spoofable.</li>
      <li>When using bidi IRIs, follow the recommendations in <i>Section 2.5
      <a href="tr36-3.html#Bidirectional_Text_Spoofing">Bidirectional Text Spoofing</a></i>.</li>
    </ol>
    <h4><span>2.10.2 <a name="Recommendations_General">General Programmer Recommendations</a></span></h4>
    <ol type="A">
      <li><span>When parsing numbers: detect digits of mixed (or whole but unexpected) scripts and 
      alert the user.</span></li>
      <li>When defining <span>identifiers in programming languages, protocols, and other 
      environments:</span><ol>
        <li><span>Use the general security profile for identifiers from <i>Appendix A.
        <a href="tr36-3.html#Identifier_Characters">Identifier Characters</a>.</i></span></li>
        <li>For <span>equivalence of identifiers, preprocess both strings by applying NFKC and case 
        folding. Display all such identifiers to users in their processed form. (There may be two 
        displays: one in the original and one in the processed form.) An example of this methodology 
        is Nameprep [<a href="tr36-3.html#RFC3491">RFC3491</a>]. Although Nameprep itself is currently limited 
        to Unicode 3.2, the same methodology can be applied by implementations that need to support 
        more up-to-date versions of Unicode.</span></li>
      </ol>
      </li>
      <li>In <span>choosing or deploying fonts:</span><ol>
        <li>If there is no available glyph for a character, <i>never</i><span> show a simple &quot;?&quot; or 
        omit the character.</span></li>
        <li><span>Use distinctive fonts, where possible.</span></li>
        <li><span>Use a size that makes it easier to see the differences in characters. Disallow the 
        use of font sizes that are so small as to cause even more characters to be visually 
        confusable. </span>Use larger sizes for East/South/South East Asian scripts, such as for 
        Japanese and Thai.</li>
        <li>Watch for clipping, vertically and horizontally. That is, make sure that the visible 
        area extends outside of the text width and height, to the &#39;black-bit&#39; boundary.</li>
        <li><span>Assess the font support of the OS/platform according to recommendations D1-D3 
        below (see also the W3C [<a href="tr36-3.html#CharMod">CharMod</a>]). If it is inadequate, work with 
        the OS/platform vendor to address those problems, or implement your own handling of 
        problematic cases.</span></li>
      </ol>
      </li>
      <li><span>In developing rendering systems or fonts:</span><ol>
        <li><span>Verify that accents do not appear to apply to the wrong characters.</span></li>
        <li><span>Follow <a href="../../notes/tn2.1">UTN #2: <i>Rendering Combining 
        Marks</i></a> in providing layout of nonspacing marks that would otherwise collide. If this 
        is not done, follow the &quot;Show Hidden&quot; option of Section
        <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf">5.13 <i>Rendering Nonspacing 
        Marks</i></a> of [<a href="tr36-3.html#Unicode">Unicode</a>] for the display of nonspacing marks.</span></li>
        <li><span>Follow the Unicode guidelines for displaying missing glyphs using a 
        rounded-rectangle, as described in <i>Section 5.3 Unknown and Missing Characters</i> of [<a href="tr36-3.html#Unicode">Unicode</a>].<span> 
        The recommended glyphs according to scripts are shown in <i>Appendix C.
        <a href="tr36-3.html#Missing_Character_Glyphs">Missing Character Glyphs</a></i>.</span></span></li>
      </ol>
      </li>
    </ol>
    <h4><span><b>2.10.3 <a name="Recommendations_User_Agents">User Agent Recommendations</a></b></span></h4>
    <p><span>The following recommendations are for user agents in handling domain names. </span>The 
    term &#39;user agent&#39; is interpreted broadly to mean any program that displays Internationalized 
    Domain Names to a user, including browsers and emailers.</p>
    <p>For information on the confusable tests mentioned below, see Us<span>ing <i>Appendix B. </i>
    </span><i><a href="tr36-3.html#Confusable_Detection">Confusable Detection</a>. </i>If the user can see the 
    case-folded form, use the lowercase-only confusable mappings; otherwise use the broader 
    mappings.</p>
    <ol type="A">
      <li><span>Follow the General Recommendations above.</span></li>
      <li><span>Display</span><ol>
        <li><span>Either always show the domain name in </span>nameprepped form<span> [<a href="tr36-3.html#RFC3491">RFC3491</a>], 
        or make it very easy for the user to see it (see <i>Section </i></span><i>2.8.1
        <a href="tr36-3.html#Case_Folded_Format">Case-Folded Format</a></i><span>). For example, this could be 
        a tooltip interface, or a separate box.</span></li>
        <li><span><span>Always display the domain name w</span></span><span>ith a visually 
        highlighted &quot;core&quot; domain, to prevent syntax spoofs (see <i>Section 2.6
        <a href="tr36-3.html#Syntax_Spoofing">Syntax Spoofing</a></i>).</span></li>
        <li>Always display IRIs with bidi content according to the IRI specification [<a href="tr36-3.html#RFC3987">RFC3987</a>].</li>
      </ol>
      </li>
      <li><span><span>Preferences</span></span><ol>
        <li><span>In preferences, allow the user to select the </span><span><span>desired 
        Restriction Level to apply to domain names</span>. Set the default to Restriction Level 2.</span></li>
        <li><span>In preferences, allow the user to select among scripts that can be used without 
        alerting. The default could be based on the user&#39;s locale.</span></li>
        <li><span>In preferences, allow the user to choose a backwards compatibility setting; see
        </span><i>Section 2.9.1 <a href="tr36-3.html#Backwards_Compabilility">Backwards Compatibility</a></i>.</li>
      </ol>
      </li>
      <li>Alerts<ol>
        <li>If the user agent maintains a domain whitelist for the user, and the domain name is in 
        the whitelist, allow it and skip the remaining items in this section.</li>
        <li>If the visual appearance of a link (if it looks like a URL) does not match the end 
        location, alert the user.</li>
        <li>If the domain name does not <span>satisfy the requirements of the user preferences (such 
        as the Restriction Level), alert the user.</span></li>
        <li><span>If the domain name contains any letters confusable with syntax characters, alert 
        the user.</span></li>
        <li>If there is a whitelist, and the domain name is visually confusable with a whitelist 
        domain name, but not identical to it (after nameprep), alert the user.</li>
        <li><span>If any label in the domain name is a whole-script or a mixed-script confusable, 
        alert the user. </span></li>
      </ol>
      </li>
    </ol>
    <h4><span><b>2.10.4 <a name="Recommendations_Registries">Registry Recommendations</a></b></span></h4>
    <p><span>The following recommendations are for registries in dealing with domain names. </span>T<span>he 
    term &quot;Registry&quot; is to be interpreted broadly, as any agency that sets the policy for which 
    domain names are accepted.</span></p>
    <p><span>The .com operator can impose restrictions on the 2nd level domain label, but if someone 
    registers <i>foo.com</i>, then it is up to them to decide what will be allowed at the 3rd level 
    (for example, <i>bar.foo.com</i>). So for that purpose, the owner of <i>foo.com</i> is treated 
    as the &quot;registry&quot; for the 3rd level (the <i>bar</i>). The term &quot;Registrant&quot; is used to refer to 
    someone applying to a registry for a domain name.</span></p>
    <p>For information on the confusable tests mentioned below, see Us<span>ing <i>Appendix B. </i>
    </span><i><a href="tr36-3.html#Confusable_Detection">Confusable Detection</a>.</i></p>
    <ol type="A">
      <li><span>In the short term, use <span>Restriction Level </span>2 to restrict new domain 
      names.</span></li>
      <li>When a <span>proposed new domain name is confusable with an existing domain name, either 
      completely </span>block its registration, or at least block its registration by a different 
      registrant. <span>Thus an existing registration of &quot;ѕсоре.com&quot; (<i>Cyrillic</i>) would block a 
      registration of &quot;scope.com&quot; (<i>Latin</i>) by a different registrant.</span><ol type="A">
        <li><span>If the registry </span>uses Restriction Level<span> 2, the Single-Script Any-Case 
        data is used.</span></li>
        <li>If the registry raises the allowable Restriction Level beyond Level 2, <span>the </span>
        Mi<span>xed-Script Any-Case data is used.</span></li>
      </ol>
      </li>
    </ol>
    <p><span>Thus a registry could allow registration of <u>http://caxap.ru/</u> in Latin, or the 
    Cyrillic equivalent, or both <font face="Lucida Sans Unicode">— but for both, <i>only</i> with 
    the same registrant!</font></span></p>
    <h4><span><b>2.10.5 <a name="Recommendations_Registrars">Registrar Recommendations</a></b></span></h4>
    <p><span>The following recommendations are for registrars in dealing with domain names. </span>T<span>he 
    term &quot;Registrar&quot; is to be interpreted broadly, as any agency that presents a UI for registering 
    domain names, and allows users to see whether a name is registered. The same entity may be both 
    a Registrar and Registry.</span></p>
    <ol type="A">
      <li>When a user&#39;s name is (or would be) rejected by the registry for security reasons, show 
      the user why the name was rejected.</li>
    </ol>
    <h2><a name="Canonical_Represenation"></a>3. Non-Visual Security Issues</h2>
    <p>A common practice is to have a &#39;gatekeeper&#39; for a system. That gatekeeper checks incoming 
    data to ensure that it is safe, and passes only safe data through. Once in the system, the other 
    components assume that the data is safe. A problem arises when a component treats two pieces of 
    text as identical — typically by canonicalizing them to the same form — while the gatekeeper 
    only detected that one of them was unsafe.</p>
    <h3>3.1 <a name="UTF-8_Exploit">UTF-8 Exploit</a></h3>
    <p>There are three equivalent encoding forms for Unicode: UTF-8, UTF-16, and UTF-32. UTF-8 is 
    commonly used in XML and HTML; UTF-16 is the most common in program APIs; and UTF-32 is the best 
    for representing single characters. While these forms are all equivalent in terms of the ability 
    to express Unicode, the original usage of UTF-8 was open to a canonicalization exploit.</p>
    <p>Up to <a href="http://www.unicode.org/uni2book/u2.html"><i>The Unicode Standard, Version 3.0</i></a> 
    the <i>generation</i> of &quot;non-shortest form&quot; UTF-8 was forbidden, as was the <i>interpretation</i> 
    of illegal sequences, but not the interpretation of what was called the &quot;non-shortest form&quot;. 
    Where software does interpret the non-shortest forms, security issues can arise. For example:
    </p>
    <ul>
      <li>Process <i>A</i> performs security checks, but does not check for non-shortest forms. </li>
      <li>Process <i>B</i> accepts the byte sequence from process <i>A</i>, and transforms it into 
      UTF-16 while interpreting non-shortest forms. </li>
      <li>The UTF-16 text may then contain characters that should have been filtered out by process
      <i>A</i>.</li>
    </ul>
    <p>For example, the backslash character &quot;\&quot; can often be a dangerous character to let through a 
    gatekeeper, since it can be used to access different directories. Thus a gatekeeper might 
    specifically prevent it from getting through. The backslash is represented in UTF-8 as the byte 
    sequence &lt;5C&gt;. However, as a non-shortest form, backslash could also be represented as the byte 
    sequence&lt;C1 9C&gt;. When a gatekeeper does not check for non-shortest form, this situation can lead 
    to a severe security breach. For more information, see <span>[<a href="tr36-3.html#Related_Material">Related 
    Material</a>]</span>.</p>
    <p>To address this issue, the Unicode Technical Committee modified the definition of UTF-8 in
    <a href="../tr27/index.html">Unicode 3.1</a> to forbid conformant 
    implementations from interpreting non-shortest forms for
    <a href="http://www.unicode.org/glossary/#BMP_character">BMP characters</a>, and clarified some 
    of the conformance clauses.</p>
    <h3>3.2 <a name="Non_Visual_Recommendations">Recommendations</a></h3>
    <ol>
      <li>Ensure that all implementations of UTF-8 used in a system are conformant to the latest 
      version of Unicode.</li>
    </ol>
    <hr width="50%">
    <h2><span>Appendix A. <a name="Identifier_Characters">Identifier Characters</a></span></h2>
    <p>Identifiers are special-purpose strings used for identification <font face="Arial">—</font> 
    strings that are deliberately limited to particular repertoires for that purpose. Exclusion of 
    characters from identifiers does not at all affect the general use of those characters, such as 
    within documents. <span><i>UAX #31, Identifier and Pattern Syntax</i> [<a href="tr36-3.html#UAX31">UAX31</a>] 
    provides a recommended method of determining which strings should qualify as identifiers. The 
    UAX #31 specification extends the common practice of defining identifiers in terms of letters 
    and numbers to the Unicode repertoire. </span></p>
    <p>UAX #31<span> also permits other protocols to use that method as a base, and to define a <i>
    profile</i> that adds or removes characters. For example, identifiers for specific programming 
    languages typically add some characters like &#39;$&#39;, and remove others like &#39;-&#39; (because of the use 
    as <i>minus</i>), while IDNA removes &#39;_&#39; (among others). For more information, see <i>UAX #31, 
    Identifier and Pattern Syntax</i> [<a href="tr36-3.html#UAX31">UAX31</a>].</span></p>
    <p>This document provides for alternative identifier profiles. These are profiles of the 
    extended identifiers based on the <span>XID_Start and XID_Continue properties as defined in the 
    Unicode Character Database (see [<a href="tr36-3.html#DCore">DCore</a>]). In both cases, the identifiers 
    are folded: that is, there is a larger set of <i>input</i> characters that are allowed, but 
    these are folded together into a set of allowed <i>output</i> characters. The folding uses Case 
    Folding as defined in <i>Chapter 3. Conformance</i> of [<a href="tr36-3.html#Unicode">Unicode</a>], and 
    NFKD normalization as defined in [<a href="tr36-3.html#UAX15">UAX15</a>].</span></p>
    <p>The data files used in defining these profiles follow the UCD File Format, which has a 
    semicolon-delimited list of data fields associated with given characters. For more details, see 
    [<a href="tr36-3.html#UCDFormat">UCDFormat</a>].</p>
    <h3>A.1. <a name="General_Security_Profile">General Security Profile for Identifiers</a></h3>
    <p>The file [<a href="tr36-3.html#idmod">idmod</a>] provides data for a profile of identifiers in 
    environments where security is at issue. The file contains a small set of characters that are 
    recommended as additions (to the list of characters defined by the XID_Start and XID_Continue 
    properties), because they may be used in identifiers in a broader context than programming 
    identifiers, and a set of characters recommended to be restricted from use. The latter are 
    characters not in common use, removed so as to further reduce the possibilities for visual 
    confusion. Initially, the following are being excluded: characters not in modern use; characters 
    only used in specialized fields, such as liturgical characters, mathematical letter-like 
    symbols, and certain phonetic alphabetics; and ideographic characters that are not part of a set 
    of core CJK ideographs consisting of the CJK Unified Ideographs block plus IICore (the set of 
    characters defined by the IRG as the minimal set of required ideographs for East Asian use). A 
    small number of such characters are allowed back in so that the profile includes all the 
    characters in the country-specific restricted IDN lists: see <i><span>Appendix F.
    <a href="tr36-3.html#Country_Specific_IDN_Restrictions">Country-Specific IDN Restrictions</a>.</span></i></p>
    <p><i>The principle has been to be more conservative initially, allowing for the set to be 
    modified in the future as requirements for characters are refined. For information on handling 
    that, see Section 2.9.1 <a href="tr36-3.html#Backwards_Compabilility">Backwards Compatibility</a>.</i></p>
    <p>In the file [<a href="tr36-3.html#idmod">idmod</a>], Field 2 is an action (either <i>restricted</i> or
    <i>addition</i>), and Field 3 is a reason.</p>
    <p>This list is also used in deriving the IDN Identifiers list given below. It is, however, 
    designed to be applied to other environments, and is not limited to Unicode 3.2 (as IDNA is 
    currently), so that it can be applied to a future version of IDNA that includes the (large) 
    repertoire of characters that have been added since Unicode 3.2.</p>
    <h3>A.2. <a name="IDN_Security_Profiles">IDN Security Profiles for Identifiers</a></h3>
    <p><span>The file [<a href="tr36-3.html#idnchars">idn-chars</a>] provides data for composition a list of 
    all and only those characters recommended for use in IDN, as described in the recommendations 
    above. It is presented as a series of tables organized by the <i>type</i>, as given in Field 2 
    in the file.</span></p>
    <p>Two profiles are defined: <span><i>strict</i> and <i>lenient</i>.</span></p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="2" border="1">
      <caption>Recommended IDN Identifier Profiles</caption>
      <tr>
        <th vAlign="top" width="33%">&nbsp;</th>
        <th vAlign="top" width="33%">Strict Profile</th>
        <th vAlign="top" width="33%">Lenient Profile</th>
      </tr>
      <tr>
        <th vAlign="top">Types allowed in output identifiers</th>
        <td vAlign="top" style="text-align: center"><i>output</i></td>
        <td vAlign="top" style="text-align: center"><i>output</i></td>
      </tr>
      <tr>
        <th vAlign="top">Types allowed in input identifiers</th>
        <td vAlign="top" style="text-align: center"><i>output + input</i></td>
        <td vAlign="top" style="text-align: center"><i>output + input + input-lenient</i></td>
      </tr>
    </table>
    <p>In both profiles, both input and output identifiers cannot start with a <i>nonstarting</i> 
    character. The only difference between the profiles is that the lenient profile allows more 
    characters on input.</p>
    <p>The following provides BNF descriptions using the extended BNF found in Section 0.3 of [<a href="tr36-3.html#Unicode">Unicode</a>], 
    supplemented by the property syntax of [<a href="tr36-3.html#UTS18">UTS18</a>].</p>
    <h4><b>Strict Profile BNF:</b></h4>
    <p><font size="2">&lt;strict-profile-output&gt; := &lt;SP-output-start&gt; &lt;SP-output-continue&gt;*<br>
    &lt;SP-output-start&gt; := [[:SP-output-continue:] - [:nonstarting:]]<br>
    &lt;SP-output-continue&gt; := [:output-type:]</font></p>
    <p><font size="2">&lt;strict-profile-input&gt; := &lt;SP-input-start&gt; &lt;SP-input-continue&gt;*<br>
    &lt;SP-input-start&gt; := [[:SP-input-continue:] - [:nonstarting:]]<br>
    &lt;SP-input-continue&gt; := [[output-type:][:input-type:]]</font></p>
    <h4><b>Lenient Profile BNF:</b></h4>
    <p><font size="2">&lt;lenient-profile-output&gt; := &lt;strict-profile-output&gt;</font></p>
    <p><font size="2">&lt;lenient-profile-input&gt; := &lt;LP-input-start&gt; &lt;LP-input-continue&gt;*<br>
    &lt;LP-input-start&gt; := [[:LP-input-continue:] - [:nonstarting:]]<br>
    &lt;LP-input-continue&gt; := [[:output-type:][:input-type:][:input-lenient-type:]]</font></p>
    <p>The only distinction between them is the inclusion of [:input-lenient-type:] on the very last 
    line.</p>
    <p>The following table provides more description of the types given by Field 2.</p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="2" border="1">
      <caption>IDN Identifier Profile Types</caption>
      <tr>
        <th vAlign="top">Type</th>
        <th vAlign="top">Description</th>
      </tr>
      <tr>
        <td vAlign="top" nowrap>output</td>
        <td vAlign="top">This type marks characters that are retained in this profile in the output 
        of IDN; that is, any characters outside of this set are not allowed by this profile. It is 
        formed by taking everything in IDNA [<a href="tr36-3.html#RFC3491">RFC3491</a>], and intersecting that 
        with the characters in <i>A.1. General Identifiers.</i></td>
      </tr>
      <tr>
        <td vAlign="top" nowrap>input</td>
        <td vAlign="top">This type marks <i>additional</i> characters (beyond those in <i>output</i>) 
        which are retained on input to IDNA in this profile. These are characters that case-fold to 
        the characters in <i>output</i>.</td>
      </tr>
      <tr>
        <td vAlign="top" nowrap>input-lenient</td>
        <td vAlign="top">This type marks <i>additional</i> characters (beyond those in <i>output</i> 
        and <i>input</i>) which are be retained on input to IDNA, but only in the <i>non-strict</i> 
        profile. These are IDNA characters that normalize to the characters in <i>output</i>.</td>
      </tr>
      <tr>
        <td vAlign="top" nowrap>nonstarting</td>
        <td vAlign="top">This type marks<span> characters that are disallowed at the start of an 
        identifier, either input or output. (</span>IDNA, unlike <span>[<a href="tr36-3.html#UAX31">UAX31</a>] 
        or most programming languages, does not place restrictions on which characters can start an 
        identifier.)</span></td>
      </tr>
    </table>
    <p>In both profiles, on input the following characters should be pre-mapped. That is, in 
    circumstances where the user is typing in a URL into an address bar, these are recommended so as 
    to allow people to type characters that they may not otherwise easily be able to type. However, 
    this is <i>not</i> formally part of the identifier profile; simply a recommendation for GUIs, 
    given the constraints of the identifier profile.</p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="2" border="1">
      <caption>Remapping Characters</caption>
      <tr>
        <td vAlign="top" nowrap>0027 → 2019 </td>
        <td vAlign="top" nowrap style="text-align: center">&#39; → ʼ</td>
        <td vAlign="top">APOSTROPHE<br>
        → MODIFIER LETTER APOSTROPHE</td>
      </tr>
      <tr>
        <td vAlign="top" nowrap>2018 → 02BB</td>
        <td vAlign="top" nowrap style="text-align: center">‘ → ʻ</td>
        <td vAlign="top">LEFT SINGLE QUOTATION MARK<br>
        &nbsp;→ MODIFIER LETTER TURNED COMMA</td>
      </tr>
      <tr>
        <td vAlign="top" nowrap>2019 → 02BC</td>
        <td vAlign="top" nowrap style="text-align: center">’ → ʼ</td>
        <td vAlign="top">RIGHT SINGLE QUOTATION MARK<br>
        → MODIFIER LETTER APOSTROPHE</td>
      </tr>
      <tr>
        <td vAlign="top" nowrap>309B → 3099</td>
        <td vAlign="top" nowrap style="text-align: center">゛ → ゙</td>
        <td vAlign="top">KATAKANA-HIRAGANA VOICED SOUND MARK<br>
        → COMBINING KATAKANA-HIRAGANA VOICED SOUND MARK</td>
      </tr>
      <tr>
        <td vAlign="top" nowrap>309C → 309A</td>
        <td vAlign="top" nowrap style="text-align: center">゜ → ゚</td>
        <td vAlign="top">KATAKANA-HIRAGANA SEMI-VOICED SOUND MARK<br>
        → COMBINING KATAKANA-HIRAGANA SEMI-VOICED SOUND MARK</td>
      </tr>
    </table>
    <h2><br>
    <b>Appendix B. <a name="Confusable_Detection">Confusable Detection</a></b></h2>
    <p>The tables in the data file [<a href="tr36-3.html#confusables">confusables</a>] provide a mechanism for 
    determining when two strings are visually confusable. <i>The data in these files may be refined 
    and extended over time. For information on handling that, see Section 2.9.1
    <a href="tr36-3.html#Backwards_Compabilility">Backwards Compatibility</a>. </i>The data is organized into 
    four different tables, depending on the desired parameters. Each table provides a mapping from 
    source characters to target strings.</p>
    <p>On the basis of this data, there are three main classes of confusable strings:</p>
    <blockquote>
      <p>X and Y are <i>single-script confusables</i> if they are confusable according to the 
      Single-Script table, and each of them is a single script string according to <i>Appendix D.
      <a href="tr36-3.html#Mixed_Script_Detection">Mixed Script Detection</a>. Examples: </i>&quot;so̷s&quot; and &quot;søs&quot; 
      in Latin.</p>
      <p>X and Y are <i>mixed-script confusables</i> if they are confusable according to the 
      Mixed-Script table, and they are not single-script confusables. Example: &quot;paypal&quot; in Latin and 
      &quot;paypal&quot; with the &#39;a&#39; being in Cyrillic.</p>
      <p>X and Y are <i>whole-script confusables</i> if they are <i>mixed-script confusables, </i>
      and each of them is a single script string<i>.</i> Example: &quot;scope&quot; in Latin and &quot;scope&quot; in 
      Cyrillic.</p>
    </blockquote>
    <p>To see whether two strings X and Y are confusable according to a given table, an 
    implementation first converts both X and Y to NFKD format, as described in [<a href="tr36-3.html#UAX15">UAX15</a>]. 
    It then produces transform(X) from X, by successively mapping each source character in X to the 
    target string, and then produces transform(Y) from Y by the same process. The resulting strings 
    transform(X) and transform(Y) are then compared. If they are identical (codepoint-for-codepoint), 
    then the original strings are visually confusable according to the table.</p>
    <blockquote>
      <p><b>Note:</b> the strings transform(X) and transform(Y) are <b><i>not</i></b> intended for 
      display, storage or transmission. They should be thought of instead as an intermediate 
      processing form, a kind of hashcode or skeleton. The characters in transform(X) and 
      transform(Y) are <b><i>not</i></b> guaranteed to be identifier characters.</p>
    </blockquote>
    <p>Implementations do not have to recursively apply the mappings, because the transforms are 
    idempotent. That is, </p>
    <p align="center">transform(transform(X)) = transform(X).</p>
    <p>For each table, field 1 is the source, field 2 is the target, and Field 3 is a type. The 
    different tables are distinguished by type:</p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="2" border="1">
      <caption>Confusable Data Table Types</caption>
      <tr>
        <th vAlign="top">Type</th>
        <th vAlign="top">Name</th>
        <th vAlign="top">Description</th>
      </tr>
      <tr>
        <td vAlign="top">SL</td>
        <td vAlign="top">Single-Script, Lowercase</td>
        <td vAlign="top">This table is used to test cases of single-script confusables, where the 
        output only allows lowercase. For example:<blockquote>
          <p><font size="2"># ( ø → o̷&nbsp; ) LATIN SMALL LETTER O WITH STROKE → LATIN SMALL LETTER 
          O, COMBINING SHORT SOLIDUS OVERLAY</font></p>
        </blockquote>
        </td>
      </tr>
      <tr>
        <td vAlign="top">SA</td>
        <td vAlign="top">Single-Script, Any-Case</td>
        <td vAlign="top">This table is used to test cases of single-script confusables, where the 
        output allows for mixed case (which may be later folded away). For example, this table 
        contains the following entry not found in SL:<blockquote>
          <p><font size="2"># ( O → 0 ) LATIN CAPITAL LETTER O → DIGIT ZERO</font></p>
        </blockquote>
        </td>
      </tr>
      <tr>
        <td vAlign="top">ML</td>
        <td vAlign="top">Mixed-Script, Lowercase</td>
        <td vAlign="top">This table is used to test cases of mixed-script and whole-script 
        confusables, where the output only allows lowercase. For example, this table contains the 
        following entry not found in SL or SA:<blockquote>
          <p><font size="2"># ( ν → v ) GREEK SMALL LETTER NU → LATIN SMALL LETTER V </font></p>
        </blockquote>
        </td>
      </tr>
      <tr>
        <td vAlign="top">MA</td>
        <td vAlign="top">Mixed-Script, Any-Case</td>
        <td vAlign="top">This table is used to test cases of mixed-script and whole-script 
        confusables, where the output allows for mixed case (which may be later folded away). For 
        example, this table contains the following entry not found in SL, SA, or ML:<blockquote>
          <p><font size="2"># ( Ι → l ) GREEK CAPITAL LETTER IOTA → LATIN SMALL LETTER L</font></p>
        </blockquote>
        </td>
      </tr>
    </table>
    <p><b>Note: </b>It would be possible to provide a more sophisticated confusable detection, by 
    providing a metric between given characters, indicating their &#39;closeness&#39;. However, that is 
    computationally much more expensive, and requires more sophisticated data, so at this point in 
    time the simpler mechanism has been chosen. It does impose transitivity on the data, so if X ~ Y 
    and Y ~ Z, then X ~ Z.</p>
    <h3>Appendix B.1 <a name="Whole_Script_Confusables">Whole-Script Confusables</a></h3>
    <p>Data is also provided for testing a string to see if a string has possible whole-script 
    confusables, using the file [<a href="tr36-3.html#confusablesWS">confusablesWS</a>]. This file consists of 
    a list of lines of the form:</p>
    <pre>&lt;range&gt;; &lt;sourceScript&gt;; &lt;targetScript&gt;; &lt;type&gt; #comment</pre>
    <p>The types are either L for lowercase-only, or A for any-case, where the any-case ranges are 
    broader (including uppercase and lowercase characters). If the string is only lowercase, use the 
    lowercase-only table. Otherwise, first test according to the any-case table, then lowercase the 
    string and test according to the lowercase-only table.</p>
    <p>In using the data, all of the lines having the same <i>sourceScript</i> and <i>targetScript</i> 
    are collected together to form a set of Unicode characters. Logically, the file is thus a set of 
    tuples of the form &lt;<i>sourceScript, unicodeSet, targetScript</i>&gt;. For example, the following 
    lines are present for Latin to Cyrillic:</p>
    <pre>0061       ; Latn; Cyrl; L #     (a)    LATIN SMALL LETTER A
0063..0065 ; Latn; Cyrl; L # [3] (c..e) LATIN SMALL LETTER C..LATIN SMALL LETTER E
...
0292       ; Latn; Cyrl; L #     (ʒ)    LATIN SMALL LETTER EZH</pre>
    <p>They logically form a tuple &lt;<i>Latin, [a c-e ... \u0292], Cyrillic</i>&gt;, which indicates 
    that a Latin string containing characters only from that Unicode set can have a whole-script 
    confusable in Cyrillic (lowercase-only).</p>
    <p>To test to see if a single-script string <i>givenString</i> has a whole-script confusable in
    <i>targetScript</i>, the following process is used.</p>
    <ol>
      <li>Convert the givenString to NFKD format, as specified in [<a href="tr36-3.html#UAX15">UAX15</a>]</li>
      <li>Let <i>givenSet</i> be the set of all characters in givenString</li>
      <li>Remove all [:script=common:] and [:script=inherited:] characters from <i>givenSet</i> </li>
      <li>Let <i>givenScript</i> be the script of the characters in <i>givenSet</i><ul>
        <li>(if there is more than one script, fail with error).</li>
      </ul>
      </li>
      <li>See if there is a tuple &lt;<i>sourceScript, unicodeSet, targetScript</i>&gt; where<ul>
        <li><i>sourceScript</i> =<i> givenScript</i></li>
        <li><i>unicodeSet</i> <font face="Lucida Sans Unicode">⊇ <i>givenSet</i></font></li>
      </ul>
      </li>
      <li><font face="Lucida Sans Unicode">If so, then there is a whole-script confusable in <i>
      targetScript</i></font></li>
    </ol>
    <p>The test is actually slightly broader than simply a whole-script confusable; what it tests is 
    whether the given string has a whole-script confusable string in another script, possibly with 
    the addition or removal of common/inherited characters such as numbers and combining marks 
    characters to both strings. In practice, however, this has no significant impact.</p>
    <p>Implementations would normally read the data into appropriate data structures in memory for 
    processing. A quick additional optimization is to keep, for each script, a <i>fastReject</i> 
    set, containing characters in the script contained in none of the <i>unicodeSet</i> values. </p>
    <p>The following is a Java sample of how this code can work (using the Java version of [<a href="tr36-3.html#ICU">ICU</a>]):</p>
    <p></p>
    <pre>/*
 * For this routine, we don&#39;t care what the target scripts are,
 * just whether there is at least one whole-script confusable.
 */ 
boolean hasWholeScriptConfusable(String s) {
	int givenScript = getSingleScript(s);
	if (givenScript == UScript.INVALID_CODE) {
		throw new IllegalArgumentException(&quot;Not single script string&quot;);
	}
	UnicodeSet givenSet = new UnicodeSet()
		.addAll(s)
		.removeAll(commonAndInherited);
	if (fastReject[givenScript].containsSome(givenSet)) return false;
	UnicodeSet[] possibles = scriptToUnicodeSets[givenScript];
	for (int i = 0; i &lt; possibles.length; ++i) {
		if (possibles[i].containsAll(givenSet)) return true;
	}
	return false;
}</pre>
    <p>The data in [<a href="tr36-3.html#confusablesWS">confusablesWS</a>] is built using the data in [<a href="tr36-3.html#confusables">confusables</a>], 
    and subject to the same caveat: <i>the data in these files may be refined and extended over 
    time. For information on handling that, see Section 2.9.1 <a href="tr36-3.html#Backwards_Compabilility">
    Backwards Compatibility</a>.</i></p>
    <h3>Appendix B.2 <a name="Mixed_Script_Confusables">Mixed-Script Confusables</a></h3>
    <p>To test for mixed-script confusables, use the following process.</p>
    <p>Convert the given string to NFKD format, as specified in [<a href="tr36-3.html#UAX15">UAX15</a>]. For 
    each script found in the given string, see if all the characters in the string outside of that 
    script have whole-script confusables for that script (according to <i>Appendix B.1
    <a href="tr36-3.html#Whole_Script_Confusables">Whole-Script Confusables</a>)</i>.</p>
    <p>Example 1: &#39;pаypаl&#39;, with Cyrillic &#39;а&#39;s.</p>
    <blockquote>
      <p>There are two scripts, Latin and Cyrillic. The set of Cyrillic characters {a}&nbsp; has a 
      whole-script confusable in Latin. Thus the string is a mixed-script confusable. </p>
    </blockquote>
    <p>Example 2: &#39;t<span>oys-</span><font SIZE="3">я</font><span>-us</span>&#39;, with one Cyrillic 
    character &#39;<font SIZE="3">я&#39;</font>.</p>
    <blockquote>
      <p>The set of Cyrillic characters {<font SIZE="3">я}</font> does not have a whole-script 
      confusable in Latin (there is no Latin character that looks like &#39;<font SIZE="3">я&#39;</font>, 
      nor does the set of Latin characters {o s t u y} have a whole-script confusable in Cyrillic 
      (there is no Cyrillic character that looks like &#39;t&#39; or &#39;u&#39;). Thus this string is not a 
      mixed-script confusable.</p>
    </blockquote>
    <p>Example 3: &#39;1iνе&#39;, with a Greek &#39;ν&#39; and Cyrillic &#39;е&#39;.</p>
    <blockquote>
      <p>There are three scripts, Latin, Greek, and Cyrillic. The set of Cyrillic characters {е} and 
      the set of Greek characters {ν} each have a whole-script confusable in Latin. Thus the string 
      is a mixed-script confusable. </p>
    </blockquote>
    <h2><span>Appendix C. <a name="Missing_Character_Glyphs">Missing Character Glyphs</a></span></h2>
    <p>The following is proposed for acceptance in [<a href="tr36-3.html#UAX24">UAX24</a>]. Once that document 
    is final, it will be removed from this document.</p>
    <table cellSpacing="0" cellPadding="2" border="1">
      <tr>
        <td class="script" width="33%"><span>
        <img src="images/latin.gif" alt="X" width="24" height="24"> Latin</span></td>
        <td class="script" width="33%"><span>
        <img src="images/tibetan.gif" alt="X" width="24" height="24"> Tibetan</span></td>
        <td class="script" width="33%"><span>
        <img src="images/hanunoo.gif" alt="X" width="24" height="24"> Hanunoo</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/greek.gif" alt="X" width="24" height="24"> Greek</span></td>
        <td class="script"><span><img src="images/myanmar.gif" alt="X" width="24" height="24"> 
        Myanmar</span></td>
        <td class="script"><span><img src="images/buhid.gif" alt="X" width="24" height="24"> Buhid</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/cyrillic.gif" alt="X" width="24" height="24"> 
        Cyrillic</span></td>
        <td class="script"><span><img src="images/georgian.gif" alt="X" width="24" height="24"> 
        Georgian</span></td>
        <td class="script"><span><img src="images/tagbanwa.gif" alt="X" width="24" height="24"> 
        Tagbanwa</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/armenian.gif" alt="X" width="24" height="24"> 
        Armenian</span></td>
        <td class="script"><span>
        <img src="images/hangulsyllables.gif" alt="X" width="24" height="24"> Hangul</span></td>
        <td class="script"><span><img src="images/limbu.gif" alt="X" width="24" height="24"> Limbu</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/hebrew.gif" alt="X" width="24" height="24"> Hebrew</span></td>
        <td class="script"><span><img src="images/ethiopic.gif" alt="X" width="24" height="24"> 
        Ethiopic</span></td>
        <td class="script"><span><img src="images/taile.gif" alt="X" width="24" height="24"> Tai Le</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/arabic.gif" alt="X" width="24" height="24"> Arabic</span></td>
        <td class="script"><span><img src="images/cherokee.gif" alt="X" width="24" height="24"> 
        Cherokee</span></td>
        <td class="script"><span>
        <img src="images/linearbsyllabary.gif" alt="X" width="24" height="24"> Linear B</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/syriac.gif" alt="X" width="24" height="24"> Syriac</span></td>
        <td class="script"><span>
        <img src="images/canadiansyllabics.gif" alt="X" width="24" height="24"> Canadian Aboriginal</span></td>
        <td class="script"><span><img src="images/ugaritic.gif" alt="X" width="24" height="24"> 
        Ugaritic</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/thaana.gif" alt="X" width="24" height="24"> Thaana</span></td>
        <td class="script"><span><img src="images/ogham.gif" alt="X" width="24" height="24"> Ogham</span></td>
        <td class="script"><span><img src="images/shavian.gif" alt="X" width="24" height="24"> 
        Shavian</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/devanagari.gif" alt="X" width="24" height="24"> 
        Devanagari</span></td>
        <td class="script"><span><img src="images/runic.gif" alt="X" width="24" height="24"> Runic</span></td>
        <td class="script"><span><img src="images/osmanya.gif" alt="X" width="24" height="24"> 
        Osmanya</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/bengali.gif" alt="X" width="24" height="24"> 
        Bengali</span></td>
        <td class="script"><span><img src="images/khmer.gif" alt="X" width="24" height="24"> Khmer</span></td>
        <td class="script"><span><img src="images/cypriot.gif" alt="X" width="24" height="24"> 
        Cypriot</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/gurmukhi.gif" alt="X" width="24" height="24"> 
        Gurmukhi</span></td>
        <td class="script"><span><img src="images/mongolian.gif" alt="X" width="24" height="24"> 
        Mongolian</span></td>
        <td class="script"><span>
        <img src="images/braillesymbols.gif" alt="X" width="24" height="24"> Braille</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/gujarati.gif" alt="X" width="24" height="24"> 
        Gujarati</span></td>
        <td class="script"><span><img src="images/hiragana.gif" alt="X" width="24" height="24"> 
        Hiragana</span></td>
        <td class="script"><span><img src="images/buginese.gif" alt="X" width="24" height="24"> 
        Buginese</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/oriya.gif" alt="X" width="24" height="24"> Oriya</span></td>
        <td class="script"><span><img src="images/katakana.gif" alt="X" width="24" height="24"> 
        Katakana</span></td>
        <td class="script"><span><img src="images/coptic.gif" alt="X" width="24" height="24"> Coptic</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/tamil.gif" alt="X" width="24" height="24"> Tamil</span></td>
        <td class="script"><span><img src="images/bopomofo.gif" alt="X" width="24" height="24"> 
        Bopomofo</span></td>
        <td class="script"><span><img src="images/newtailu.gif" alt="X" width="24" height="24"> New 
        Tai Lue</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/telugu.gif" alt="X" width="24" height="24"> Telugu</span></td>
        <td class="script"><span>
        <img src="images/kangxiradicals.gif" alt="X" width="24" height="24"> Han</span></td>
        <td class="script"><span><img src="images/glagolitic.gif" alt="X" width="24" height="24"> 
        Glagolitic</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/kannada.gif" alt="X" width="24" height="24"> 
        Kannada</span></td>
        <td class="script"><span><img src="images/yi.gif" alt="X" width="24" height="24"> Yi</span></td>
        <td class="script"><span><img src="images/tifinagh.gif" alt="X" width="24" height="24"> 
        Tifinagh</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/malayalam.gif" alt="X" width="24" height="24"> 
        Malayalam</span></td>
        <td class="script"><span><img src="images/olditalic.gif" alt="X" width="24" height="24"> Old 
        Italic</span></td>
        <td class="script"><span><img src="images/silotinagri.gif" alt="X" width="24" height="24"> 
        Syloti Nagri</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/sinhala.gif" alt="X" width="24" height="24"> 
        Sinhala</span></td>
        <td class="script"><span><img src="images/gothic.gif" alt="X" width="24" height="24"> Gothic</span></td>
        <td class="script"><span>
        <img src="images/oldpersiancuneiform.gif" alt="X" width="24" height="24"> Old Persian</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/thai.gif" alt="X" width="24" height="24"> Thai</span></td>
        <td class="script"><span><img src="images/deseret.gif" alt="X" width="24" height="24"> 
        Deseret</span></td>
        <td class="script"><span><img src="images/kharoshthi.gif" alt="X" width="24" height="24"> 
        Kharoshthi</span></td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/lao.gif" alt="X" width="24" height="24"> Lao</span></td>
        <td class="script"><span><img src="images/tagalog.gif" alt="X" width="24" height="24"> 
        Tagalog</span></td>
        <td class="script">&nbsp;</td>
      </tr>
      <tr>
        <td class="script" colspan="3" bgcolor="#EEEEFF">&nbsp;</td>
      </tr>
      <tr>
        <td class="script"><span><img src="images/common.gif" alt="X" width="24" height="24"> Common</span></td>
        <td class="script"><span>
        <img src="images/combiningdiacritics.gif" alt="X" width="24" height="24"> Inherited</span></td>
        <td class="script">&nbsp;</td>
      </tr>
    </table>
    <h2><span><br>
    Appendix D. <a name="Mixed_Script_Detection">Mixed Script Detection</a></span></h2>
    <p>The Unicode Standard supplies information that can be used for determining the script of 
    characters and detecting mixed-script text. <span>The determination of script is according to 
    the Unicode Standard [<a href="tr36-3.html#UAX24">UAX24</a>], using data from the Unicode Character 
    Database [<a href="tr36-3.html#UCD">UCD</a>].</span></p>
    <p>In determining mixed script,<span> <i>Common</i> and <i>Inherited</i> script characters are 
    ignored, except for non-Identifier Characters (see <i>Appendix A.
    <a href="tr36-3.html#Identifier_Characters">Identifier Characters</a></i>). For example, &quot;abc-def&quot; counts 
    as a single script: the script of &quot;-&quot; is ignored. The string &quot;I<span title="U+2665 BLACK HEART SUIT">♥</span>NY&quot;, 
    on the other hand, counts as mixed-script, since the heart character is outside of the 
    Identifier Characters.</span></p>
    <p>The following is a Java sample of how this code can work (using the Java version of [<a href="tr36-3.html#ICU">ICU</a>]):</p>
    <pre>private static boolean isMixedScript(String source) {
	int lastScript = UScript.INVALID_CODE;
	int cp;
	for (int i = 0; i &lt; source.length(); i += UTF16.getCharCount(cp)) {
		cp = UTF16.charAt(source, i);
		int script = UScript.getScript(cp);
		if (script == UScript.COMMON || script == UScript.INHERITED) {
			if (IdentifierSet.contains(cp)) continue; // skip if not identifier
			script = UScript.COMMON;
		}
		if (lastScript == UScript.INVALID_CODE) lastScript = script;
		else if (script != lastScript) return true;
	}
	return false;
}</pre>
    <p>This depends on <code>IdentifierSet</code> (a <code>UnicodeSet</code>) being set up with the 
    proper contents according to <span><i>Appendix A. <a href="tr36-3.html#Identifier_Characters">Identifier 
    Characters</a>.</i></span></p>
    <p>Using the Unihan data in the <span>Unicode Character Database [<a href="tr36-3.html#UCD">UCD</a>] it
    </span>is possible to extend this mechanism, to qualify strings as &#39;mixed script&#39; where they 
    contain both simplified-only and traditional-only Chinese characters.</p>
    <h2>Appendix E. <a name="Future_Topics">Future Topics</a></h2>
    <p>The following are topics that should be addressed in a future version of this document.</p>
    <p><b>Visual Spoofs</b></p>
    <ol>
      <li><span>Give more background as to why normalization fixes certain problems, and which it 
      does not fix. Describe how implementations of normalization can use small data set limited to 
      only supported characters. Describe the recommended use of normalization in non-domain part of 
      URL.</span></li>
      <li><span>Show how reverse-bidi (visual order -&gt; storage order) could be used to detect bidi 
      spoofs. That is: one can apply bidi then reverse bidi: if the result does not match the 
      original, then reject the string.</span></li>
      <li><span>Explain how private use characters can cause security problems, and recommend 
      strongly against their use (not a problem for IDN, but for other identifiers it can be).</span></li>
      <li><span>Add information on spoofs that only work with contextual scripts, such as Arabic and 
      Indic, where the same visual appearance may result from two different undering character 
      sequences — <i>in the right context</i>.</span></li>
      <li><span>Discuss security issues in Collation (sorting, searching, matching), where if user 
      expectations are not met, they may make incorrect choices.</span></li>
      <li><span>Describe how TrueType/OpenType fonts can be used in spoofing: fonts are actually 
      programs that can deform glyph shapes radically according to resolution, platform, or 
      language. For example $100.00 could appear as $200.00 when printed.</span></li>
      <li><span>Discuss SSL and how root Certificate Authorities can be a problem, but are also part 
      of the solution; most customers would lose faith quickly in internet financial transaction if 
      SSL/https could be easily compromised</span></li>
      <li>Expand other applications of visual spoofing, aside from the example of IDN. 
      Internationalized Domain Names are actually in much better shape than many other areas, since 
      the problem will be much more severe in any area where text is not normalized. So focus on 
      those issues.</li>
      <li>Possibly add a set of &#39;grey-list&#39; characters; ones that should cause a one-time alert on 
      the first instance of any domain name that contains them.</li>
    </ol>
    <p><b>Non-Visual Spoofs</b></p>
    <ol>
      <li>Describe problems when implementations do not normalize, or normalize differently</li>
      <li>Describe problems when implementations do not case-map identically.</li>
      <li>Describe buffer overflows with all of the above, and when converting encoding forms</li>
      <li>Discuss Unicode properties. Eg more characters have numeric properties than developers 
      might expect.</li>
      <li>Discuss use of Regular Expressions in validating data — ensuring that the Regular 
      Expression Engine follows the Unicode Guidelines, but also that use of regular expressions 
      makes use of properties rather than fixed lists of characters.</li>
      <li><span>Explain that private use characters can cause security problems, and recommend 
      strongly against their use.</span></li>
      <li><span>Discuss security issues in Collation (sorting, searching, matching).</span></li>
      <li>Describe how problems can arise through mistaken assumptions about Unicode.</li>
    </ol>
    <h2>Appendix F. <a name="Country_Specific_IDN_Restrictions">Country-Specific IDN Restrictions</a></h2>
    <p>ICANN (Internet Corporation For Assigned Names and Numbers), among other tasks, is 
    responsible for coordinating the management of the technical elements of the DNS to ensure 
    universal resolvability. As such, after the IDNA RFCs were published in March 2003, ICANN and a 
    cross-section of IDN-implementing registries published in June 2003 the first version of the 
    &quot;Guidelines for the Implementation of Internationalized Domain Names&quot; [<a href="tr36-3.html#ICANN">ICANN</a>]. 
    These guidelines include the following items:</p>
    <ul>
      <li>strict compliance with the IDN RFCs</li>
      <li>inclusion-based approach (characters not explicitly allowed are prohibited)</li>
      <li>based on the need of a language or a group of languages</li>
      <li>symbol characters, icons, dingbats, punctuations should not be included</li>
      <li>consistent approach for language-specific registration policies</li>
      <li>each domain label should be restricted to a single language or appropriate<br>
      group of languages</li>
    </ul>
    <p>These guidelines have been endorsed by the .cn, .info, .jp, .org, and .tw registries. 
    Furthermore, IANA (Internet Assigned Numbers Authority), following the ICANN guidelines about 
    IDN, has created a registry for IDN Language Tables [<a href="tr36-3.html#IDNReg">IDNReg</a>] which 
    contains entries for:</p>
    <ul>
      <li>.biz (German)</li>
      <li>.info (German)</li>
      <li>.jp (Japanese)</li>
      <li>.kr (Korean)</li>
      <li>.museum (Danish, Icelandic, Norwegian, Swedish, for more see [<a href="tr36-3.html#Museum">Museum</a>])</li>
      <li>.pl (Arabic, Hebrew, Greek, Polish)</li>
      <li>.th (Thai)</li>
    </ul>
    <p>Other registries have published their own IDN recommendations using various formats, such as 
    the following:</p>
    <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="2" border="1">
      <caption>Sample Country Registries</caption>
      <tr>
        <td vAlign="top">Brazil</td>
        <td vAlign="top">.br</td>
        <td vAlign="top">àáâã ç éê í óôõ úü</td>
        <td vAlign="top"><a href="http://registro.br/faq/faq6.html#8">
        http://registro.br/faq/faq6.html#8</a></td>
      </tr>
      <tr>
        <td vAlign="top">Denmark </td>
        <td vAlign="top">.dk</td>
        <td vAlign="top">åä æ é öø ü </td>
        <td vAlign="top"><a href="http://www.difo.dk/regler/Tegn-01-01-2004.pdf">
        http://www.difo.dk/regler/Tegn-01-01-2004.pdf</a></td>
      </tr>
      <tr>
        <td vAlign="top">Chinese </td>
        <td vAlign="top">.cn</td>
        <td vAlign="top">(large list)</td>
        <td vAlign="top">
        <a href="http://www.ietf.org/internet-drafts/draft-xdlee-idn-cdnadmin-03.txt">
        http://www.ietf.org/internet-drafts/draft-xdlee-idn-cdnadmin-03.txt</a><br>
        (draft RFC expiring in August 22nd 2005, the link may become invalid after that date)</td>
      </tr>
      <tr>
        <td vAlign="top">Germany</td>
        <td vAlign="top">.de</td>
        <td vAlign="top">àáâãäåāăą æ çćĉċč ďđ ð èéêëēĕėęě ĝğġģ ĥħ ìíîïĩīĭįı ĵ ķĸ ĺļľł ńņňŋñ 
        òóôõöøōŏő œ ŕŗř śŝşš ţťŧ ŵ ùúûüũūŭůűų ýÿŷ źżž þ </td>
        <td vAlign="top"><a href="http://www.denic.de/en/domains/idns/liste.html">
        http://www.denic.de/en/domains/idns/liste.html</a></td>
      </tr>
      <tr>
        <td vAlign="top">Hungary </td>
        <td vAlign="top">.hu</td>
        <td vAlign="top">á é í óöő úüű</td>
        <td vAlign="top"><a href="http://www.domain.hu/domain/ekes/">
        http://www.domain.hu/domain/ekes/</a></td>
      </tr>
      <tr>
        <td vAlign="top">Iceland </td>
        <td vAlign="top">.is</td>
        <td vAlign="top">á æ ð é í óö ú ý þ</td>
        <td vAlign="top"><a href="https://www.isnic.is/">https://www.isnic.is/</a></td>
      </tr>
      <tr>
        <td vAlign="top">Latvia </td>
        <td vAlign="top">.lv </td>
        <td vAlign="top">ā č ē ģ ī ķ ļ ņ ō ŗ š ū ž</td>
        <td vAlign="top"><a href="http://www.nic.lv/DNS/">http://www.nic.lv/DNS/</a></td>
      </tr>
      <tr>
        <td vAlign="top">Lithuania </td>
        <td vAlign="top">.lt</td>
        <td vAlign="top">ą č ęė į š ųū ž</td>
        <td vAlign="top"><a href="http://www.domreg.lt/lt/nutar/leistini_simboliai.pdf">
        http://www.domreg.lt/lt/nutar/leistini_simboliai.pdf</a></td>
      </tr>
      <tr>
        <td vAlign="top">Norway </td>
        <td vAlign="top">.no</td>
        <td vAlign="top">áàäå æ čç đ éèê ŋńñ óòôöø š ŧ ü ž</td>
        <td vAlign="top"><a href="http://www.norid.no/domeneregistrering/idn/idn_nyetegn.en.html">
        http://www.norid.no/domeneregistrering/idn/idn_nyetegn.en.html</a></td>
      </tr>
      <tr>
        <td vAlign="top">Portugal </td>
        <td vAlign="top">.pt</td>
        <td vAlign="top">àáâã ç éê í óôõ ú</td>
        <td vAlign="top">
        <a href="https://online.dns.pt/imagens/site/home_227/fotos/64493641012224581016.pdf">
        https://online.dns.pt/imagens/site/home_227/fotos/64493641012224581016.pdf</a></td>
      </tr>
      <tr>
        <td vAlign="top">Sweden </td>
        <td vAlign="top">.se</td>
        <td vAlign="top">åä ö</td>
        <td vAlign="top"><a href="http://www.nic-se.se/teknik/programvara_idn.shtml">
        http://www.nic-se.se/teknik/programvara_idn.shtml</a></td>
      </tr>
      <tr>
        <td vAlign="top">Switzerland </td>
        <td vAlign="top">.ch</td>
        <td vAlign="top">àáâãäå æ ç èéêë ìíîï ð ñ òóôõöø ùúûü ýÿ þ</td>
        <td vAlign="top"><a href="http://www.switch.ch/id/faq/idn.html">
        http://www.switch.ch/id/faq/idn.html</a> (English, French, German, Italian)</td>
      </tr>
    </table>
    <blockquote>
      <p><b>Note: </b>When documents are published in their native language, the IDN additions to 
      the basic ASCII DNS repertoire have been mentioned in parenthesis. </p>
      <p><b>Note: </b>Some of the country-based registries do not strictly follow the language-based 
      approach recommended by ICANN because they cover a group of languages, such as in Switzerland 
      or in Germany. Furthermore, two countries using the same language may differ in their list of 
      additional characters (for example, Brazil and Portugal).</p>
    </blockquote>
    <p>There are probably more country-specific IDN recommendations, so this enumeration is by no 
    mean exhaustive. As of now, the output list from <i><span>Appendix A.
    <a href="tr36-3.html#Identifier_Characters">Identifier Characters</a></span></i> is a strict superset of 
    all country-specific restricted IDN lists itemized above.</p>
    <p></p>
    <h2><a name="Acknowledgements">Acknowledgements</a></h2>
    <p>Steven Loomis and other people on the ICU team were very helpful in developing the original 
    proposal for this technical report. Thanks also to the following people for their feedback or 
    contributions to this document <span>or earlier versions of it</span>: Douglas Davidson, Martin 
    Dürst, Asmus Freytag, Deborah Goldsmith, Paul Hoffman, <span>Peter Karlsson</span><span><span>, 
    Gervase Markham, </span>Eric Muller, Erik van der Poel, Michael van Riper, Marcos Sanz, 
    Alexander Savenkov, Dominikus Scherkl, and Kenneth Whistler.</span></p>
    <h2><a name="References">References</a></h2>
    <table cellspacing="0" cellpadding="4" border="0" class="noborder" style="border-collapse: collapse">
      <tr>
        <td class="noborder" valign="top" colspan="3">
        <h3>Data Files</h3>
        <p>The following files provide data used to implement the recommendations in this document. 
        T<span>he data may be refined in future versions of this document. See <i>Section </i>
        </span><i>2.9.1 <a href="tr36-3.html#Backwards_Compabilility">Backwards Compatibility</a></i><span> for 
        a discussion of how to deal with this.</span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="idnchars">idnchars</a>]</span></td>
        <td class="noborder" valign="top"><a href="data/idnchars.txt">idnchars.txt</a></td>
        <td class="noborder" valign="top"><span><b>IDN Characters: </b>Provides a profile of 
        identifiers from </span><i>UAX #31, Identifier and Pattern Syntax</i><span> [<a href="tr36-3.html#UAX31">UAX31</a>] 
        as a recommended restriction of IDN identifiers for security purposes.</span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="idnhtml">idnhtml</a>]</td>
        <td class="noborder" valign="top"><a href="idn-chars.html">idn-chars.html</a></td>
        <td class="noborder" valign="top">IDN Characters, categorized into different sets.</td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1">[<a name="idmod">idmod</a>]</td>
        <td class="noborder" valign="top"><a href="data/xidmodifications.txt">xidmodifications.txt</a></td>
        <td class="noborder" valign="top"><b>Identifier Modifications: </b>Provides the list of 
        additions and restrictions recommended for building a profile of identifiers for 
        environments where security is at issue.</td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1"><span>[<a name="confusables">confusables</a>]</span></td>
        <td class="noborder" valign="top"><span><a href="data/confusables.txt">confusables.txt</a></span></td>
        <td class="noborder" valign="top"><b>Visually Confusable Characters:</b> Provides a mapping 
        for visual confusables for use in further restricting identifiers for security. <span>The 
        usage of the file is described in <i>Appendix B. </i></span><i>
        <a href="tr36-3.html#Confusable_Detection">Confusable Detection</a>.</i></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1">[<a name="confusablesWS">confusablesWS</a>]</td>
        <td class="noborder" valign="top"><a href="data/confusablesWholeScript.txt">
        confusablesWholeScript.txt</a></td>
        <td class="noborder" valign="top"><b>Whole Script Confusables. </b>Data for testing for the 
        possible existence of whole-script and mixed-script confusables. See <i><span>Appendix B.
        </span><a href="tr36-3.html#Confusable_Detection">Confusable Detection</a></i></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" colspan="3">
        <h3>General References</h3>
        </td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="CharMod">CharMod</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>Character Model for the World Wide Web 
        1.0: Fundamentals<br>
        <a href="http://www.w3.org/TR/charmod/">http://www.w3.org/TR/charmod/</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="Charts">Charts</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span><span>Unicode Charts (with Last Resort 
        Glyphs)<br>
        </span><a href="http://www.unicode.org/charts/lastresort.html">
        http://www.unicode.org/charts/lastresort.html</a> </span>
        <p><span>See also:<br>
        <a href="http://developer.apple.com/fonts/LastResortFont/">
        http://developer.apple.com/fonts/LastResortFont/</a> <br>
        <a href="http://developer.apple.com/fonts/LastResortFont/LastResortTable.html">
        http://developer.apple.com/fonts/LastResortFont/LastResortTable.html</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="DCore">DCore</a>]</td>
        <td class="noborder" valign="top" colspan="2">Derived Core Properties<br>
        <a href="http://www.unicode.org/Public/UNIDATA/DerivedCoreProperties.txt">
        http://www.unicode.org/Public/UNIDATA/DerivedCoreProperties.txt</a></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="Display">Display</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>Display Problems?<br>
        <a href="http://www.unicode.org/help/display_problems.html">
        http://www.unicode.org/help/display_problems.html</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="DNS-Case">DNS-Case</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>Donald E. Eastlake 3rd. &quot;Domain Name 
        System (DNS) Case Insensitivity Clarification&quot;. Internet Draft, January 2005<br>
        <a href="http://www.ietf.org/internet-drafts/draft-ietf-dnsext-insensitive-05.txt">
        http://www.ietf.org/internet-drafts/draft-ietf-dnsext-insensitive-05.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="FAQSec">FAQSec</a>]</td>
        <td class="noborder" valign="top" colspan="2">Unicode FAQ on Security Issues<br>
        <a href="http://www.unicode.org/faq/security.html">http://www.unicode.org/faq/security.html</a>
        </td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span><span>[<a name="ICANN">ICANN</a>]</span></span></td>
        <td class="noborder" valign="top" colspan="2"><span>Guidelines for the Implementation of 
        Internationalized Domain Names <br>
        <span><a href="http://www.icann.org/general/idn-guidelines-20jun03.htm">
        http://www.icann.org/general/idn-guidelines-20jun03.htm</a></span></span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="ICU">ICU</a>]</td>
        <td class="noborder" valign="top" colspan="2">International Components for Unicode<br>
        <a href="http://www.ibm.com/software/globalization/icu/">
        http://www.ibm.com/software/globalization/icu/</a> </td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="IDNReg">IDNReg</a>]</td>
        <td class="noborder" valign="top" colspan="2">Registry for IDN Language Tables<br>
        <a href="http://www.iana.org/assignments/idn/">http://www.iana.org/assignments/idn/</a><br>
        Tables are found at:<br>
        <a href="http://www.iana.org/assignments/idn/registered.htm">
        http://www.iana.org/assignments/idn/registered.htm</a></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span><span>[<a name="IDN-Demo">IDN-Demo</a>]</span></span></td>
        <td class="noborder" valign="top" colspan="2"><span><span>ICU (International Components for 
        Unicode) IDN Demo<br>
        <a href="http://ibm.com/software/globalization/icu/demo/domain/">
        http://ibm.com/software/globalization/icu/demo/domain/</a></span></span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="Feedback">Feedback</a>]</td>
        <td class="noborder" valign="top" colspan="2">Reporting Errors and Requesting Information 
        Online<i><br>
        </i><a href="http://www.unicode.org/reporting.html">http://www.unicode.org/reporting.html</a></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="Museum">Museum</a>]</td>
        <td class="noborder" valign="top" colspan="2">Internationalized Domain Names (IDN) in 
        .museum - Supported Languages<br>
        <a href="http://about.museum/idn/language.html">http://about.museum/idn/language.html</a>
        </td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="Reports">Reports</a>]</td>
        <td class="noborder" valign="top" colspan="2">Unicode Technical Reports<br>
        <a href="../index.html">http://www.unicode.org/reports/<br>
        </a><i>For information on the status and development process for technical reports, and for 
        a list of technical reports.</i></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC1034">RFC1034</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>P. Mockapetris. &quot;DOMAIN NAMES - CONCEPTS 
        AND FACILITIES&quot;, RFC 1034, November 1987.<br>
        <a href="http://ietf.org/rfc/rfc1034.txt">http://ietf.org/rfc/rfc1034.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC1035">RFC1035</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>P. Mockapetris. &quot;DOMAIN NAMES - 
        IMPLEMENTATION AND SPECIFICATION&quot;, RFC 1034, November 1987.<br>
        <a href="http://ietf.org/rfc/rfc1035.txt">http://ietf.org/rfc/rfc1035.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC1535">RFC1535</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>E. Gavron. &quot;A Security Problem and 
        Proposed Correction With Widely Deployed DNS Software&quot;, RFC 1535, October 1993<br>
        <a href="http://ietf.org/rfc/rfc1535.txt">http://ietf.org/rfc/rfc1535.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC3454">RFC3454</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>P. Hoffman, M. Blanchet. &quot;Preparation of 
        Internationalized Strings (&quot;stringprep&quot;)&quot;, RFC 3454, December 2002.<br>
        <a href="http://ietf.org/rfc/rfc3454.txt">http://ietf.org/rfc/rfc3454.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC3490">RFC3490</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>Faltstrom, P., Hoffman, P. and A. 
        Costello, &quot;Internationalizing Domain Names in Applications (IDNA)&quot;, RFC 3490, March 2003.<br>
        <a href="http://ietf.org/rfc/rfc3490.txt">http://ietf.org/rfc/rfc3490.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC3491">RFC3491</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>Hoffman, P. and M. Blanchet, &quot;Nameprep: 
        A Stringprep Profile for Internationalized Domain Names (IDN)&quot;, RFC 3491, March 2003.<br>
        <a href="http://ietf.org/rfc/rfc3491.txt">http://ietf.org/rfc/rfc3491.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC3492">RFC3492</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>Costello, A., &quot;Punycode: A Bootstring 
        encoding of Unicode for Internationalized Domain Names in Applications (IDNA)&quot;, RFC 3492, 
        March 2003.<br>
        <a href="http://ietf.org/rfc/rfc3492.txt">http://ietf.org/rfc/rfc3492.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC3743">RFC3743</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>Konishi, K., Huang, K., Qian, H. and Y. 
        Ko, &quot;Joint Engineering Team (JET) Guidelines for Internationalized Domain Names (IDN) 
        Registration and Administration for Chinese, Japanese, and Korean&quot;, RFC 3743, April 2004.<br>
        <a href="http://ietf.org/rfc/rfc3743.txt">http://ietf.org/rfc/rfc3743.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC3986">RFC3986</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>T. Berners-Lee, R. Fielding, L. Masinter. 
        &quot;Uniform Resource Identifier (URI): Generic Syntax&quot;, RFC 3986, January 2005.<br>
        <a href="http://ietf.org/rfc/rfc3986.txt">http://ietf.org/rfc/rfc3986.txt</a></span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap><span>[<a name="RFC3987">RFC3987</a>]</span></td>
        <td class="noborder" valign="top" colspan="2"><span>M. Duerst, M. Suignard. 
        &quot;Internationalized Resource Identifiers (IRIs)&quot;, RFC 3987, January 2005.<br>
        <a href="http://ietf.org/rfc/rfc3987.txt">http://ietf.org/rfc/rfc3987.txt</a> </span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="UCD">UCD</a>]</td>
        <td class="noborder" valign="top" colspan="2">Unicode Character Database.<br>
        <a href="http://www.unicode.org/ucd/">http://www.unicode.org/ucd/</a><br>
        <i>For an overview of the Unicode Character Database and a list of its associated files.</i></td>
      </tr>
      <tr>
        <td class="noborder" vAlign="top" width="1" nowrap>[<a name="UCDFormat">UCDFormat</a>]</td>
        <td class="noborder" vAlign="top" colspan="2">UCD File Format<br>
        <a href="http://www.unicode.org/Public/UNIDATA/UCD.html#UCD_File_Format">
        http://www.unicode.org/Public/UNIDATA/UCD.html#UCD_File_Format</a> </td>
      </tr>
      <tr>
        <td class="noborder" vAlign="top" width="1" nowrap>[<a name="UAX9">UAX9</a>]</td>
        <td class="noborder" vAlign="top" colspan="2">UAX #9: The Bidirectional Algorithm<br>
        <a href="../tr9/index.html">http://www.unicode.org/reports/tr9/</a> </td>
      </tr>
      <tr>
        <td class="noborder" vAlign="top" width="1" nowrap>[<a name="UAX15">UAX15</a>]</td>
        <td class="noborder" vAlign="top" colspan="2">
        <p align="left">UAX #15: Unicode Normalization Forms<br>
        <a href="../tr15.1">http://www.unicode.org/reports/tr15/</a></td>
      </tr>
      <tr>
        <td class="noborder" vAlign="top" nowrap>[<a name="UAX24">UAX24</a>]</td>
        <td class="noborder" vAlign="top" colspan="2">UAX #24: Script Names<br>
        <a href="../tr24/index.html">http://www.unicode.org/reports/tr24/</a> </td>
      </tr>
      <tr>
        <td class="noborder" vAlign="top" nowrap>[<a name="UTS18">UTS18</a>]</td>
        <td class="noborder" vAlign="top" colspan="2">UTS #18: Unicode Regular Expressions<br>
        <a href="../tr18.1">http://www.unicode.org/reports/tr18/</a> </td>
      </tr>
      <tr>
        <td class="noborder" vAlign="top" nowrap>[<a name="UAX31">UAX31</a>]</td>
        <td class="noborder" vAlign="top" colspan="2">UAX #31, Identifier and Pattern Syntax<br>
        <a href="../tr31/index.html">http://www.unicode.org/reports/tr31/</a></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="Unicode">Unicode</a>]</td>
        <td class="noborder" valign="top" colspan="2">The Unicode Standard, Version 4.1.0<br>
        <a href="http://www.unicode.org/versions/Unicode4.1.0/">
        http://www.unicode.org/versions/Unicode4.1.0</a>/</td>
      </tr>
      <tr>
        <td class="noborder" valign="top" width="1" nowrap>[<a name="Versions">Versions</a>]</td>
        <td class="noborder" valign="top" colspan="2">Versions of the Unicode Standard<br>
        <a href="http://www.unicode.org/standard/versions/">
        http://www.unicode.org/standard/versions/</a><br>
        <i>For information on version numbering, and citing and referencing the Unicode Standard, 
        the Unicode Character Database, and Unicode Technical Reports.</i></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" colspan="3">
        <h3><a name="Related_Material">Related Material</a></h3>
        <p><span>The following points to background information that may be useful.</span></td>
      </tr>
      <tr>
        <td class="noborder" valign="top" colspan="3">
        <h3><span>Canonical Representation</span></h3>
        <ul>
          <li><span><a href="http://www.microsoft.com/technet/security/bulletin/MS00-078.mspx">
          Microsoft Security Bulletin (MS00-078): Patch Available for &#39;Web Server Folder Traversal&#39; 
          Vulnerability</a></span></li>
          <li><span>
          <a href="http://www.ins.com/downloads/whitepapers/ins_white_paper_ms_iis_unicode_exploit_0801.pdf">
          INS: Microsoft IIS Unicode Exploit</a></span></li>
          <li>Creating Arbitrary Shellcode In Unicode Expanded Strings<ul>
            <li>See: http://www.phrack.org/show.php?p=61&amp;a=11</li>
          </ul>
          </li>
        </ul>
        <h3><span>Visual Spoofing</span></h3>
        <ul>
          <li><span><a href="http://www.cs.technion.ac.il/~gabr/papers/homograph_full.pdf">The 
          Homograph Attack</a></span></li>
          <li><span><a href="http://news.zdnet.co.uk/internet/security/0,39020375,2080344,00.htm">
          PayPal alert! Beware the &#39;PaypaI&#39; scam</a></span></li>
          <li><span><a href="http://www.icann.org/topics/news022305.html">gTLD Registry Constutuency: 
          Potential of IDN for malicious abuse</a></span></li>
          <li><span><a href="http://www.icann.org/topics/idn.html">ICANN | Internationalized Domain 
          Names</a></span></li>
          <li><span><a href="http://www.ietf.org/IESG/STATEMENTS/IDNstatement.txt" target="_blank">
          IESG statement of 11 February 2003</a></span></li>
          <li><span><a href="http://forum.icann.org/lists/idn-homograph/">ICANN Email Archives [idn-homograph]</a></span></li>
          <li><span>Suggested Practices for Registration of Internationalized Domain Names (IDN)</span><ul>
            <li>At the time of this publication, at: http://www.ietf.org/internet-drafts/draft-klensin-reg-guidelines-08.txt</li>
          </ul>
          </li>
          <li><span><a href="http://secunia.com/multiple_browsers_idn_spoofing_test/">Multiple 
          Browsers IDN Spoofing Test</a></span></li>
        </ul>
        </td>
      </tr>
    </table>
    <h2>&nbsp;</h2>
    <h2><a name="Modifications">Modifications</a></h2>
    <p>The following summarizes modifications from the previous revision of this document.</p>
    <p><span><b>Revision 3:</b></span></p>
    <ul>
      <li><span>Cleaned up references</span></li>
      <li><span>Added <a href="tr36-3.html#Related_Material">Related Material</a> section</span></li>
      <li><span>Add section on <a href="tr36-3.html#Case_Folded_Format">Case-Folded Format</a></span></li>
      <li><span>Refined recommendations on single-script confusables</span></li>
      <li><span>Reorganized introduction, and reversed the order of the main sections.</span></li>
      <li><span>Retitled the main sections</span></li>
      <li><span>Restructured the recommendations for Visual Security</span></li>
      <li><span>Added more examples</span></li>
      <li><span>Incorporated changes </span>for user feedback</li>
      <li><span>Major restructuring, especially appendices. Moved data files and other references 
      into the references, added section on confusables, scripts, future topics, revised the 
      identifiers section to point at the newer data file.</span></li>
      <li><span>Incorporated changes for all the editorial notes: shifted some sections.</span></li>
      <li><span>Added sections on BIDI, appendix F</span></li>
      <li>Revised data files</li>
    </ul>
    <p><b>Revision 2:</b></p>
    <ul>
      <li><span>Moved recommendations to separate section</span></li>
      <li><span>Added new descriptions, recommendations</span></li>
      <li><span>Pointed to draft data files.</span></li>
    </ul>
    <p><b>Revision 1:</b></p>
    <ul>
      <li>Initial version, following proposal to UTC</li>
      <li>Incorporated comments, restructured, added To Do items</li>
    </ul>
    <hr>
    <p class="copyright">Copyright © 2004-2005 Unicode, Inc. All Rights Reserved. The Unicode 
    Consortium makes no expressed or implied warranty of any kind, and assumes no liability for 
    errors or omissions. No liability is assumed for incidental and consequential damages in 
    connection with or arising out of the use of the information or programs contained or 
    accompanying this technical report. The Unicode <a href="http://www.unicode.org/copyright.html">
    Terms of Use</a> apply.</p>
    <p class="copyright">Unicode and the Unicode logo are trademarks of Unicode, Inc., and are 
    registered in some jurisdictions.</div>
</form>

</body>

</html>

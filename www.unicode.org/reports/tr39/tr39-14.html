<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>UTS #39: Unicode Security Mechanisms</title>
<link rel="stylesheet" type="text/css"
	href="../reports-v2.css">
<style type="text/css">
<!--
a:visited.plain, a:link.plain {
	color: black;
	text-decoration: none
}

a:hover.plain {
	color: red;
	text-decoration: underline;
}

.noborder {
	border-width: 0;
	border-collapse: collapse;
}

-->
</style>
</head>

<body>

	<table class="header">
		<tr>
			<td class="icon"><a href="http://www.unicode.org"> <img
					align="middle" alt="[Unicode]" border="0"
					src="../../webscripts/logo60s2.gif" width="34"
					height="33"></a>&nbsp;&nbsp;<a class="bar"
				href="http://www.unicode.org/reports">Technical Reports</a></td>
		</tr>
		<tr>
			<td class="gray">&nbsp;</td>
		</tr>
	</table>
	<div class="body">
		<h2 align="center">
			<span class="changed">Proposed Update </span>
			<span class="uaxtitle">UnicodeÂ® Technical Standard #39</span>
		</h2>
		<h1>Unicode Security Mechanisms</h1>
		<table class="simple" width="90%">
			<tr>
				<td width="20%">Version</td>
				<td class="changed">10.0.0 (draft 1)</td>
			</tr>
			<tr>
				<td>Editors</td>
				<td><a
					href="https://plus.google.com/114199149796022210033?rel=author">Mark
						Davis</a> (<a href="mailto:markdavis@google.com">markdavis@google.com</a>),<br>
					Michel Suignard (<a href="mailto:michel@suignard.com">michel@suignard.com</a>)</td>
			</tr>
			<tr>
				<td>Date</td>
				<td class='changed'>2016-10-21</td>
			</tr>
			<tr>
				<td>This Version</td>
				<td class="changed">
				<a href="tr39-14.html">
				http://www.unicode.org/reports/tr39/tr39-14.html</a></td>
			</tr>
			<tr>
				<td>Previous Version</td>
				<td class="changed">
				<a href="tr39-13.html">
					http://www.unicode.org/reports/tr39/tr39-13.html</a></td>
			</tr>
			<tr>
				<td>Latest Version</td>
				<td><a href="index.html">
						http://www.unicode.org/reports/tr39/</a></td>
			</tr>
			<tr>
				<td>Latest Proposed Update</td>
				<td><a href="proposed.html">
					http://www.unicode.org/reports/tr39/proposed.html</a></td>
			</tr>
			<tr>
				<td>Revision</td>
				<td class="changed"><a href="tr39-14.html#Modifications">14</a></td>
			</tr>
		</table>
		<h3>
			<i>Summary</i>
		</h3>
		<p>
			<i>Because Unicode contains such a large number of characters and
				incorporates the varied writing systems of the world, incorrect
				usage can expose programs or systems to possible security attacks.
				This document specifies mechanisms that can be used to detect
				possible security problems.</i>
		</p>

		<h3>
			<i>Status</i>
		</h3>
		<!-- NOT YET APPROVED -->
		<p class="changed">
			<i>This is a<b><font color="#ff3333"> draft </font></b>document
				which may be updated, replaced, or superseded by other documents at
				any time. Publication does not imply endorsement by the Unicode
				Consortium. This is not a stable document; it is inappropriate to
				cite this document as other than a work in progress.
			</i>
		</p>
		<!-- END NOT YET APPROVED -->
		<!-- APPROVED 
		<p>
			<i>This document has been reviewed by Unicode members and other
				interested parties, and has been approved for publication by the
				Unicode Consortium. This is a stable document and may be used as
				reference material or cited as a normative reference by other
				specifications.</i>
		</p>
		  END APPROVED -->

		<blockquote>
			<p>
				<i><b>A Unicode Technical Standard (UTS)</b> is an independent
					specification. Conformance to the Unicode Standard does not imply
					conformance to any UTS.</i>
			</p>
		</blockquote>
		<p>
			<i>Please submit corrigenda and other comments with the online
				reporting form [<a href="http://www.unicode.org/reporting.html">Feedback</a>].
				Related information that is useful in understanding this document is
				found in the <a href="tr39-14.html#References">References</a>. For the latest
				version of the Unicode Standard, see [<a
				href="http://www.unicode.org/versions/latest/">Unicode</a>]. For a
				list of current Unicode Technical Reports, see [<a
				href="../index.html">Reports</a>]. For more
				information about versions of the Unicode Standard, see [<a
				href="http://www.unicode.org/versions/">Versions</a>].
			</i>
		</p>
		<h3>
			<i>Contents</i>
		</h3>
		<ul class="toc">
			<li>1 <a href="tr39-14.html#Introduction">Introduction</a></li>
			<li>2 <a href="tr39-14.html#Conformance">Conformance</a></li>
			<li>3 <a href="tr39-14.html#Identifier_Characters">Identifier Characters</a>
				<ul class="toc">
					<li>3.1 <a href="tr39-14.html#General_Security_Profile">General
							Security Profile for Identifiers</a>
						<ul class="toc">
							<li>Table 1. <a href="tr39-14.html#Identifier_Status_and_Type">
									Identifier Status and Type</a></li>
						</ul>
					</li>
					<li>3.2 <a href="tr39-14.html#IDN_Security_Profiles">IDN Security
							Profiles for Identifiers</a></li>
					<li>3.3 <a href="tr39-14.html#Email_Security_Profiles">Email
							Security Profiles for Identifiers</a></li>
				</ul>
			</li>
			<li>4 <a href="tr39-14.html#Confusable_Detection">Confusable Detection</a>
				<ul class="toc">
					<li>4.1 <a href="tr39-14.html#Whole_Script_Confusables">Whole-Script
							Confusables</a></li>
					<li>4.2 <a href="tr39-14.html#Mixed_Script_Confusables">Mixed-Script
							Confusables</a></li>
				</ul>
			</li>
			<li>5 <a href="tr39-14.html#Detection_Mechanisms">Detection Mechanisms</a>
				<ul class="toc">
					<li>5.1 <a href="tr39-14.html#Mixed_Script_Detection">Mixed-Script
							Detection</a></li>
					<li>5.2 <a href="tr39-14.html#Restriction_Level_Detection">Restriction-Level
							Detection</a></li>
					<li>5.3 <a href="tr39-14.html#Mixed_Number_Detection">Mixed-Number
							Detection</a></li>
					<li>5.4 <a href="tr39-14.html#Optional_Detection">Optional Detection</a></li>
				</ul>
			</li>
			<li>6 <a href="tr39-14.html#Development_Process">Development Process</a>
				<ul class="toc">
					<li>6.1 <a href="tr39-14.html#Data_Collection">Confusables Data
							Collection</a></li>
					<li>6.2 <a href="tr39-14.html#IDMOD_Data_Collection">Identifier
							Modification Data Collection</a></li>
				</ul>
			</li>
			<li>7 <a href="tr39-14.html#Data_Files">Data Files</a>
				<ul class="toc">
					<li>Table 2. <a href="tr39-14.html#Data_File_List">Data File List</a></li>
				</ul>
			</li>
			<li><a href="tr39-14.html#Migration">Migration</a>
				<ul class="toc">
					<li>Table 3. <a href="tr39-14.html#Version_Correspondance">Version
							Correspondence</a></li>
					<li><a href="tr39-14.html#Migrating_Persistent_Data">Migrating
							Persistent Data</a></li>
					<li><a href="tr39-14.html#Version_8_Migration">Version 8.0 Migration</a></li>
					<li><a href="tr39-14.html#Version_7_Migration">Version 7.0 Migration</a></li>
				</ul></li>
			<li><a href="tr39-14.html#Acknowledgments">Acknowledgments</a></li>
			<li><a href="tr39-14.html#References">References</a></li>
			<li><a href="tr39-14.html#Modifications">Modifications</a></li>
		</ul>

		<br>
		<hr>
		<br>

		<h2>
			1 <a name="Introduction" href="tr39-14.html#Introduction">Introduction</a>
		</h2>
		<p>
			<em>Unicode Technical Report #36, &quot;Unicode Security
				Considerations&quot; [<a href="tr39-14.html#UTR36">UTR36</a>]
			</em> provides guidelines for detecting and avoiding security problems
			connected with the use of Unicode. This document specifies mechanisms
			that are used in that document, and can be used elsewhere. Readers
			should be familiar with [<a href="tr39-14.html#UTR36">UTR36</a>] before
			continuing. See also the Unicode FAQ on <i>Security
					Issues</i> [<a href="tr39-14.html#FAQSec">FAQSec</a>].
		</p>
		<h2>
			2 <a name="Conformance" href="tr39-14.html#Conformance">Conformance</a>
		</h2>
		<p>An implementation claiming conformance to this specification
			must do so in conformance to the following clauses:</p>

		<p><b><a class="plain" name="C1" href="tr39-14.html#C1">C1</a></b>
			<i>An implementation claiming to implement
				the General Profile for Identifiers shall do so in accordance with
				the specifications in Section 3.1, 
				<a href="tr39-14.html#General_Security_Profile">General Security Profile for Identifiers</a>.</i></p>
		<blockquote>
			<p><i>Alternatively, it shall declare that it uses a modification,
				and provide a precise list of characters that are added to or
				removed from the profile.</i></p>
		</blockquote>

		<p><b><a class="plain" name="C1.1" href="tr39-14.html#C1.1">C1.1</a></b>
			<i>An implementation claiming to implement
				the IDN Security Profiles for Identifiers shall do so in accordance with
				the specifications in Section 3.2, 
				<a href="tr39-14.html#IDN_Security_Profiles">IDN Security Profiles for Identifiers</a>.</i></p>
		<blockquote>
			<p><i>Alternatively, it shall declare that it uses a modification,
				and provide a precise list of characters that are added to or
				removed from the profile.</i></p>
		</blockquote>

		<p><b><a class="plain" name="C1.2" href="tr39-14.html#C1.2">C1.2</a></b>
			<i>An implementation claiming to implement
				the Email Security Profiles for Identifiers shall do so in accordance with
				the specifications in Section 3.3, 
				<a href="tr39-14.html#Email_Security_Profiles">Email Security Profiles for Identifiers</a>.</i></p>
		<blockquote>
			<p><i>Alternatively, it shall declare that it uses a modification,
				and provide a precise list of characters that are added to or
				removed from the profile.</i></p>
		</blockquote>

		<p><b><a class="plain" name="C2" href="tr39-14.html#C2">C2</a></b>
			<i>An implementation claiming to implement
				any of the following confusable-detection functions must do so in
				accordance with the specifications in Section 4, 
				<a href="tr39-14.html#Confusable_Detection">Confusable Detection</a>.</i></p>
			<ol>
				<li>X and Y are single-script confusables</li>
				<li>X and Y are mixed-script confusables</li>
				<li>X and Y are whole-script confusables</li>
				<li class="removed">X has any simple single-script confusable</li>
				<li class="removed">X has any mixed-script confusable</li>
				<li class="removed">X has any whole-script confusable</li>
			</ol>
		<blockquote>
			<p><i>Alternatively, it shall declare that it uses a modification,
				and provide a precise list of character mappings that are added to
				or removed from the provided ones.</i></p>
		</blockquote>

		<p><b><a class="plain" name="C3" href="tr39-14.html#C3">C3</a></b>
			<i>An implementation claiming to detect
				mixed scripts must do so in accordance with the specifications in
				Section 5.1, <a href="tr39-14.html#Mixed_Script_Detection">Mixed-Script Detection</a>.</i></p>
		<blockquote>
			<p><i>Alternatively, it shall declare that it uses a modification,
				and provide a precise specification of the differences in
				behavior.</i></p>
		</blockquote>

		<p><b><a class="plain" name="C4" href="tr39-14.html#C4">C4</a></b>
			<i>An implementation claiming to detect
				Restriction Levels must do so in accordance with the specifications in
				Section 5.2, <a href="tr39-14.html#Restriction_Level_Detection">Restriction-Level Detection</a>.</i></p>
		<blockquote>
			<p><i>Alternatively, it shall declare that it uses a modification,
				and provide a precise specification of the differences in
				behavior.</i></p>
		</blockquote>

		<p><b><a class="plain" name="C5" href="tr39-14.html#C5">C5</a></b>
			<i>An implementation claiming to detect
				mixed numbers must do so in accordance with the specifications in
				Section 5.3, <a href="tr39-14.html#Mixed_Number_Detection">Mixed-Number Detection</a>.</i></p>
		<blockquote>
			<p><i>Alternatively, it shall declare that it uses a modification,
				and provide a precise specification of the differences in
				behavior.</i></p>
		</blockquote>

		<h2>
			3 <a name="Identifier_Characters" href="tr39-14.html#Identifier_Characters">Identifier
				Characters</a>
		</h2>
		<p>
			Identifiers are special-purpose strings used for
			identificationâstrings that are deliberately limited to particular
			repertoires for that purpose. Exclusion of characters from
			identifiers does not affect the general use of those characters, such
			as within documents. Unicode Standard Annex #31,
				&quot;Identifier and Pattern Syntax&quot; [<a href="tr39-14.html#UAX31">UAX31</a>]
				provides a recommended method of determining which strings should
				qualify as identifiers. The UAX #31 specification extends the common
				practice of defining identifiers in terms of letters and numbers to
				the Unicode repertoire.
		</p>
		<p>
			That specification also permits other protocols to use that method as
			a base, and to define a <i> profile</i> that adds or removes
			characters. For example, identifiers for specific programming
			languages typically add some characters like &quot;$&quot;, and
			remove others like &quot;-&quot; (because of the use as <i>minus</i>),
			while IDNA removes &quot;_&quot; (among others)âsee Unicode
				Technical Standard #46, &quot;Unicode IDNA Compatibility
					Processing&quot; [<a href="tr39-14.html#UTS46">UTS46</a>], as well as [<a
				href="tr39-14.html#IDNA2003">IDNA2003</a>], and [<a href="tr39-14.html#IDNA2008">IDNA2008</a>].
		</p>
		<p>
			This document provides for additional identifier profiles for
			environments where security is an issue. These are profiles of the
			extended identifiers based on properties and specifications of the
			Unicode Standard [<a href="tr39-14.html#Unicode">Unicode</a>], including:
		</p>
		<ul>
			<li>The XID_Start and XID_Continue properties defined in the
				Unicode Character Database (see [<a href="tr39-14.html#DCore">DCore</a>])
			</li>
			<li>The toCasefold(X) operation defined in <i>Chapter
					3, Conformance</i> of [<a href="tr39-14.html#Unicode">Unicode</a>]
			</li>
			<li>The NFKC and NFKD normalizations defined in <i>Chapter
						3, Conformance</i> of [<a href="tr39-14.html#Unicode">Unicode</a>]</li>
		</ul>
		<p>
			The data files used in defining these profiles follow the UCD File
			Format, which has a semicolon-delimited list of data fields
			associated with given characters, with each field referenced by
			number. For more details, see [<a href="tr39-14.html#UCDFormat">UCDFormat</a>].
		</p>
		<h3>
			3.1 <a name="General_Security_Profile"
				href="tr39-14.html#General_Security_Profile">General Security Profile for
				Identifiers</a>
		</h3>
		<p>
			The files under [<a href="tr39-14.html#idmod">idmod</a>] provides data for a profile of
			identifiers in environments where security is at issue. The file
			contains a set of characters recommended to be restricted from use.
			It also contains a small set of characters that are recommended as
			additions to the list of characters defined by the XID_Start and
			XID_Continue properties, because they may be used in identifiers in a
			broader context than programming identifiers.
		</p>
		<p>The Restricted characters are characters not in common use, and
			<span class="changed">they</span> can be blocked to further reduce the possibilities for visual
			confusion. They include the following:</p>
		<ul>
			<li>characters not in modern use</li>
			<li>characters only used in specialized fields, such as
				liturgical characters, phonetic letters, and mathematical
				letter-like symbols</li>
			<li>characters in limited use by very small communities</li>
		</ul>
		<p>
			The principle has been to be more conservative initially, allowing
			for the set to be modified in the future as requirements for
			characters are refined. For information on handling modifications
			over time, see <i>Section 2.9.1, Backward
				Compatibility</i> in <em>Unicode Technical Report #36,
				&quot;Unicode Security Considerations&quot;</em> [<a href="tr39-14.html#UTR36">UTR36</a>].
		</p>
		<p>
			An implementation following the General Security Profile does not
			permit <em>Restricted</em> characters, unless it documents the
			additional characters that it does allow. Common candidates for such
			additions include characters for scripts listed in <span class="removed"><em><a
				href="../tr31/index.html#Aspirational_Use_Scripts">Table
					6, Aspirational Use Scripts</a></em> and </span><em><a
				href="../tr31/index.html#Table_Limited_Use_Scripts">Table
					7, Limited Use Scripts</a></em> of [<a href="tr39-14.html#UAX31">UAX31</a>]. However,
			characters from these scripts have not been a priority for
			examination for confusables or to determine specialized, non-modern,
			or uncommon-use characters.
		</p>
		<p>
			Canonical equivalence is applied when testing candidate identifiers
			for inclusion of <em>Allowed</em> characters. For example, suppose
			the candidate string is the sequence
		</p>
		<p align="center">
			&lt;u, <em>combining-diaeresis</em>&gt;
		</p>
		<p>
			The target string would be Allowed in <em>either</em> of the
			following 2 situations:
		</p>
		<ol>
			<li>u is Allowed and Â¨ is Allowed, or</li>
			<li>Ã¼ is Allowed</li>
		</ol>
		<p>For details of the format for the [<a href="tr39-14.html#idmod">idmod</a>] files, see <em>Section 7 <a href="tr39-14.html#Data_Files">Data Files</a></em>.</p>

		<p class="caption">Table 1. <a name="Identifier_Status_and_Type"
					href="tr39-14.html#Identifier_Status_and_Type">Identifier Status and Type</a></p>

		<div align="center">
		<table class="simple">
			<tr>
				<th>Status</th>
				<th>Type</th>
				<th>Description</th>
			</tr>
			<tr>
				<td rowspan="11"><a class="plain" name="restricted" href="tr39-14.html#restricted">Restricted</a></td>
				<td nowrap>Not_Character</td>
				<td>Unassigned characters, private use characters,
					surrogates, most control characters</td>
			</tr>
			<tr>
				<td nowrap>Deprecated</td>
				<td>Characters with the Unicode property <em>Deprecated=Yes</em>
				</td>
			</tr>
			<tr>
				<td nowrap>Default_Ignorable</td>
				<td>Characters with the Unicode property <em>Default_Ignorable_Code_Point=Yes</em></td>
			</tr>
			<tr>
				<td nowrap>Not_NFKC</td>
				<td>Characters that cannot occur in strings
					normalized to NFKC.</td>
			</tr>
			<tr>
				<td>Not_XID</td>
				<td>Other characters that do not qualify as
					default Unicode identifiers; that is, they do not have the Unicode
					property <em>XID_Continue=True</em>.
				</td>
			</tr>
			<tr>
				<td>Exclusion</td>
				<td>Characters from scripts that are not in
					customary modern use:<em> <a
						href="../tr31/index.html#Table_Candidate_Characters_for_Exclusion_from_Identifiers">Table
							4, Candidate Characters for Exclusion from Identifiers</a>
				</em>from [<a href="tr39-14.html#UAX31">UAX31</a>]
				</td>
			</tr>
			<tr>
				<td>Obsolete</td>
				<td>Characters that are no longer in modern use.</td>
			</tr>
			<tr>
				<td>Technical</td>
				<td>Specialized usage: technical, liturgical, etc.</td>
			</tr>
			<tr>
				<td>Uncommon_Use</td>
				<td>Characters whose status is uncertain, or that
					are not commonly used in modern text.</td>
			</tr>
			<tr>
				<td>Limited_Use</td>
				<td>Characters from scripts that are in limited
					use: <em><a
						href="../tr31/index.html#Table_Limited_Use_Scripts">Table
							7, Limited Use Scripts</a></em> in [<a href="tr39-14.html#UAX31">UAX31</a>].
				</td>
			</tr>
			<tr>
				<td class='removed'>Aspirational</td>
				<td class='removed'>Characters from scripts would otherwise
					qualify as Limited Use, but have strong current efforts to increase
					their usage: <em><a
						href="../tr31/index.html#Aspirational_Use_Scripts">Table
				6, Aspirational Use Scripts</a></em> in [<a href="tr39-14.html#UAX31">UAX31</a>].</td>
			</tr>
			<tr>
				<td rowspan="2"><a class="plain" name="allowed" href="tr39-14.html#allowed">Allowed</a></td>
				<td><strong>Inclusion</strong></td>
				<td>Exceptional allowed characters, including <a
					href="../tr31/index.html#Table_Candidate_Characters_for_Inclusion_in_Identifiers"><em>Table
				3, Candidate Characters for Inclusion in Identifiers</em></a> in [<a
					href="tr39-14.html#UAX31">UAX31</a>], and some characters for IDNA2008<span class="changed">, except for those characters that are Restricted above</span>.</td>
			</tr>
			<tr>
				<td><strong>Recommended</strong></td>
				<td><em><a
						href="../tr31/index.html#Table_Recommended_Scripts">Table
							5, Recommended Scripts</a></em> in [<a href="tr39-14.html#UAX31">UAX31</a>]<span class="changed">, except for those characters that are Restricted above</span>.</td>
			</tr>
		</table>
		</div>

		<p>For stability considerations, see <a href="tr39-14.html#Migrating_Persistent_Data">Migrating
		Persistent Data</a>.</p>
		<p>The distinctions among the <strong>Type</strong> values is not
			strict; if there are multiple Types for restricting a character only
			one is given. The important characteristic is the <strong>Status</strong>:
			whether or not the character is Restricted. <em>As more
				information is gathered about characters, this data may change in
				successive versions.</em> That can cause either the <strong>Status</strong>
			or <b>Type</b> to change for a particular character. Thus users of
			this data should be prepared for changes in successive versions, such
			as by having a grandfathering policy in place for previously
			supported characters or registrations. Both <strong>Status</strong>
			and <strong>Type</strong> values are to be compared
			case-insensitively and ignoring hyphens and underbars.
		</p>
		<p>
			Restricted characters should be treated with caution in registration,
			and disallowed unless there is good reason to allow them in the
			environment in question. However, the set of <strong>Status</strong>=Allowed
			characters are not typically used as is by implementations. Instead,
			they are applied as filters to the set of characters C that are
			supported by the identifier syntax, generating a new set Câ².
			Typically there are also particular characters or classes of
			characters from C that are retained as <strong>Exception</strong>
			characters.
		</p>
		<p align="center">
			Câ² = (C â© {<strong>Status</strong>=Allowed}) âª <strong>Exceptions</strong>
		</p>
		<p>
			The implementation may simply restrict use of new identifiers to Câ²,
			or may apply some other strategy. For example, there might be an
			appeal process for registrations of ids that contain characters
			outside of Câ² (but still inside of C), or in user interfaces for
			lookup of identifiers, warnings of some kind may be appropriate. For
			more information, see [<a href="tr39-14.html#UTR36">UTR36</a>].
		</p>
		<p>
			The <strong>Exception</strong> characters would be
			implementation-specific. For example, a particular implementation
			might extend the default Unicode identifier syntax by adding <strong>Exception</strong>
			characters with the Unicode property <em>XID_Continue=False</em>,
			such as â$â, â-â, and â.â. Those characters are specific to that
			identifier syntax, and would be retained even though they are not in
			the <strong>Status</strong>=Allowed set. Some
			implementations may also wish to add some [<a href="tr39-14.html#CLDR">CLDR</a>]
			exemplar characters for particular supported languages that have
			unusual characters.
		</p>
		<p>
			The <strong>Type</strong>=Inclusion characters already
			contain some characters that are not letters or numbers, but that are
			used within words in some languages. For example, it is recommended
			that U+00B7 (Â·) MIDDLE DOT be allowed in identifiers, because it is
			required for Catalan.
		</p>
		<p>The implementation may also apply other restrictions discussed
			in this document, such as checking for confusable characters or doing
			mixed-script detection.</p>
		<h3>
			3.2 <a name="IDN_Security_Profiles" href="tr39-14.html#IDN_Security_Profiles">IDN
				Security Profiles for Identifiers</a>
		</h3>
		<p>
			Version 1 of this document defined operations and data that apply to
			[<a href="tr39-14.html#IDNA2003">IDNA2003</a>], which has been superseded by [<a
				href="tr39-14.html#IDNA2008">IDNA2008</a>] and Unicode Technical
				Standard #46, &quot;Unicode IDNA Compatibility
					Processing&quot; [<a href="tr39-14.html#UTS46">UTS46</a>]. The identifier
			modification data can be applied to whichever specification of IDNA
			is being used. For more information, see the [<a href="tr39-14.html#IDN_FAQ">IDN
				FAQ</a>].
		</p>
		<p>
			However, implementations can claim conformance to other features of
			this document as applied to domain names, such as <a
				href="tr39-14.html#Restriction_Level_Detection">Restriction Levels</a>.	  </p>
		<h3>
			3.3 <a name="Email_Security_Profiles" href="tr39-14.html#Email_Security_Profiles">Email Security Profiles for Identifiers</a>
		</h3>
		<p>
			The <em>SMTP Extension for Internationalized Email</em> provides for specifications of internationalized email addresses [<a href="tr39-14.html#EAI">EAI</a>]. However, it does not provide for testing those addresses for security issues. This section provides an email security profiles that  may be used for that. It can be applied for different purposes,  such as:<br>
		</p>
		<ol>
			<li>When an email address is registered, flag anything that
				does not meet the profile:
				<ul>
					<li>Either forbid the registration, or</li>
					<li>Allow for an appeals process.</li>
				</ul>
			</li>
			<li>When an email address is detected in linkification of plain
				text:
				<ul>
					<li>Do not linkify if the identifier does not meet
						the profile.</li>
				</ul>
			</li>
			<li>When an email address is displayed in incoming email:
				<ul>
					<li>Flag it as suspicious with a wavy underline, if it
						does not meet the profile.</li>
					<li>Filter characters from the quoted-string-part to prevent
					display problems.
	      </li>
				</ul>
		  </li>
		</ol>
				  <p>This profile does not exclude characters from
				EAI. Instead, it provides a profile that can be used for registration, linkification,
				and notification. The goal is to  flag 
				&quot;structurally unsound&quot; and &ldquo;unexpectedly
				garbagy&rdquo; addresses.</p>
	    <p>An email address is formed from three main parts. (There are more elements of an email address, but these are the ones for which Unicode security is important.) For example:</p>
		<blockquote>
		  <p>&quot;Joey&quot; &lt;joe31834@gmail.com&gt;</p>
		  <ul>
		    <li>The <strong>domain-part</strong> is &quot;gmail.com&quot;</li>
		    <li>The <strong>local-part</strong> is &quot;joe31834&quot;</li>
		    <li>The <strong>quoted-string-part</strong> is &quot;Joey&quot;</li>
	      </ul>
	  </blockquote>
		<p>To meet the requirements of the <strong>Email Security Profiles for Identifiers</strong> section of this specification, an identifier must satisfy the following
		  conditions for the specified &lt;restriction level&gt;.</p>
        <h4>Domain-Part</h4>
      <p>The domain-part of an email address must satisfy Section 3.2 <a
				href="tr39-1.html#IDN_Security_Profiles">IDN
					Security Profiles for Identifiers</a>, and satisfy the conformance
				clauses of [<a href="tr39-14.html#UTS46">UTS46</a>].</p>
        <h4>Local-Part</h4>
        <p>The local-part of an email address must satisfy all the following conditions:</p>
        <ol>
          <li>It must be in NFKC format</li>
          <li>It must have level = &lt;restriction level&gt; or less,
            from <a
						href="http://unicode.org/reports/tr39/#Restriction_Level_Detection">Restriction_Level_Detection</a>
          </li>
          <li>It must not have mixed number systems according to <a
						href="http://unicode.org/reports/tr39/#Mixed_Number_Detection">Mixed_Number_Detection</a>
          </li>
          <li>It must satisfy <em>dot-atom-text</em> from <a
						href="https://tools.ietf.org/html/rfc5322#section-3.2.3">RFC
          5322 Â§3.2.3</a>, where <em>atext</em> is extended as follows:</li>
      </ol>
      <blockquote>
          <p>Where C â¤ U+007F, C is defined as in <a
								href="https://tools.ietf.org/html/rfc5322#section-3.2.3">Â§3.2.3</a>. (That is, C â [<a
										href="http://unicode.org/cldr/utility/list-unicodeset.jsp?a=%5B%21%23-%27*%2B%5C-%2F-9%3D%3FA-Z%5C%5E-~%5D&amp;abb=on&amp;g=">!#-'*+\-/-9=?A-Z\^-~</a>].
            This list copies what is already in <a
										href="https://tools.ietf.org/html/rfc5322#section-3.2.3">Â§3.2.3</a>,
            and follows <a
										href="http://www.w3.org/TR/html5/forms.html#e-mail-state-(type=email)">HTML5</a>
            for ASCII.)
        </p>
          <p>Where C &gt; U+007F, both of the following conditions
            are true:
          </p>
        <ol>
          <li>C has IdentifierStatus=Allowed from <a
										href="http://unicode.org/reports/tr39/#General_Security_Profile">General_Security_Profile</a>
            
          </li>
          <li>If C is the first character, it must be XID_Start from
            <a
										href="http://unicode.org/reports/tr31/#Default_Identifier_Syntax">Default_Identifier_Syntax</a> in [<a href="tr39-14.html#UAX31">UAX31</a>]
          </li>
        </ol>
      </blockquote>

        <p>Note that in <a
								href="https://tools.ietf.org/html/rfc5322#section-3.2.3">RFC
            5322 Â§3.2.3</a>:
      </p>
        <blockquote><code>dot-atom-text &nbsp;&nbsp;=
            &nbsp;&nbsp;1*atext *(&quot;.&quot; 1*atext)</code>
        </blockquote>
      <p>That is, dots can also occur in the local-part, but
            not leading, trailing, or two in a row. In more conventional regex syntax, this would be:</p>
      <blockquote><code>dot-atom-text &nbsp;&nbsp;=
      &nbsp;&nbsp;atext+ (&quot;.&quot; atext+)* </code></blockquote>
          
        <p>Note that bidirectional controls and other format characters are
                specifically disallowed in the local-part, according to the
                above.</p>
              <h4>Quoted-String-Part</h4>

        <p>The quoted-string-part of an email address  must
          satisfy the following conditions:
          
        </p>
        <ol>
          <li>It must be in NFC.</li>
          <li>It must not contain any stateful bidirectional format characters.
            
            <ul>
              <li>That is, no [:bidicontrol:] except for the LRM, RLM, and ALM, since the bidirectional controls could influence the ordering of characters outside
              the quotes.</li>
            </ul>
          </li>
          <li>It must not contain more than four nonspacing marks in a row, and no
            sequence of two of the same nonspacing marks.</li>
          <li>It may contain mixed scripts, symbols (including emoji),
            and so on.
          </li>
      </ol>
      <h4>Other Issues</h4>

		<p>The restrictions above are insufficient to
			prevent bidirectional-reordering that could intermix the quoted-string-part
			with the local-part or the domain-part in display. To prevent that,
			implementations could use bidirectional isolates (or equivalent) around the
			each of these parts in display.</p>
		<p>Implementations may also want to use other checks, such as for confusability, or services such as Safe Browsing.</p>
		<p>
			A serious practical issue is that clients do not know what the
			identity rules are for any particular email server: that is, when two
			email addresses are considered equivalent. For example, are <em>mark@macchiato.com</em>
			and <em>Mark@macchiato.com</em> treated the same by the server?
			Unfortunately, there is no way to query a server to see
			what identity rules it follows. One of the techniques used to deal with
			this problem is having whitelists of email providers indicating which of them are  case-insensitive, dot-insensitive, or both.
		</p>
		<h2>
			4 <a name="Confusable_Detection" href="tr39-14.html#Confusable_Detection">Confusable
				Detection</a>
		</h2>
		<p>
			The data in [<a href="tr39-14.html#confusables">confusables</a>] provide a
			mechanism for determining when two strings are visually confusable.
			The data in these files may be refined and extended over time. For
			information on handling modifications over time, see <i>Section
					2.9.1, Backward Compatibility</i> in Unicode Technical Report #36,
			&quot;Unicode Security Considerations&quot; [<a href="tr39-14.html#UTR36">UTR36</a>]
			and the <a href="tr39-14.html#Migration">Migration</a> section of this document.
		</p>
		<p>
			Collection of data for detecting gatekeeper-confusable strings is not
			currently a goal for the confusable detection mechanism in this
			document. For more information, see <em>Section 2 Visual
				Security Issues</em> in [<a href="tr39-14.html#UTR36">UTR36</a>].
		</p>
		<p>The data provides a mapping from source characters to <span class="changed">their prototypes. A prototype should be thought of as a sequence of one or more classes of symbols, where each class has an exemplar character. For example, the character U+0153 (Å), LATIN SMALL LIGATURE OE, has a prototype consisting of two symbol classes: the one with exemplar character U+006F (o), and the one with exemplar character U+0065 (e). If an input character does not have a prototype explicitly defined in the data file, the prototype is assumed to consist of the class of symbols with the input character as the exemplar character.</span></p>
		<p><span class="changed">For an input string X, define <a name="def-skeleton" href="tr39-14.html#def-skeleton">skeleton</a>(X) to be the following transformation on the string:</span> </p>
		<p class='removed'>
			To see whether two strings X and Y are confusable (abbreviated as X â
			Y), an implementation uses a transform of X called a <i>skeleton(X)</i>
			defined by:
		</p>
		<ol>
			<li>Convert<span class="removed">ing</span> X to NFD format, as described in [<a
				href="tr39-14.html#UAX15">UAX15</a>].
			</li>
			<li class="changed">Concatenate the prototypes for each character in X according to the specified data, producing a string of exemplar characters.</li>
			<li>Reapply<span class="removed">ing</span> NFD.</li>
		</ol>
		<p class="changed">The strings X and Y are defined to be <a name="def-confusable" href="tr39-14.html#def-confusable">confusable</a> if and only if skeleton(X) = skeleton(Y). This is abbreviated as X â Y.</p>
		<p>This mechanism imposes transitivity on the data, so if X â Y and Y â Z, then X â Z. It is possible to provide a more sophisticated confusable detection, by providing a metric between given characters, indicating their &quot;closeness.&quot; However, that is computationally much more expensive, and requires more sophisticated data, so at this point in time the simpler mechanism has been chosen. That means that in some cases the test may be overly inclusive.</p>
		<blockquote>
			<p>
				<b>Note:</b> The strings <i>skeleton</i>(X) and <i>skeleton</i>(Y)
				are <b><i>not</i></b> intended for display, storage or transmission.
				They should be thought of as an intermediate processing form,
				similar to a hashcode. The <span class="changed">exemplar</span> characters <span class="removed">in <i>skeleton</i>(X) and <i>skeleton</i>(Y)
				</span>are <b><i>not</i></b> guaranteed to be identifier characters.
			</p>
		</blockquote>
	  <p><strong>Definitions</strong></p>
			<p class="changed">Confusables are divided into three classes: single-script confusables, mixed-script confusables, and whole-script confusables, defined below.  All confusables are either a single-script confusable or a mixed-script confusable, but not both.  All whole-script confusables are also mixed-script confusables. </p>
			<p>
				X and Y are <i><a name="single_script_confusables"
					href="tr39-14.html#single_script_confusables">single-script confusables</a></i> if
				<span class="changed">and only if </span>they are confusable, and <span class="changed">and their resolved script sets have at least one element in common</span> according to <i>Section 5, <a href="tr39-14.html#Mixed_Script_Detection">Mixed-Script
						Detection</a></i><span class="removed">, and it is the same script for each</span>.</p>
			<blockquote>
				<p>Examples:				<span class="changed">âÇetoâ and âljetoâ in Latin (the Croatian word for âsummerâ), where the first word uses only four codepoints, the first of which is U+01C9 (Ç) LATIN SMALL LETTER LJ.</span></p>
			</blockquote>
			<p>
				X and Y are <i><a name="mixed_script_confusables"
					href="tr39-14.html#mixed_script_confusables">mixed-script confusables</a></i> if
				<span class="changed">and only if </span>they are confusable  <span class="changed">but their resolved script sets have no elements in common</span>.</p>
			<blockquote>
				<p>Examples: &quot;paypal&quot; and &quot;pÐ°ypÐ°l&quot;, where the
				second word has the character <a target="c"
					href="http://unicode.org/cldr/utility/character.jsp?a=0430">U+0430</a>Â (Â Ð°Â )
				CYRILLIC SMALL LETTER A.
				</p>
			</blockquote>
			<p>
				X and Y are <i><a name="def_whole_script_confusables"
					href="tr39-14.html#def_whole_script_confusables">whole-script confusables</a></i> if
				<span class="changed">and only if </span>they are <i>mixed-script confusables,</i> and each of them is a
				single script string <span class="changed">(has a nonempty resolved script set)</span>.</p>
			<blockquote>
				<p>Example: &quot;scope&quot; in Latin and &quot;ÑÑÐ¾ÑÐµ&quot; in Cyrillic.
				</p>
			</blockquote>
		<p class="changed">As noted in Section 5, the resolved script set ignores characters with Script_Extensions {Common} and {Inherited} and augments characters with CJK scripts with their respective writing systems.Characters with the Script_Extension property values COMMON or
			INHERITED are ignored when testing for differences in script.</p>
		<h3 class="changed">Data File Format</h3>
		<p>Each line in the data file has the following format: Field 1 is
		  the source, Field 2 is the target, and Field 3 is obsolete<span class="changed">, always containing the letters âMAâ for backwards compatibility</span>. For example:</p>
		<blockquote>
		<p>
			0441 ; 0063 ; MA # ( Ñ â c ) CYRILLIC SMALL LETTER ES â LATIN SMALL
			LETTER C #
		</p>
		<p>2CA5 ; 0063 ; MA # ( â²¥ â c ) COPTIC SMALL LETTER SIMA â LATIN
			SMALL LETTER C # âÏ²â</p>
		</blockquote>
		<p>
			Everything after the # is a comment and is purely informative. A
			asterisk after the comment indicates that the character is not an XID
			character [<a href="tr39-14.html#UAX31">UAX31</a>]. The comments provide the
		character names.</p>
		<p>Implementations that use the confusable data do not have to
			recursively apply the mappings, because the transforms are
		idempotent. That is,</p>
        <p align="center"> <i>skeleton(skeleton(X)) = skeleton(X)</i></p>
		<p>If the data was derived via transitivity, there is
			an extra comment at the end. For instance, in the above example the
			derivation was: </p>
		<ol>
		  <li>â²¥ (U+2CA5 COPTIC SMALL LETTER SIMA)</li>
			<li>â Ï² (U+03F2 GREEK LUNATE SIGMA SYMBOL)</li>
			<li>â c (U+0063 LATIN SMALL LETTER C)</li>
		</ol>
		<p>To reduce security risks, it is advised that identifiers use
			casefolded forms, thus eliminating uppercase variants where possible.
		</p>
		<p>
			The data may change between versions. Even where the data is the
			same, the order of lines in the files may change between versions.
			For more information, see <a href="tr39-14.html#Migration">Migration</a>.
		</p>
		<ul>
			<li><strong>Note: </strong>due to production problems, versions
				before 7.0 did not maintain idempotency in all cases. For more
				information, see <a href="tr39-14.html#Migration">Migration</a>.		</li>
		</ul>
		<h3>
			4.1 <a name="Whole_Script_Confusables"
				href="tr39-14.html#Whole_Script_Confusables">Whole-Script Confusables</a>
		</h3>
	  <p class="changed">For some applications, it may be useful to determine if a given input string has any whole-script confusable.  For example, the identifier &quot;ÑÑÐ¾ÑÐµ&quot; using Cyrillic characters would pass the single-script test described in Section 5.2, Restriction-Level Detection, even though it is likely to be a spoof attempt.</p>
	  <p class="changed">It is possible to determine whether a single-script string X has a whole-script confusable:</p>
	  <ol class="changed">
	    <li> Consider Q, the set of all strings that are confusable with X. </li>
	    <li>If any string in Q has a nonempty resolved script set that does not intersect with the resolved script set of X, return TRUE. </li>
	    <li>Otherwise, return FALSE. </li>
      </ol>
	  <p class="changed">The set of all strings that are confusable with X grows exponentially with the length of the string, so in practice, an equivalent but more efficient algorithm should be used.</p>
	  <p class="changed">Note that the confusables data include a large number of mappings between Latin and Cyrillic text.  For this reason, the above algorithm is likely to flag a large number of legitimate strings written in Latin or Cyrillic as potential whole-script confusables.</p>
	  <p class="removed">This section specifies how test whether a string has a whole-script confusables, such as "scope" in Latin and "ÑÑÐ¾ÑÐµ" in Cyrillic. The results depend on the set of characters that are accepted by the implementation.</p>
	  <p class="removed">The following gives the logical process for determing whether a single-script stringÂ <em>source string</em>Â has a whole-script confusable, given the implementation repertoire of characters R.<br>
      </p>
	  <ol>
	    <li class="removed">If the source string is mixed script, then return false. Otherwise transform the source string into nfd, called nfd-source.</li>
	    <li class="removed">Generate the set of all variants of nfd-source, using all of the combinations for each character from the equivalence classes in the confusables.txt file, filtered to keep only characters in R.</li>
	    <li class="removed">Remove all combinations that have mixed scripts, according toÂ <a href="http://unicode.org/reports/tr39/#Mixed_Script_Detection">Mixed_Script_Detection</a>, and remove the nfd-source string.</li>
	    <li class="removed">If that remainder set is not empty, then there is a whole-script confusable for the original.</li>
	    <li class="removed">If one of the remainder set has the same script from nfd-source, then there is a same-script confusable for the original.</li>
      </ol>
	  <p class="removed">Example:</p>
	  <ol>
	    <li class="removed">The nfd-source for the source string is AB.</li>
	    <li class="removed">Assume A has the equivalence class {A, X, ZW}, and B has the equivalence class {B, C}. Then the result of generating all variants of the nfd-source is {AB, AC, XB, XC, ZWB, ZWC}</li>
	    <li class="removed">Assume A is Latin, C and Z are Hiragana, and the others are Common. Then the remainders after removing mixed-script strings are: {XB, XC, ZWB, ZWC}</li>
	    <li class="removed">Because that set is not empty, there is a whole-script confusable for the input string.</li>
	    <li class="removed">For this example, there are none.</li>
      </ol>
	  <p class="removed">The logical description can be used for a reference implementation for testing, but is not particularly efficient. A production implementation can be optimized to incrementally test for mixed scripts as the combinations in step 2 are built up, and remove any initial substring that fails. That avoids adding the set tree of combinations that start with that initial substring without having to compute them in the first place. For example:</p>
	  <ol>
	    <li class="removed">Process nfd-source character by character</li>
	    <li class="removed">Start with a mapping of scripts to samples, where each sample is initially &ldquo;&rdquo;.</li>
	    <li><span class="removed">Get each successive character&rsquo;s confusable equivalence class as a set.
	      </span>
	      <ol type="a">
	        <li class="removed">Filter to remove entries with characters that are not in R. If the remaining set is empty, drop the script mapping</li>
	        <li class="removed">For each script in the mapping, find a string in the remaining set that can be appended and yet remain in that script (avoiding the original character from nfd-source, where possible). If there is no such string, drop the script mapping</li>
          </ol>
        </li>
	    <li class="removed">At the end of this process, drop any &lt;script, nfd-source&gt; entry.</li>
	    <li class="removed">The result is a mapping from the scripts to a sample whole-script confusable for the input in that script.</li>
      </ol>
	  <p class="removed">This process can be further optimized by the following techniques.</p>
	  <p class="removed">The mapping of characters to confusable equivalence classes can be preprocessed to filter out characters not in R, and filtered to remove strings with conflicting scripts. That makes step 3a faster.</p>
	  <p class="removed">A mapping can be produced that replaces each confusable equivalence class set by a map from script to characters. Note that the same string can appear under multiple scripts. That makes step 3b faster.</p>
	  <p class="removed">If the implementation does not require explicit string samples for the scripts, the algorithm can be recast to operate on sets of scripts instead. There is one complication to this: an entry that has only one character needs to be marked specially, so that it can be taken into account for step 4 above (removing generated strings that are identical to nfd-source).</p>

		<h3>
			4.2 <a name="Mixed_Script_Confusables"
				href="tr39-14.html#Mixed_Script_Confusables">Mixed-Script Confusables</a>
		</h3>
		<p class="changed">To determine the existence of a mixed-script confusable, a similar process could be used:</p>
		<ol class="changed">
		  <li>Consider Q, the set of all strings that are confusable with X. </li>
		  <li>Remove all strings from Q whose resolved script set intersects with the resolved script set of X. </li>
		  <li>If Q is nonempty, return TRUE. </li>
		  <li>Otherwise, return FALSE. </li>
	  </ol>
		<p class="changed">Note that due to the number of mappings provided by the confusables data, the above algorithm is likely to flag a large number of legitimate strings as potential mixed-script confusables.</p>
		<p class="removed">To test for mixed-script confusables, use the following process:</p>
		<ol>
		  <li class="removed">Convert the given string to NFD format, as specified in [<a href="http://unicode.org/reports/tr39/#UAX15">UAX15</a>].</li>
		  <li class="removed">For each script found in the given string, see if all the characters in the string outside of that script have whole-script confusables for that script (according toÂ <em>Section 4.1,Â <a href="http://unicode.org/reports/tr39/#Whole_Script_Confusables">Whole-Script Confusables</a>)Â </em>.</li>
	  </ol>
		<p class="removed">Example 1: "pÐ°ypÐ°l", with Cyrillic "Ð°"s.</p>
		<blockquote>
		  <p class="removed">There are two scripts, Latin and Cyrillic. The set of Cyrillic characters {a} has a whole-script confusable in Latin. Thus the string is a mixed-script confusable.</p>
	  </blockquote>
		<p class="removed">Example 2: "toys-Ñ-us", with one Cyrillic character "Ñ".</p>
		<blockquote>
		  <p class="removed">The set of Cyrillic characters {Ñ} does not have a whole-script confusable in Latin (there is no Latin character that looks like "Ñ", nor does the set of Latin characters {o s t u y} have a whole-script confusable in Cyrillic (there is no Cyrillic character that looks like "t" or "u"). Thus this string is not a mixed-script confusable.</p>
	  </blockquote>
		<p class="removed">Example 3: "1iÎ½Ðµ", with a Greek "Î½" and Cyrillic "Ðµ".</p>
		<blockquote>
		  <p class="removed">There are three scripts, Latin, Greek, and Cyrillic. The set of Cyrillic characters {Ðµ} and the set of Greek characters {Î½} each have a whole-script confusable in Latin. Thus the string is a mixed-script confusable.</p>
	  </blockquote>
		<h2>
			5 <a name="Detection_Mechanisms" href="tr39-14.html#Detection_Mechanisms">Detection
				Mechanisms</a>
		</h2>
		<h3>
			5.1 <a name="Mixed_Script_Detection" href="tr39-14.html#Mixed_Script_Detection">Mixed-Script
				Detection</a>
		</h3>
		<p>
			The Unicode Standard supplies information that can be used for
			determining the script of characters and detecting mixed-script text.
		The determination of script is according to the <em>UAX #24, Unicode Script Property </em>[<a
				href="tr39-14.html#UAX24">UAX24</a>], using data from the Unicode Character Database [<a href="tr39-14.html#UCD">UCD</a>]. </p>
	  <div class='changed'>
		<p >Define a character's <a name="def-augmented-script-set" href="tr39-14.html#def-augmented-script-set">augmented script set</a> to be a character's Script_Extensions with the following two modifications.</p>
	  <ol>
	    <li>Entries for the writing systems containing multiple scripts â Hanb (Han with Bopomofo), Jpan (Japanese), and Kore (Korean) â are added according to the following rules.
		   <ol>
		      <li>If Script_Extensions contains Hani (Han), add Hanb, Jpan, and Kore.
	          </li>
		      <li >If Script_Extensions contains Hira (Hiragana), add Jpan.          </li>
		      <li >If Script_Extensions contains Kata (Katakana), add Jpan.          </li>
		      <li >If Script_Extensions contains Hang (Hangul), add Kore.          </li>
		      <li >If Script_Extensions contains Bopo (Bopomofo), add Hanb.          </li>
           </ol>
        </li>
	    <li >Sets containing Zyyy (Common) or Zinh (Inherited) are treated as Î£, the set of all script values.</li>
	  </ol>
	  <p >The Script_Extensions data is from the Unicode Character Database [<a href="tr39-14.html#UCD">UCD</a>]. For more information on the Script_Extensions property and Jpan, Kore, and Hanb, see <em>UAX #24, Unicode Script Property</em> [<a
				href="tr39-14.html#UAX24">UAX24</a>].<br>
	  </p>
	  <p >Define the <a name="def-resolved-script-set" href="tr39-14.html#def-resolved-script-set">resolved script set</a> for a string to be the intersection of the augmented script sets over all characters in the string.<br>
	  </p>
	  <p >A string is defined to be <a name="def-mixed-script" href="tr39-14.html#def-mixed-script">mixed-script</a>  if its resolved script set is empty and defined to be <a name="def-single-script" href="tr39-14.html#def-single-script">single-script</a>  if its resolved script set is nonempty.      
	  <p >As well as providing an API to detect whether a string <em>has</em> mixed-scripts, is also useful to offer an API that returns those scripts.
	  Look at the examples below.<p class="caption">Table 1b. <a name="Mixed_Script_Examples"
					href="tr39-14.html#Mixed_Script_Examples">Mixed Script Examples</a><br>
      </p>
	    <table  class="simple">
	      <tr>
	        <td><strong>String</strong></td>
	        <td><strong>Code Points</strong></td>
	        <td><strong>Script_Extensions</strong></td>
	        <td><strong>Augmented Script Sets</strong></td>
	        <td><strong>Resolved Script Set</strong></td>
	        <td><strong>Is single-<br>script string?</strong></td>
          </tr>
	      <tr>
	        <td>Circle</td>
	        <td>U+0043<br>U+0069<br>U+0072<br>U+0063<br>U+006C<br>U+0065</td>
	        <td>{Latn}<br>{Latn}<br>{Latn}<br>{Latn}<br>{Latn}<br>{Latn}</td>
	        <td>{Latn}<br>{Latn}<br>{Latn}<br>{Latn}<br>{Latn}<br>{Latn}</td>
	        <td>{Latn}</td>
	        <td>Yes</td>
          </tr>
	      <tr>
	        <td>Ð¡ÑÐ³ÑÓÐµ</td>
	        <td>U+0421<br>U+0456<br>U+0433<br>U+0441<br>U+04C0<br>U+0435</td>
	        <td>{Cyrl}<br>{Cyrl}<br>{Cyrl}<br>{Cyrl}<br>{Cyrl}<br>{Cyrl}</td>
	        <td>{Cyrl}<br>{Cyrl}<br>{Cyrl}<br>{Cyrl}<br>{Cyrl}<br>{Cyrl}</td>
	        <td>{Cyrl}</td>
	        <td>Yes</td>
          </tr>
	      <tr>
	        <td>Ð¡irÑlÐµ</td>
	        <td>U+0421<br>U+0069<br>U+0072<br>U+0441<br>U+006C<br>U+0435</td>
	        <td>{Cyrl}<br>{Latn}<br>{Latn}<br>{Cyrl}<br>{Latn}<br>{Cyrl}</td>
	        <td>{Cyrl}<br>{Latn}<br>{Latn}<br>{Cyrl}<br>{Latn}<br>{Cyrl}</td>
	        <td>{}</td>
	        <td>No</td>
          </tr>
	      <tr>
	        <td>Circ1e</td>
	        <td>U+0043<br>U+0069<br>U+0072<br>U+0063<br>U+0031<br>U+0065</td>
	        <td>{Latn}<br>{Latn}<br>{Latn}<br>{Latn}<br>{Zyyy}<br>{Latn}</td>
	        <td>{Latn}<br>{Latn}<br>{Latn}<br>{Latn}<br>Î£<br>{Latn}</td>
	        <td>{Latn}</td>
	        <td>Yes</td>
          </tr>
	      <tr>
	        <td>Cððð¼ðð¾</td>
	        <td>U+0043<br>U+1D5C2<br>U+1D5CB<br>U+1D5BC<br>U+1D5C5<br>U+1D5BE</td>
	        <td>{Latn}<br>{Zyyy}<br>{Zyyy}<br>{Zyyy}<br>{Zyyy}<br>{Zyyy}</td>
	        <td>{Latn}<br>Î£<br>Î£<br>Î£<br>Î£<br>Î£</td>
	        <td>{Latn}</td>
	        <td>Yes</td>
          </tr>
	      <tr>
	        <td>ð¢ððð¼ðð¾</td>
	        <td>U+1D5A2<br>U+1D5C2<br>U+1D5CB<br>U+1D5BC<br>U+1D5C5<br>U+1D5BE</td>
	        <td>{Zyyy}<br>{Zyyy}<br>{Zyyy}<br>{Zyyy}<br>{Zyyy}<br>{Zyyy}</td>
	        <td>Î£<br>Î£<br>Î£<br>Î£<br>Î£<br>Î£</td>
	        <td>Î£</td>
	        <td>Yes</td>
          </tr>
	      <tr>
	        <td>ãå</td>
	        <td>U+3006<br>U+5207</td>
	        <td>{Hani, Hira, Kata}<br>{Hani}</td>
	        <td>{Hani, Hira, Kata, Hanb, Jpan, Kore}<br>{Hani, Hanb, Jpan, Kore}</td>
	        <td>{Hani, Hanb, Jpan, Kore}</td>
	        <td>Yes</td>
          </tr>
	      <tr>
	        <td>ã­ã¬</td>
	        <td>U+306D<br>U+30AC</td>
	        <td>{Hira}<br>{Kata}</td>
	        <td>{Hira, Jpan}<br>{Kata, Jpan}</td>
	        <td>{Jpan}</td>
	        <td>Yes</td>
          </tr>
        </table>
	    <p >A set of scripts is defined to <a name="def-cover" href="tr39-14.html#def-cover">cover</a> a string if the intersection of that set with the augmented script sets of all characters in the string is nonempty; in other words, if every character in the string shares at least one script with the cover set. For example, {Latn, Cyrl} covers &quot;Ð¡irÑlÐµ&quot;, the third example in <a
					href="tr39-14.html#Mixed_Script_Examples">Table 1b</a>.	  </p>
	  <p >A cover set is defined to be <a name="def-minimal" href="tr39-14.html#def-minimal">minimal</a> if there is no smaller cover set. For example, {Hira, Hani} covers &quot;ãå&quot;, the seventh example in  <a 
	  				href="tr39-14.html#Mixed_Script_Examples">Table 1b</a>, but it is not minimal, since {Hira} also covers the string, and {Hira} is smaller than {Hira, Hani}. Note that minimal cover sets are not unique: a string may have  different minimal cover sets.	  </p>
	  <p >Typically an API that returns the scripts in a string will return one of the minimal cover sets.</p>
	  <p >For computational efficiency, a set of script sets (SOSS) can be computed, where the augmented script sets for each character in the string map to one entry in the SOSS. For example, { {Latn}, {Cyrl} } would be the SOSS for &quot;Ð¡irÑlÐµ&quot;. A set of scripts that covers the SOSS also covers the input string. Likewise, the intersection of all entries of the SOSS will be the input string's resolved script set.	  </p></div>
      <p class="removed">The Unicode Standard supplies information that can be used for determining the script of characters and detecting mixed-script text. The determination of script is according to the Unicode Standard Annex #24, "Unicode Script Property"Â <em>[<a href="http://unicode.org//reports/tr39/#UAX24">UAX24</a>]Â </em>, using data from the Unicode Character Database [<a href="http://unicode.org//reports/tr39/#UCD">UCD</a>]. For a given input string, the logical process is the following:</p>
      <blockquote>
        <p class="removed">Define a set of sets of scripts SOSS.</p>
        <p class="removed">For each character in the string:</p>
        <ol>
          <li class="removed">Use the Script_Extensions property to find the set of scripts that the character has.</li>
          <li class="removed">Remove Common and Inherited from that set of scripts.</li>
          <li class="removed">If the result is not empty, add that set to SOSS.</li>
        </ol>
        <p class="removed">If no single script is common to all of the sets in SOSS, then the string contains mixed scripts.</p>
      </blockquote>
      <p class="removed">Characters with the script valuesÂ <em>Common</em>Â andÂ <em>Inherited</em>Â are ignored, because they are used with more than one script. For example, "abc-def" counts as a single script Latin because the script of "-" is ignored.</p>
      <p class="removed">A set of scripts S is said toÂ <em>cover</em>Â a SOSS<em>Â ifÂ </em>S intersects each element of SOSS. For example, {Latin, Greek} covers {{Latin, Georgian}, {Greek, Cyrillic}}, because:</p>
      <ol>
        <li class="removed">{<strong>Latin</strong>, Greek} intersects {<strong>Latin</strong>, Georgian} (the intersection being {<strong>Latin</strong>}).</li>
        <li class="removed">{Latin,Â <strong>Greek</strong>} intersects {<strong>Greek</strong>, Cyrillic} (the intersection being {<strong>Greek</strong>}).</li>
      </ol>
      <p class="removed">The actual implementation of this algorithm can be optimized; as usual, the specification only depends on the results. The following Java sample using [<a href="http://unicode.org//reports/tr39/#ICU">ICU</a>] shows how the above process can be implemented:</p>
      <pre class="removed">    public static boolean isSingleScript(String identifier) {<br>        // Non-optimized code, for simplicity<br>        Set&lt;BitSet&gt; setOfScriptSets = new HashSet&lt;BitSet&gt;();<br>        BitSet temp = new BitSet();<br>        int cp;<br>        for (int i = 0; i &lt; identifier.length(); i += Character.charCount(i)) {<br>            cp = Character.codePointAt(identifier, i);<br>            UScript.getScriptExtensions(cp, temp);<br>            if (temp.cardinality() == 0) {<br>                // HACK for older version of ICU<br>                final int script = UScript.getScript(cp);<br>                temp.set(script);<br>            }<br>            temp.andNot(COMMON_AND_INHERITED);<br>            if (temp.cardinality() != 0 &amp;&amp; setOfScriptSets.add(temp)) {<br>                // If the set hasn&rsquo;t been added already,<br>                // add it and create new temporary for the next pass,<br>                // so we don&rsquo;t rewrite what&rsquo;s already in the set.<br>                temp = new BitSet();<br>            }<br>        }<br>        if (setOfScriptSets.size() == 0) {<br>            return true; // trivially true<br>        }<br>        temp.clear();<br>        // check to see that there is at least one script common to all the sets<br>        boolean first = true;<br>        for (BitSet other : setOfScriptSets) {<br>            if (first) {<br>                temp.or(other);<br>                first = false;<br>            } else {<br>                temp.and(other);<br>            }<br>        }<br>        return temp.cardinality() != 0;<br>    }</pre>
      <p class="removed">This formulation ignores Common and Inherited scripts, and returns an error when a string contains mixed scripts.</p>
	  <h3>
		  5.2 <a name="Restriction_Level_Detection"
				href="tr39-14.html#Restriction_Level_Detection">Restriction-Level Detection</a>
		</h3>
		<p>
			Restriction Levels 1-5 are defined here for use in implementations.
			These place restrictions on the use of identifiers according to the
			appropriate Identifier Profile as specified in <i>Section 3, <a
				href="index.html#Identifier_Characters">Identifier
					Characters</a></i>. The lists of Recommended<span class="removed"> and Aspirational</span> scripts are
			taken from <em><a
				href="../tr31/index.html#Table_Recommended_Scripts">Table
					5, Recommended Scripts</a></em> <span class="removed">and <em><a
				href="../tr31/index.html#Aspirational_Use_Scripts">Table
					6, Aspirational Use Scripts</a></em></span> of [<a href="tr39-14.html#UAX31">UAX31</a>]. For
			more information on the use of Restriction Levels, see <em>Section
				2.9 Restriction Levels and Alerts</em> in [<a href="tr39-14.html#UTR36">UTR36</a>].</p>
		<p class="changed">For each of the  Restriction Levels 1-6, the identifier must be well-formed according to whatever general syntactic constraints are in force, such as the Default Identifier Syntax in [<a href="tr39-14.html#UAX31">UAX31</a>].</p>
		<p class="changed">In addition, an application may provide an Identifier Profile such as the <a href="tr39-14.html#General_Security_Profile">General Security Profile for Identifiers</a>, which restricts the allowed characters further. For each of the  Restriction Levels 1-5, characters in the string must also be in the Identifier Profile. Where there is no such Identifier Profile, Levels 5 and 6 are identical.</p>
		<ol>
			<li><b><a class="plain" href="tr39-14.html#ascii_only" name="ascii_only">ASCII-Only</a></b>
				<ul class="changed">
					<li>All characters in the string are in the ASCII range.</li>
				</ul></li>
			<li><b><a class="plain" href="tr39-14.html#single_script"
					name="single_script">Single Script</a></b>
				<ul class="changed">
					<li>The string qualifies as ASCII-Only, or</li>
					<li>The string is <a href="tr39-14.html#def-single-script">single-script</a>, according to the definition in Section 5.1.</li>
				</ul>
			</li>
			<li><b><a class="plain" href="tr39-14.html#highly_restrictive"
					name="highly_restrictive">Highly Restrictive</a></b>
				<ul class="changed">
					<li>The string qualifies as Single Script, or</li>
					<li>The string is <a href="tr39-14.html#def-cover">covered</a> by any of the following sets of scripts, according to the definition in Section 5.1:
                      
					  <ul>
			  <li><i>Latin + Han + Hiragana + Katakana</i>; or equivalently: Latn + Jpan</li>
							<li><i>Latin + Han + Bopomofo</i>; or equivalently: Latn + Hanb</li>
							<li><i>Latin + Han + Hangul;</i> or equivalently: Latn + Kore</li>
					  </ul>
					</li>
				</ul></li>
			<li><b><a class="plain" href="tr39-14.html#moderately_restrictive"
					name="moderately_restrictive">Moderately Restrictive</a></b>
				<ul class="changed">
				  <li>The string qualifies as Highly Restrictive, or</li>
					<li>The string is  <a href="tr39-14.html#def-cover">covered</a> by Latin and any one other Recommended or Aspirational script, except Cyrillic, Greek</li>
				</ul></li>
			<li><b><a class="plain" href="tr39-14.html#minimally_restrictive"
					name="minimally_restrictive">Minimally Restrictive</a></b>
			  <ul class="changed">
                  <li>There are no restrictions on the set of scripts that  <a href="tr39-14.html#def-covered">cover</a>  the string.</li>
                  <li>The only restrictions are the identifier well-formedness criteria and Identifier Profile, allowing arbitrary mixtures of scripts such as Î©mega, TeÏ,
						HÎ»LF-LIFE, Toys-<span title="U+042F CYRILLIC CAPITAL LETTER YA">Ð¯</span>-Us.</li>
				</ul>
			</li>
			<li><b><a class="plain" href="tr39-14.html#unrestricted"
					name="unrestricted">Unrestricted</a></b>
				<ul>
					<li class="changed">There are no restrictions on the script coverage  of the string.</li>
                    <li><span class="changed">The only restrictions are the criteria on identifier well-formedness. </span>Characters may be outside of the
					Identifier Profile.</li>
                    <li class="changed">This level is primarily for use in detection APIs, providing return value indicating that the string does not match any of the levels 1-5.</li>
				</ul>
			</li>
		</ol>
		<p class="changed">Note that in all levels except ASCII-Only, any character having Script_Extensions {Common} or {Inherited} are allowed in the identifier, as long as those characters meet the Identifier Profile requirements.</p>
	  <p>These levels can be detected by reusing some of the mechanisms
			of Section 5.1. For a given input string, the Restriction Level is
			determined by the following logical process:</p>
		<ol>
			<li>If the string contains any characters outside of the
				Identifer Profile, return <b>Unrestricted</b>.
			</li>
			<li>If no character in the string is above 0x7F, return <strong>ASCII<span class="changed">-Only</span></strong>. </li>
			<li>Compute <span class="changed">the string's </span>SOSS<span class="changed"> according to Section 5.1</span>.</li>
			<li><span class="changed">If the SOSS is empty or the intersection of all entries in the SOSS is nonempty</span>, return <b>Single Script</b>.
			</li>
			<li class="changed">Remove all the entries from the SOS that contain Latin.</li>
			<li>If any of the following sets cover SOSS, return <b>Highly
					Restrictive.</b>
				<ul class="changed">
					<li>{<i>Kore</i>}</li>
					<li>{<i>Hanb</i>}
					</li>
					<li>{<i>Japn</i>}
					</li>
				</ul>
			</li>
			<li><span class="changed">If the intersection of all entries in the SOSS</span> contains any single <strong>Recommended</strong><span class="removed"> or <strong>Aspirational</strong></span>
				script except <i>Cyrillic</i> <i>or Greek</i>, return <b>Moderately
					Restrictive</b>.
			</li>
			<li>Otherwise, return <b>Minimally Restrictive</b>.
			</li>
		</ol>
		<p>The actual implementation of this algorithm can be optimized;
			as usual, the specification only depends on the results.</p>
		<h3>
			5.3 <a name="Mixed_Number_Detection" href="tr39-14.html#Mixed_Number_Detection">Mixed-Number
				Detection</a>
		</h3>
		<p>
			There are three different types of numbers in Unicode. Only numbers
			with General_Category = Decimal_Numbers (Nd) should be allowed in
			identifiers. However, characters from different decimal number
			systems can be easily confused. For example, <a target="c"
				href="http://unicode.org/cldr/utility/character.jsp?a=0660">U+0660</a>Â (Â Ù Â )
			ARABIC-INDIC DIGIT ZERO can be confused with <a target="c"
				href="http://unicode.org/cldr/utility/character.jsp?a=06F0">U+06F0</a>Â (Â Û°Â )
			EXTENDED ARABIC-INDIC DIGIT ZERO, and <a target="c"
				href="http://unicode.org/cldr/utility/character.jsp?a=09EA">U+09EA</a>Â (Â à§ªÂ )
			BENGALI DIGIT FOUR can be confused with <a target="c"
				href="http://unicode.org/cldr/utility/character.jsp?a=0038">U+0038</a>Â (Â 8Â )
			DIGIT EIGHT.
		</p>
		<p>For a given input string which does not contain non-decimal
			numbers, the logical process of detecting mixed numbers is the
			following:</p>
		<p>For each character in the string:</p>
		<ol>
			<li>Find the decimal number value for that character, if any.</li>
			<li>Map the value to the unique zero character for that number
				system.</li>
		</ol>
		<p>If there is more than one such zero character, then the string
			contains multiple decimal number systems.</p>
		<p>
			The actual implementation of this algorithm can be optimized; as
			usual, the specification only depends on the results. The following
			Java sample using [<a href="tr39-14.html#ICU">ICU</a>] shows how this can be done
			:
		</p>
		<pre>
    public UnicodeSet getNumberRepresentatives(String identifier) {<br>        int cp;<br>        UnicodeSet numerics = new UnicodeSet();<br>        for (int i = 0; i &lt; identifier.length(); i += Character.charCount(i)) {<br>            cp = Character.codePointAt(identifier, i);<br>            // Store a representative character for each kind of decimal digit<br>            switch (UCharacter.getType(cp)) {<br>            case UCharacterCategory.DECIMAL_DIGIT_NUMBER:<br>                // Just store the zero character as a representative for comparison. <br>                // Unicode guarantees it is cp - value.<br>                numerics.add(cp - UCharacter.getNumericValue(cp));<br>                break;<br>            case UCharacterCategory.OTHER_NUMBER:<br>            case UCharacterCategory.LETTER_NUMBER:<br>                throw new IllegalArgumentException(&quot;Should not be in identifiers.&quot;);<br>            }<br>        } <br>        return numerics;<br>    }
...
    UnicodeSet numerics = getMixedNumbers(String identifier);
    if (numerics.size() &gt; 1) reject(identifer, numerics);</pre>
		<h3>
			5.4 <a name="Optional_Detection" href="tr39-14.html#Optional_Detection">Optional
				Detection</a>
		</h3>
		<p>
			There are additional enhancements that may be useful in spoof
			detection. This includes such mechanisms as marking
				strings as &quot;mixed script&quot; where they contain both
			simplified-only and traditional-only Chinese characters, using the
			Unihan data in the Unicode Character Database [<a href="tr39-14.html#UCD">UCD</a>],
			or detecting sequences of the same nonspacing mark.
		</p>
		<p>Other enhancements useful in spoof detection include the
			following:</p>
		<ol>
			<li>Mark Chinese strings as âmixed scriptâ if they contain both
				simplified (S) and traditional (T) Chinese characters, using the
				Unihan data in the Unicode Character Database [<a href="tr39-14.html#UCD">UCD</a>].
				<ol type="a">
					<li>The criterion can only be applied if the language of the
						string is known to be Chinese. So, for example, the string
						âåçã ãã®çµå©å¼ â is Japanese, and should not be marked as mixed script
						because of a mixture of S and T characters.</li>
					<li>Testing for whether a character is S or T needs to be
						based not on whether the characterÂ <em>has</em>Â a S or T variant ,
						but whether the characterÂ <em>is</em>Â an S or T variant.
					</li>
				</ol>
			</li>
			<li>Forbid sequences of the same nonspacing mark</li>
			<li>Check to see that all the characters are in the sets of
				exemplar characters for at least one language in the Unicode Common
				Locale Data Repository [<a href="tr39-14.html#CLDR">CLDR</a>].
			</li>
		</ol>
		<h2>
			6 <a name="Development_Process" href="tr39-14.html#Development_Process">Development
				Process</a>
		</h2>
		<p>
			As discussed in Unicode Technical
				Report #36, &quot;Unicode Security Considerations&quot; [<a
				href="tr39-14.html#UTR36">UTR36</a>], confusability among characters cannot be
			an exact science. There are many factors that make confusability a
			matter of degree:
		</p>
		<ul>
			<li>Shapes of characters vary greatly among fonts used to
				represent them. The Unicode Standard uses representative glyphs in
				the code charts, but font designers are free to create their own
				glyphs.Â Because fonts can easily be created using an arbitrary glyph
				to represent any Unicode code point, character confusability with
				arbitrary fonts can never be avoided. For example, one could design
				a font where the âaâ looks like a âbâ , âcâ like a âdâ, and so on.</li>
			<li>Writing systems using contextual shaping (such as Arabic,
				and many South Asian systems) introduce even more variation in text
				rendering. Characters do not really have an abstract shape in
				isolation and are only rendered as part of cluster of characters
				making words, expressions, and sentences. It is a fairly common
				occurrence to find the same visual text representation corresponding
				to very different logical words that can only be recognized by
				context, if at all.</li>
			<li>Font style variants such as italics may introduce a
				confusability which does not exist in another style. For example, in
				the Cyrillic script, the <a target="c"
				href="http://unicode.org/cldr/utility/character.jsp?a=0442">U+0442</a>Â (Â ÑÂ )
				CYRILLIC SMALL LETTER TE looks like a small caps Latin âTâ in normal
				style, while it looks like a small Latin âmâ in italic style.
			</li>
		</ul>
		<p>
			In-script confusability is extremely user-dependent. For example, in
			the Latin script, characters with accents or appendices may look
			similar to the unadorned characters for some users, especially if
			they are not familiar with their meaning in a particular language.
			However, most users will have at least a minimum understanding of the
			range of characters in their own script, and there are separate
			mechanisms available to deal with other scripts, as discussed in [<a
				href="tr39-14.html#UTR36">UTR36</a>].
		</p>
		<p>
			As described elsewhere, there are cases where the confusable data may
			be different than expected. Sometimes this is because two characters
			or two strings may only be confusable in some fonts. In other cases,
			it is because of transitivity. For example, the dotless and dotted I
			are considered equivalent (Ä± â i), because they look the same when
			accents such as an <i>acute</i> are applied to each. However, for
			practical implementation usage, transitivity is sufficiently
			important that some oddities are accepted.
		</p>
		<p>
			The data may be enhanced in future versions of this
				specification. For information on handling changes in data over
				time, see <i>Section 2.9.1, Backward Compatibility</i> of [<a href="tr39-14.html#UTR36">UTR36</a>].
		</p>
		<h3>
			6.1 <a name="Data_Collection" href="tr39-14.html#Data_Collection">Confusables Data Collection</a>
		</h3>
		<p>The confusability data was created by collecting a number of
			prospective confusables, examining those confusables according to a
			set of common fonts, and processing the result for transitive
			closure.</p>
		<p>
			The primary goal is to include characters that would be <strong>Status</strong>=Allowed
			as in <em><a href="tr39-14.html#Identifier_Status_and_Type">Table 1.
					Identifier Status and Type</a></em>. Other characters, such as NFKC
			variants, are not a primary focus for data collection. However, such
			variants may certainly be included in the data, and may be submitted
			using the online forms at [<a href="tr39-14.html#Feedback">Feedback</a>].
		</p>
		<p>The prospective confusables were gathered from a number of
			sources. Erik van der Poel contributed a list derived from running a
			program over a large number of fonts to catch characters that shared
			identical glyphs within a font, and Mark Davis did the same more
			recently for fonts on Windows and the Macintosh. Volunteers from
			Google, IBM, Microsoft and other companies gathered other lists of
			characters. These included native speakers for languages with
			different writing systems. The Unicode compatibility mappings were
			also used as a source. The process of gathering visual confusables is
			ongoing: the Unicode Consortium welcomes submission of additional
			mappings. The complex scripts of South and Southeast Asia need
			special attention. The focus is on characters that can be in the
			Recommended profile for identifiers, because they are of most
			concern.</p>
		<p>The fonts used to assess the confusables included those used by
			the major operating systems in user interfaces. In addition, the
			representative glyphs used in the Unicode Standard were also
			considered. Fonts used for the user interface in operating systems
			are an important source, because they are the ones that will usually
			be seen by users in circumstances where confusability is important,
			such such as when using IRIS (Internationalized Resource Identifiers)
			and their sub-elements (such as domain names). These fonts have a
			number of other relevant characteristics:</p>
		<ul>
			<li>They rarely changed in updates to operating systems and
				applications; changes brought by system upgrades tend to be gradual
				to avoid usability disruption.</li>
			<li>Because user interface elements need to be legible at low
				screen resolution (implying a low number of pixels per EM), fonts
				used in these contexts tend to be designed in sans-serif style,
				which has the tendency to increase the possibility of confusables.
				There are, however, some languages such as Chinese where a serif
				style is in common use.</li>
			<li>Strict bounding box requirements create even more
				constraints for scripts which use relatively large ascenders and
				descenders. This also limits space allocated for accent or tone
				marks, and can also create more opportunities for confusability.</li>
		</ul>
		<p>
			Pairs of prospective confusables were removed if they were always
			visually distinct at common sizes, both within and across fonts. The
			data was then closed under transitivity, so that if XâY and YâZ, then
			XâZ. In addition, the data was closed under substring operations, so
			that if XâY then AXBâAYB. It was then processed to produce the
			in-script and cross-script data, so that a single data table can be
			used to map an input string to a resulting <i>skeleton</i>.
		</p>
		<p>
			A skeleton is intended <i>only</i> for internal use for testing
			confusability of strings; the resulting text is not suitable for
			display to users, because it will appear to be a hodgepodge of
			different scripts. In particular, the result of mapping an identifier
			will not necessary be an identifier. Thus the confusability mappings
			can be used to test whether two identifiers are confusable (if their
			skeletons are the same), but should definitely not be used as a
			&quot;normalization&quot; of identifiers.
		</p>
		<h3>
			6.2 <a name="IDMOD_Data_Collection" href="tr39-14.html#IDMOD_Data_Collection">Identifier
				Modification Data Collection</a>
		</h3>
		<p>
			The <strong>idmod</strong> data is gathered in the following way. The
			basic assignments are derived based on UCD character properties,
			information in [<a href="tr39-14.html#UAX31">UAX31</a>], and a curated list of
			exceptions based on information from various sources, including the
			core specification of the Unicode Standard, annotations in the code
			charts, information regarding CLDR exemplar characters, and external
			feedback.
		</p>
		<p>
			The first condition that matches in the order of the items from top
			to bottom in <a href="tr39-14.html#Identifier_Status_and_Type">Table 1.
				Identifier Status and Type</a> is used, with a few exceptions:
		</p>
		<ol>
			<li>When a character is in <a
				href="../tr31/index.html#Table_Candidate_Characters_for_Inclusion_in_Identifiers"><em>Table
						3, Candidate Characters for Inclusion in Identifiers</em></a> in [<a
				href="tr39-14.html#UAX31">UAX31</a>], then it is given the Type Inclusion,
				regardless of other properties.
			</li>
			<li>When the Script_Extensions property value for a character
				contains multiple Script property values, the Script used for the
				derivation is the first in the following list:
				<ol>
					<li><em><a
							href="../tr31/index.html#Table_Recommended_Scripts">Table
								5, Recommended Scripts</a></em>Â </li>
					<li class='removed'><em><a
							href="../tr31/index.html#Aspirational_Use_Scripts">Table
				  6, Aspirational Use Scripts</a></em></li>
					<li><em><a
							href="../tr31/index.html#Table_Limited_Use_Scripts">Table
								7, Limited Use Scripts</a></em></li>
					<li><em><a
							href="../tr31/index.html#Table_Candidate_Characters_for_Exclusion_from_Identifiers">Table
								4, Candidate Characters for Exclusion from Identifiers</a></em>
						<ul>
							<li><em><a
									href="../tr31/index.html#Table_Candidate_Characters_for_Exclusion_from_Identifiers">Table
										4</a></em> also has some conditions that are not dependent on script;
								those conditions are applied regardless of Script_Extensions
								property value.</li>
						</ul></li>
				</ol>
			</li>
		</ol>
		<p>
			The script information in <em><a
				href="../tr31/index.html#Table_Candidate_Characters_for_Exclusion_from_Identifiers">Table
					4</a></em>, <em><a
				href="../tr31/index.html#Table_Recommended_Scripts">Table
					5</a></em>, <em><a
				href="../tr31/index.html#Aspirational_Use_Scripts">Table
					6</a></em> and <em><a
				href="../tr31/index.html#Table_Limited_Use_Scripts">Table
					7</a></em> are in machine-readable form in CLDR, as scriptMetadata.txt.
		</p>
		<h2>
			7 <a name="Data_Files" href="tr39-14.html#Data_Files">Data Files</a>
		</h2>
		<p>
			The following files provide data used to implement the
			recommendations in this document. The data may be refined in future
			versions of this specification. For more information,
				see <i>Section 2.9.1, Backward Compatibility</i> of [<a href="tr39-14.html#UTR36">UTR36</a>].
		</p>
		<blockquote>
			<p>
				<em>The Unicode Consortium welcomes feedback
						on additional confusables or identifier restrictions. There are
						online forms at [<a href="tr39-14.html#Feedback">Feedback</a>] where you can
						suggest additional characters or corrections.
				</em>
			</p>
		</blockquote>
		<p>
			The files are in <a href="http://www.unicode.org/Public/security/">http://www.unicode.org/Public/security/</a>.
			The directories there contain data files associated with a given
			version. The directory for <i>this</i> version is:
		</p>
		<blockquote>
			<p>
				<a href="http://www.unicode.org/Public/security/9.0.0">
					http://www.unicode.org/Public/security/9.0.0</a>
			</p>
		</blockquote>
		<p>The data files for the latest approved version are also in the
			directory:</p>
		<blockquote>
			<p>
				<a href="http://www.unicode.org/Public/security/latest ">http://www.unicode.org/Public/security/latest
				</a>
			</p>
		</blockquote>
				<p>The format for IdentifierStatus.txt follows the normal conventions for 
					UCD data files, and is described in the header of that file. 
					All characters not listed in the file default to IdentifierType=Restricted. 
					Thus the file only  lists characters with IdentifierStatus=Allowed. 
					For example:</p>
                <p><code>002D..002E ; Allowed # 1.1 HYPHEN-MINUS..FULL STOP</code></p>
                <p>The format for IdentifierType.txt follows the normal conventions for UCD 
                	data files, and is described in the header of that file. The value is a 
                	set whose elements are delimited by spaces. This format is identical to 
                	that used for ScriptExtensions.txt. This differs from prior versions
                	 which only listed the strongest reason for exclusion. This new convention 
                	 allows the values to be used for more nuanced filtering. For example, 
                	 if an implementation wants to allow an Exclusion script, it could still 
                	 exclude Obsolete and Deprecated characters in that script. 
                	 All characters not listed in the file default to IdentifierType=Recommended. 
                	 For example:</p>
                <p><code>2460..24EA ; Technical Not_XID Not_NFKC # 1.1 CIRCLED DIGIT ONE..CIRCLED DIGIT ZERO</code></p>
                <p class='reviewnote'>Review Note: The term "Aspirational" will be changed to Limited_Use in the data files.</p>

        <p class="caption">Table 2. <a name="Data_File_List" href="tr39-14.html#Data_File_List">Data File List</a></p>

        <div align="center">
    		<table class="simple">
    		<tr>
    			<th>Reference</th>
    			<th>File Name(s)</th>
    			<th>Contents</th>
    		</tr>
			<tr>
				<td>[<a class="plain" name="idmod" href="tr39-14.html#idmod">idmod</a>]
				</td>
				<td>IdentifierStatus.txt<br>
			    IdentifierType.txt</td>
				<td><b>Identifier Type and Status: </b>Provides the list of additions and restrictions
					recommended for building a profile of identifiers for environments
					where security is at issue.</td>
			</tr>
			<tr>
				<td>[<a class="plain" name="confusables" href="tr39-14.html#confusables">confusables</a>]
				</td>
				<td>confusables.txt</td>
				<td><b>Visually Confusable
						Characters:</b> Provides a mapping for visual confusables for use in
					detecting possible security problems. The usage of the
						file is described in <i>Section 4, <a href="tr39-14.html#Confusable_Detection">Confusable Detection</a>.
				</i></td>
			</tr>
			<tr>
				<td>[<a class="plain" name="confusablesSummary" href="tr39-14.html#confusablesSummary">confusablesSummary</a>]
				</td>
				<td>confusablesSummary.txt</td>
				<td><b>A summary view of the
						confusables:</b> Groups each set of confusables together, listing them
					first on a line starting with #, then individually with names and
					code points. See <i>Section 4, <a href="tr39-14.html#Confusable_Detection">Confusable
							Detection</a></i></td>
			</tr>
			<tr>
				<td>[<a class="plain" name="intentional" href="tr39-14.html#intentional">intentional</a>]
				</td>
				<td>intentional.txt</td>
				<td><b>Intentional
						Confusable Mappings:</b> A selection of characters whose glyphs in any
					particular typeface would probably be designed to be identical in
					shape when using a harmonized typeface design.</td>
			</tr>
	  		</table>
	  	</div>

		<h2>
			<a name="Migration" href="tr39-14.html#Migration">Migration</a>
		</h2>
		<p>Beginning with version 6.3.0, the version numbering of this
			document has been changed to indicate the version of the UCD that the
			data is based on. For versions up to and including 6.3.0, the
			following table shows the correspondence between the versions of this
			document and UCD versions that they were based on.</p>

        <p class="caption">Table 3. <a name="Version_Correspondance" href="tr39-14.html#Version_Correspondance">Version
					Correspondence</a></p>

		<div align="center">
			<table class="simple">
				<tr>
					<th>Version</th>
					<th>Release Date</th>
					<th>Data File Directory</th>
					<th>UCD Version</th>
					<th>UCD Date</th>
				</tr>
				<tr>
					<td>Version 1</td>
					<td>2006-08-15</td>
					<td>/Public/security/revision-02/</td>
					<td>5.1.0</td>
					<td>2008-04</td>
				</tr>
				<tr>
					<td><em>draft only</em></td>
					<td>2006-08-11</td>
					<td>/Public/security/revision-03/</td>
					<td><em>n/a</em></td>
					<td><em>n/a</em></td>
				</tr>
				<tr>
					<td>Version 2</td>
					<td>2010-08-05</td>
					<td>/Public/security/revision-04/</td>
					<td>6.0.0</td>
					<td>2010-10</td>
				</tr>
				<tr>
					<td>Version 3</td>
					<td>2012-07-23</td>
					<td>/Public/security/revision-05/</td>
					<td>6.1.0</td>
					<td>2012-01</td>
				</tr>
				<tr>
					<td>6.3.0</td>
					<td>2013-11-11</td>
					<td>/Public/security/6.3.0/</td>
					<td>6.3.0</td>
					<td>2013-09</td>
				</tr>
			</table>
		</div>

		<p>
			<br> If an update version of this standard is required between
			the associated UCD versions, the version numbering will include an
			update number in the 3rd field. For example, if a version of this
			document and its associated data is needed between UCD 6.3.0 and UCD
			7.0.0, then a version 6.3.<strong>1</strong> could be used.
		</p>
		<h3>
			<a name="Migrating_Persistent_Data" href="tr39-14.html#Migrating_Persistent_Data">Migrating
				Persistent Data</a>
		</h3>

		<p>Implementations must migrate their persistent data stores (such
			as database indexes) whenever those implementations update to use the
			data files from a new version of this specification.</p>
		<p>Stability is never guaranteed between versions, although it is
			maintained where feasible. In particular, an updated version of
			confusable mapping data may use a mapping for a particular character
			that is different from the mapping used for that character in an
			earlier version. Thus there may be cases where X â Y in Version N,
			and X â Z in Version N+1, where Z may or may not have mapped to Y in
			Version N. Even in cases where the logical data has not changed
			between versions, the order of lines in the data files may have been
			changed.</p>
		<p>The Identifier Status does not have stability guarantees (such as âOnce a character is Allowed, it will not become Restricted in future versionsâ), because the data is changing over time as we find out more about character usage. Certain of the Type values, such as Not_XID, are backward compatible but most may change as new data becomes available. The identifier data may also not appear to be completely consistent when just viewed from the perspective of script and general category. For example, it may well be that one character out of a set of non-spacing marks in a script is Restricted, while others are not. But that can be just a reflection of the fact that that character is obsolete and the others are not.</p>
		<p>For identifier lookup, the data is aimed more at flagging possibly questionable characters, thus serving as one factor (among perhaps many, like using the &quot;Safe Browsing&quot; service) in determining whether the user should be notified in some way. For registration, flagged characters can result in a &quot;soft no&quot;, that is, require the user to appeal a denial with more information.</p>
		<p>For dealing with characters whose status changes to Restricted, implementations can use a grandfathering mechanism  to maintain backwards compatibility.</p>
		<p>Implementations should therefore have a strategy for migrating
			their persistent data stores (such as database indexes) that use any
			of the confusable mapping data or other data files.</p>

<p class='reviewnote'>Review Note: the examples need to be checked against the final data.</p>
<h3 class="changed">
			<a name="Version_10_Migration" href="tr39-14.html#Version_10_Migration">Version 10.0 Migration</a>
		</h3>
<p class="changed">As of Unicode 10.0, Type=Aspirational is now empty; for more information, see [<a href="tr39-14.html#UAX31">UAX31</a>].</p>



		<h3><a name="Version_9_Migration" href="tr39-14.html#Version_9_Migration">Version
		9.0 Migration</a></h3>
		<p>There is an important data format change between versions 8.0 and 9.0. In particular, the xidmodifications.txt file from Version 8.0 has been split into two files for Version 9.0: IdentifierStatus.txt and IdentifierType.txt.</p>
		<div align="center">
			<table class="simple">
		    <tr>
		      <th>Version 9.0</th>
		      <th>Version 8.0</th>
	        </tr>
		    <tr>
		      <td>Field 1 of IdentifierStatus.txt</td>
		      <td>Field 1 of xidmodifications.txt</td>
	        </tr>
		    <tr>
		      <td>Field 1 of IdentifierType.txt</td>
		      <td>Field 2 of  xidmodifications.txt</td>
	        </tr>
	  		</table>
	  	</div>

		<p>Multiple values are listed in field 1 of IdentifierType.txt. To convert to the old format of xidmodifications.txt, use the <em>last</em> value of that field. For example, the following values would correspond:</p>

		<div align="center">
			<table class="simple">
			<tr>
				<th>File</th>
				<th>Field</th>
				<th>Content</th>
			</tr>
			<tr>
				<td>IdentifierType.txt</td>
				<td>1</td>
				<td><code>180A ; <span class="changed">Limited_Use</span> Exclusion <strong>Not_XID</strong></code></td>
			</tr>
			<tr>
				<td>xidmodifications.txt</td>
				<td>2</td>
				<td><code>180A ; Restricted ; <strong>Not_XID</strong></code></td>
			</tr>
			</table>
		</div>

		<h3>
			<a name="Version_8_Migration" href="tr39-14.html#Version_8_Migration">Version
				8.0 Migration</a>
		</h3>

		<p>In Version 8.0, the following changes were made to the
			Identifier Status and Type:</p>
		<ul>
			<li>Changed to the standard UCD formatting. For example, <em>limited-use</em>
				â <em>Limited_Use</em>.
				<ul>
					<li>Usually this was simply changing the case and hyphen, but
						<em>not-chars</em> changed to <em>Not_Character</em>.
					</li>
				</ul>
			</li>
			<li>Aligned the Identifier Type better with UAX 31 and Unicode
				properties
				<ul>
					<li>historic
						<ul>
							<li>â Exclusion, where from <em><a
									href="../tr31/index.html#Table_Candidate_Characters_for_Exclusion_from_Identifiers"><em>Table
											4, Candidate Characters for Exclusion from Identifiers</em></a></em>,
							</li>
							<li>â Obsolete, otherwise</li>
						</ul>
					</li>
					<li>limited-use
						<ul>
							<li>â Limited_Use, where from <em><a
									href="../tr31/index.html#Table_Limited_Use_Scripts">Table
										7, Limited Use Scripts</a><a
									href="../tr31/index.html#Table_Candidate_Characters_for_Exclusion_from_Identifiers"></a></em>,
							</li>
							<li>â Aspirational, where from <em><a
									href="../tr31/index.html#Aspirational_Use_Scripts">Table
						  6, Aspirational Use Scripts</a></em><span class="changed"> (now incorporated into Limited_Use)</span></li>
							<li>â Uncommon-Use, otherwise</li>
						</ul>
					</li>
					<li>obsolete
						<ul>
							<li>â Deprecated, where matching the Unicode property</li>
						</ul>
					</li>
				</ul>
			</li>
		</ul>

		<h3>
			<a name="Version_7_Migration" href="tr39-14.html#Version_7_Migration">Version
				7.0 Migration</a><a name="Updating_Required"></a>
		</h3>
		<p>Due to production problems, versions of the confusable mapping
			tables before 7.0 did not maintain idempotency in all cases, so
			updating to version 8.0 is strongly advised.</p>
		<p>Anyone using the skeleton mappings needs to rebuild any
			persistent uses of skeletons, such as in database indexes.</p>
		<p>The SL, SA, and ML mappings in 7.0 were significantly changed
			to address the idempotency problem. However, the tables SL, SA, and
			ML were still problematic, and discouraged from use in 7.0. They were
			thus removed from version 8.0.</p>
		<p>All of the data necessary for an implementation to recreate the
			removed tables is available in the remaining data (MA) plus the
			Unicode Character Database properties (script, casing, etc.). Such a
			recreation would examine each of the equivalence classes from the MA
			data, and filter out instances that did not fit the constraints (of
			script or casing). For the target character, it would choose the most
			neutral character, typically a symbol. However, the reasons for
			deprecating them still stand, so it is not recommended that
			implementations recreate them.</p>
		<p>
			Note also that as the Script_Extensions data is made more complete,
			it may cause characters in the whole-script confusables data file to
			no longer match. For more information, see <em>Section 4 <a
				href="tr39-14.html#Confusable_Detection">Confusable Detection</a></em>.
		</p>
		<h2>
			<a name="Acknowledgments" href="tr39-14.html#Acknowledgments">Acknowledgments</a>
		</h2>
		<p>
			Mark Davis and Michel Suignard authored the bulk of the
				text, under direction from the Unicode Technical Committee. Steven
			Loomis and other people on the ICU team were very helpful in
		developing the original proposal for this technical report. <span class="changed">Shane Carr analyzed the algorithms and supplied  the source text for the rewrite of Sections 4 and 5 in version 10.</span></p>
		<p>Thanks
			also to the following people for their feedback or contributions to
			this document or earlier versions of it, or to the source data for
			confusables or idmod: Julie Allen, Andrew Arnold, Vernon Cole, David Corbett (specal thanks for the many contributions),
			Douglas Davidson, Rob Dawson, Alex Dejarnatt, Chris Fynn, Martin DÃ¼rst, Asmus Freytag, Deborah
			Goldsmith, Paul Hoffman, Denis Jacquerye, Cibu Johny, Patrick L.
			Jones, Peter Karlsson, Mike Kaplinskiy, Gervase Markham, Eric Muller,
			David Patterson, Erik van der Poel, Roozbeh Pournader, Michael van Riper, Marcos Sanz,
			Alexander Savenkov, Dominikus Scherkl, Manuel Strehl, Chris Weber, Ken Whistler,
			and WaÃ¯l Yahyaoui. Thanks to Peter Peng for his assistance with font
		confusables.</p>
		<h2>
			<a name="References" href="tr39-14.html#References">References</a>
		</h2>
		<table cellspacing="0" cellpadding="4" border="0" class="noborder"
			style="border-collapse: collapse">
			<!-- nocaption -->
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="CLDR"
					href="tr39-14.html#CLDR">CLDR</a>]
				</td>
				<td class="noborder" valign="top">Unicode Locales Project
					(Unicode Common Locale Data Repository)<br> <a
					href="http://www.unicode.org/cldr/">http://www.unicode.org/cldr/</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="DCore"
					href="tr39-14.html#DCore">DCore</a>]
				</td>
				<td class="noborder" valign="top">Derived Core Properties<br>
					<a
					href="http://www.unicode.org/Public/UCD/latest/ucd/DerivedCoreProperties.txt">
						http://www.unicode.org/Public/UCD/latest/ucd/DerivedCoreProperties.txt</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top">[<a name="DemoConf"
					href="tr39-14.html#DemoConf">DemoConf</a>]
				</td>
				<td class="noborder" valign="top"><a
					href="http://unicode.org/cldr/utility/confusables.jsp">http://unicode.org/cldr/utility/confusables.jsp</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top">[<a name="DemoIDN"
					href="tr39-14.html#DemoIDN">DemoIDN</a>]
				</td>
				<td class="noborder" valign="top"><a
					href="http://unicode.org/cldr/utility/idna.jsp" target="_blank">http://unicode.org/cldr/utility/idna.jsp</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top">[<a name="DemoIDNChars"
					href="tr39-14.html#DemoIDNChars">DemoIDNChars</a>]
				</td>
				<td class="noborder" valign="top"><a
					href="http://unicode.org/cldr/utility/list-unicodeset.jsp?a=\p{age%3D3.2}-\p{cn}-\p{cs}-\p{co}&amp;abb=on&amp;g=uts46+idna+idna2008">http://unicode.org/cldr/utility/list-unicodeset.jsp?a=\p{age%3D3.2}-\p{cn}-\p{cs}-\p{co}&amp;abb=on&amp;uts46+idna+idna2008</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="FAQSec"
					href="tr39-14.html#FAQSec">FAQSec</a>]
				</td>
				<td class="noborder" valign="top">Unicode FAQ on Security
					Issues<br> <a href="http://www.unicode.org/faq/security.html">http://www.unicode.org/faq/security.html</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="ICANN"
					href="tr39-14.html#ICANN">ICANN</a>]
				</td>
				<td class="noborder" valign="top">ICANN Documents:<br>
					Internationalized Domain Names<br> <a
					href="http://www.icann.org/en/topics/idn/">http://www.icann.org/en/topics/idn/</a><br>
					The IDN Variant Issues Project<br> <a
					href="http://www.icann.org/en/topics/new-gtlds/idn-vip-integrated-issues-23dec11-en.pdf">http://www.icann.org/en/topics/new-gtlds/idn-vip-integrated-issues-23dec11-en.pdf</a>
					<br>Maximal Starting Repertoire Version 2 (MSR-2)<br> <a
					href="https://www.icann.org/news/announcement-2-2015-04-27-en">https://www.icann.org/news/announcement-2-2015-04-27-en</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="ICU"
					href="tr39-14.html#ICU">ICU</a>]
				</td>
				<td class="noborder" valign="top">International Components for
					Unicode<br> <a href="http://site.icu-project.org/">http://site.icu-project.org/</a><br>
				</td>
			</tr>
			<tr>
				<td class="noborder">[<a name="IDNA2003" href="tr39-14.html#IDNA2003">IDNA2003</a>]
				</td>
				<td class="noborder">The IDNA2003 specification is
						defined by a cluster of IETF RFCs:
					<ul>
						<li>IDNA [<a href="tr39-14.html#RFC3490">RFC3490</a>]
						</li>
						<li>Nameprep [<a href="tr39-14.html#RFC3491">RFC3491</a>]
						</li>
						<li>Punycode [<a href="tr39-14.html#RFC3492">RFC3492</a>]
						</li>
						<li>Stringprep [<a href="tr39-14.html#RFC3454">RFC3454</a>].
						</li>
					</ul></td>
			</tr>
			<tr>
				<td class="noborder">[<a name="IDNA2008" href="tr39-14.html#IDNA2008">IDNA2008</a>]
				</td>
				<td class="noborder">The IDNA2008 specification is defined by a
					cluster of IETF RFCs:
					<ul>
						<li>Internationalized Domain Names for Applications (IDNA):
							Definitions and Document Framework<br> <a
							href="http://tools.ietf.org/html/rfc5890">http://tools.ietf.org/html/rfc5890</a>
						</li>
						<li>Internationalized Domain Names in Applications (IDNA)
							Protocol<br> <a href="http://tools.ietf.org/html/rfc5891">http://tools.ietf.org/html/rfc5891</a>
						</li>
						<li>The Unicode Code Points and Internationalized Domain
							Names for Applications (IDNA)<br> <a
							href="http://tools.ietf.org/html/rfc5892">http://tools.ietf.org/html/rfc5892</a>
						</li>
						<li>Right-to-Left Scripts for Internationalized Domain Names
							for Applications (IDNA)<br> <a
							href="http://tools.ietf.org/html/rfc5893">http://tools.ietf.org/html/rfc5893</a>
						</li>
					</ul> There are also informative documents:<br>
					<ul>
						<li>Internationalized Domain Names for Applications (IDNA):
							Background, Explanation, and Rationale<br> <a
							href="http://tools.ietf.org/html/rfc5894">http://tools.ietf.org/html/rfc5894</a>
						</li>
						<li>The Unicode Code Points and Internationalized Domain
							Names for Applications (IDNA) - Unicode 6.0<br> <a
							href="http://tools.ietf.org/html/rfc6452">http://tools.ietf.org/html/rfc6452</a>
						</li>
					</ul>
				</td>
			</tr>
			<tr>
				<td class="noborder">[<a name="IDN_FAQ" href="tr39-14.html#IDN_FAQ">IDN-FAQ</a>]
				</td>
				<td class="noborder"><a
					href="http://www.unicode.org/faq/idn.html">http://www.unicode.org/faq/idn.html</a></td>
			</tr>
			<tr>
			  <td class="noborder" valign="top" nowrap>[<a name="EAI" href="tr39-14.html#EAI">EAI</a>]</td>
			  <td class="noborder" valign="top"><a href='https://tools.ietf.org/html/rfc6531'>https://tools.ietf.org/html/rfc6531</a></td>
		  </tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="Feedback"
					href="tr39-14.html#Feedback">Feedback</a>]
				</td>
				<td class="noborder" valign="top"><em>To suggest additions
						or changes to confusables or identifier restriction data, please
						see:</em><br> <a
					href="http://unicode.org/reports/tr39/suggestions.html"
					target="_blank">http://unicode.org/reports/tr39/suggestions.html</a>
					<br> <br> <em>For issues in the text, please see:</em><br>
					Reporting Errors and Requesting Information Online<i><br>
				</i><a href="http://www.unicode.org/reporting.html">http://www.unicode.org/reporting.html</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="Reports"
					href="tr39-14.html#Reports">Reports</a>]
				</td>
				<td class="noborder" valign="top">Unicode Technical Reports<br>
					<a href="../index.html">http://www.unicode.org/reports/<br>
				</a><i>For information on the status and development process for
						technical reports, and for a list of technical reports.</i></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="RFC3454"
					href="tr39-14.html#RFC3454">RFC3454</a>]
				</td>
				<td class="noborder" valign="top">P. Hoffman, M. Blanchet.
					&quot;Preparation of Internationalized Strings
					(&quot;stringprep&quot;)&quot;, RFC 3454, December 2002.<br> <a
					href="http://ietf.org/rfc/rfc3454.txt">http://ietf.org/rfc/rfc3454.txt</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="RFC3490"
					href="tr39-14.html#RFC3490">RFC3490</a>]
				</td>
				<td class="noborder" valign="top">Faltstrom, P., Hoffman, P.
					and A. Costello, &quot;Internationalizing Domain Names in
					Applications (IDNA)&quot;, RFC 3490, March 2003.<br> <a
					href="http://ietf.org/rfc/rfc3490.txt">http://ietf.org/rfc/rfc3490.txt</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="RFC3491"
					href="tr39-14.html#RFC3491">RFC3491</a>]
				</td>
				<td class="noborder" valign="top">Hoffman, P. and M. Blanchet,
					&quot;Nameprep: A Stringprep Profile for Internationalized Domain
					Names (IDN)&quot;, RFC 3491, March 2003.<br> <a
					href="http://ietf.org/rfc/rfc3491.txt">http://ietf.org/rfc/rfc3491.txt</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="RFC3492"
					href="tr39-14.html#RFC3492">RFC3492</a>]
				</td>
				<td class="noborder" valign="top">Costello, A., &quot;Punycode:
					A Bootstring encoding of Unicode for Internationalized Domain Names
					in Applications (IDNA)&quot;, RFC 3492, March 2003.<br> <a
					href="http://ietf.org/rfc/rfc3492.txt">http://ietf.org/rfc/rfc3492.txt</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a
					name="Security-FAQ" href="tr39-14.html#Security-FAQ">Security-FAQ</a>]
				</td>
				<td class="noborder" valign="top"><a
					href="http://www.unicode.org/faq/security.html">http://www.unicode.org/faq/security.html</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="UCD"
					href="tr39-14.html#UCD">UCD</a>]
				</td>
				<td class="noborder" valign="top">Unicode Character Database.<br>
					<a href="http://www.unicode.org/ucd/">http://www.unicode.org/ucd/</a><br>
					<i>For an overview of the Unicode Character Database and a list
						of its associated files.</i></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="UCDFormat"
					href="tr39-14.html#UCDFormat">UCDFormat</a>]
				</td>
				<td class="noborder" valign="top">UCD File Format<br> <a
					href="../tr44/index.html#Format_Conventions">http://www.unicode.org/reports/tr44/#Format_Conventions</a><br></td>
			</tr>
			<tr>
				<td class="noborder" valign="top">[<a name="UAX15"
					href="tr39-14.html#UAX15">UAX15</a>]
				</td>
				<td class="noborder" valign="top">UAX #15: <i>Unicode
						Normalization Forms</i><br> <a
					href="../tr15.1">http://www.unicode.org/reports/tr15/</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="UAX24"
					href="tr39-14.html#UAX24">UAX24</a>]
				</td>
				<td class="noborder" valign="top">UAX #24: Unicode Script
					Property<br> <a href="../tr24/index.html">http://www.unicode.org/reports/tr24/</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top">[<a name="UAX29"
					href="tr39-14.html#UAX29">UAX29</a><a name="Boundaries" href="tr39-14.html#Boundaries"></a>]
				</td>
				<td class="noborder" valign="top">UAX #29: <i>Unicode Text
						Segmentation</i><br> <a
					href="../tr29.1">http://www.unicode.org/reports/tr29/</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top">[<a name="UAX31"
					href="tr39-14.html#UAX31">UAX31</a>]
				</td>
				<td class="noborder" valign="top">UAX #31: <i>Unicode
						Identifier and Pattern Syntax</i><br> <a
					href="../tr31/index.html">http://www.unicode.org/reports/tr31/</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="Unicode"
					href="tr39-14.html#Unicode">Unicode</a>]
				</td>
				<td valign="top" class="noborder">The Unicode Standard<em><br>
						For the latest version, see:<br> </em><a
					href="http://www.unicode.org/versions/latest/">http://www.unicode.org/versions/latest/</a><br></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="UTR36"
					href="tr39-14.html#UTR36">UTR36</a><a name="Security" href="tr39-14.html#Security"></a>]
				</td>
				<td class="noborder" valign="top">UTR #36: <i>Unicode
						Security Considerations</i><br> <a
					href="../tr36/index.html">http://www.unicode.org/reports/tr36/</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="UTS18"
					href="tr39-14.html#UTS18">UTS18</a><a name="RegEx" href="tr39-14.html#RegEx"></a>]
				</td>
				<td class="noborder" valign="top">UTS #18: <i>Unicode
						Regular Expressions<br>
				</i> <a href="../tr18.1">
						http://www.unicode.org/reports/tr18/</a></td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="UTS39"
					href="tr39-14.html#UTS39">UTS39</a>]
				</td>
				<td class="noborder" valign="top">UTS #39: Unicode Security
					Mechanisms<br> <a href="index.html">http://www.unicode.org/reports/tr39/</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="UTS46"
					href="tr39-14.html#UTS46">UTS46</a>]
				</td>
				<td class="noborder" valign="top">Unicode IDNA Compatibility
					Processing<br> <a href="../tr46/index.html">http://www.unicode.org/reports/tr46/
				</a>
				</td>
			</tr>
			<tr>
				<td class="noborder" valign="top" nowrap>[<a name="Versions"
					href="tr39-14.html#Versions">Versions</a>]
				</td>
				<td class="noborder" valign="top">Versions of the Unicode
					Standard<br> <a
					href="http://www.unicode.org/standard/versions/">
						http://www.unicode.org/standard/versions/</a><br> <i>For
						information on version numbering, and citing and referencing the
						Unicode Standard, the Unicode Character Database, and Unicode
						Technical Reports.</i>
				</td>
			</tr>
		</table>
		<br>
		<h2>
			<a name="Modifications" href="tr39-14.html#Modifications">Modifications</a>
		</h2>
		<p>The following summarizes modifications from the previous
			published revision of this document.</p>
	  <p class='changed'>
			<strong>Revision 14</strong>
		</p>
		<ul class='changed'>
			<li><em>General</em>
			  <ul>
			    <li>Removed references to Aspirational scripts from [<a href="tr39-14.html#UAX31">UAX31</a>], because it has been combined into Limited Use. Note that this will have an effect on the results from <em>Section 5.2 <a 
href="tr39-14.html#Restriction_Level_Detection">Restriction-Level Detection</a></em> for the 5 affected scripts.</li>
		      </ul>
			</li>
			<li>Section 2 <a href="tr39-14.html#Conformance">Conformance</a>
			  <ul>
			    <li>Removed clauses C2.4, C2.5, C2.6. See section 4.1 for more information.</li>
		      </ul>
			</li>
			<li>Section 3.1 <a href="tr39-14.html#General_Security_Profile">General
			Security Profile for Identifiers</a>
			  <ul>
			    <li>Clarified that Inclusion and Recommended characters remove Restricted characters.</li>
		      </ul>
			</li>
			<li>Section 4 <a href="tr39-14.html#Confusable_Detection">Confusable Detection</a> 
			  <ul>
			    <li>Extensively reformulated text for clarity and precision.</li>
		      </ul>
			</li>
			<li>Section 5 <a href="tr39-14.html#Detection_Mechanisms">Detection Mechanisms</a> 
			  <ul>
			    <li>Extensively reformulated text for clarity and precision.</li>
		      </ul>
			</li>
		</ul>

		<p>
		Previous revisions can be accessed with the &quot;Previous Version&quot; link in the header.</p>
		<hr>
		<p class="copyright">
			Â© <span class="changed">2017 </span>Unicode, Inc. All Rights Reserved. The Unicode
			Consortium makes no expressed or implied warranty of any kind, and
			assumes no liability for errors or omissions. No liability is assumed
			for incidental and consequential damages in connection with or
			arising out of the use of the information or programs contained or
			accompanying this technical report. The Unicode <a
				href="http://www.unicode.org/copyright.html"> Terms of Use</a>
			apply.
		</p>
		<p class="copyright">Unicode and the Unicode logo are trademarks
			of Unicode, Inc., and are registered in some jurisdictions.</p>
	</div>

</body>

</html>
